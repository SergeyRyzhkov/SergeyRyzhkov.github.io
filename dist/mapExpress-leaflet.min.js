MapExpress={Controls:{},Service:{},Geo:{},Layers:{},Utils:{Promise:{}},Mapping:{},Tools:{},Styles:{},Search:{},Edit:{}},"undefined"!=typeof window&&window.L&&(window.MapExpress=MapExpress),MapExpress.Controls.BaseStatusbarSection=L.Class.extend({options:{containerClassName:"mapexpress-statusbar__section",contentClassName:"mapexpress-section_name"},initialize:function(a,b,c){c&&(this.template=c),this._mapManager=a,L.setOptions(this,b)},remove:function(){$(this._container).remove(),this._container=null},addTo:function(a){return $(this._addContainer()).appendTo($(a)),this},getId:function(){return this.options.id?this.options.id:null},getContainer:function(){return this._container},setContainerStyle:function(a){return this._container&&MapExpress.Controls.MapControlUtils.setStyle(this._container,a),this},setContentStyle:function(a){return this.section&&MapExpress.Controls.MapControlUtils.setStyle(this.section,a),this},setContent:function(a){this.section&&$(this.section).html(a)},updateContent:function(){},initListeners:function(){},removeListeners:function(){},addDivider:function(a){return L.DomUtil.create("span","mapexpress-section__devider",a),this},_addContainer:function(){return this._container=L.DomUtil.create("div",this.options.containerClassName),this._container.style.padding="2px",this.createContent(),this.initListeners(),this._container},createContent:function(){return this.section=L.DomUtil.create("div",this.options.contentClassName,this._container),this.section},createContentFromTemplate:function(a,b,c,d){function e(a){$(f.section).html(a),d&&"function"==typeof d&&d()}var f=this;f.section=L.DomUtil.create("div",f.options.contentClassName,f._container),MapExpress.Controls.MapControlUtils.generateTemplate(a,b,c,e)}}),MapExpress.Controls.LayerOrderControl=L.Control.extend({options:{position:"topright",className:"mapexpress-control-wrapper",layerItemClassName:"layer-order-item"},initialize:function(a,b){this._mapManager=a,L.setOptions(this,b);var c=this;this._mapManager.on("mapexspress:mapmanager:layer:visiblechanged",this._updateViaListeners,this),this._mapManager._map.on("zoomend",c._updateViaListeners,c)},onAdd:function(){return this._div=L.DomUtil.create("div",this.options.className),this._div.setAttribute("id","layer-order-control"),this._div},addTo:function(a){L.Control.prototype.addTo.call(this,this._mapManager._map),this.render(this._div)},render:function(a){function b(a){var b="images/visibility_y.png";f._mapManager.layerVisibleEnableInZoom(a.getAttribute("id"))||(b="images/visibility_n.png"),a.setAttribute("src",b)}function c(a){var b="images/label_n.gif",c=f._mapManager._mapModel.getLayerById(a.getAttribute("id"));c&&c.mapLayer&&c.mapLayer.options&&c.mapLayer.options.labelEnabled&&(b="images/label_y.gif"),a.setAttribute("src",b)}function d(a){f._mapManager.toogleLayerVisible(a.target.getAttribute("id")),f._mapManager._map.fire("layerorder:layer:toggle",{id:a.target.getAttribute("id")}),b(a.target)}function e(a){f._mapManager.toogleLabelLayer(a.target.getAttribute("id")),c(a.target)}var f=this,g=this._mapManager.getMapModel(),h=g.getOverlayLayers();g.sortLayersByVisibleIndex(h);var i=a?a:document.getElementById("layer-order-control");if(!i)return this._mapManager.off("mapexspress:mapmanager:layer:visiblechanged",this._updateViaListeners,this),void this._mapManager._map.off("zoomend",this._updateViaListeners,this);L.DomUtil.empty(i),MapExpress.Controls.MapControlUtils.stopMousePropagation(i);for(var j=0;j<h.length;j++){var k=h[j];if(k.options.showOnTOC===!1);else{var l=this._mapManager._mapModel.getLayerById(k.id);if(l&&l.mapLayer&&l.mapLayer.options&&l.mapLayer.options.visible===!0){var m=L.DomUtil.create("div",this.options.layerItemClassName,i);if(m.setAttribute("id",k.id),this._mapManager.layerLabelingEnabledInZoom(k.id)){var n=L.DomUtil.create("img","",m);n.setAttribute("id",k.id),c(n),n.onclick=e}var o=this._mapManager.layerVisibleEnableInZoom(k.id),p=L.DomUtil.create("img","",m);p.setAttribute("id",k.id),b(p),p.onclick=d;var q=o?"layer-order-item-text":"layer-order-item-text disabled",r=L.DomUtil.create("span",q,m);r.textContent=k.options.displayName}}}var s={onEnd:function(a){var b=a;setTimeout(function(){f._mapManager.moveOverlay(b.item.id,b.newIndex)},10)},animation:100};Sortable.create(i,s)},_updateViaListeners:function(){this.render(this._div)}}),MapExpress.Controls.LegendControl=L.Control.extend({options:{position:"topright",className:"mapexpress-control-legend"},initialize:function(a,b){this._mapManager=a,L.setOptions(this,b);this._onListenersOnControl()},_offListenersOnControl:function(a,b){this._mapManager.off("mapexspress:mapmanager:layer:visiblechanged",this._updateViaListeners,this),this._mapManager._map.off("moveend",this._updateViaListeners,this);for(var c=MapExpress.Utils.legendUtils.getAllLegends(),d=c.length-1;d>=0;d--){var e=window.MapManager.getMapModel().getLayerById(c[d].id);e.mapLayer.off("mapexspress:layer:data:added",this._updateViaListeners,this)}},_onListenersOnControl:function(){this._mapManager.on("mapexspress:mapmanager:layer:visiblechanged",this._updateViaListeners,this),this._mapManager._map.on("moveend",this._updateViaListeners,this)},onAdd:function(){return this._div=L.DomUtil.create("div",this.options.className),this._div.setAttribute("id","legendcontrol"),this._div},addTo:function(a){L.Control.prototype.addTo.call(this,this._mapManager._map),this.render(this._div)},render:function(a){this._mapManager.getMapModel();if(this._div=a?a:document.getElementById("legend-control"),!this._div)return void this._offListenersOnControl();$(this._div).empty();for(var b=$('<div class="mapexpress-legend"></div>'),c=MapExpress.Utils.legendUtils.getAllLegends(),d=c.length-1;d>=0;d--){var e=window.MapManager.getMapModel().getLayerById(c[d].id);e.mapLayer.on("mapexspress:layer:data:added",this._updateViaListeners,this)}this._processLayerModel(c,b),b.appendTo($(this._div))},_processLayerModel:function(a,b){for(var c=0;c<a.length;c++)if(a[c].legendItem){var d=$('<div id="'+a[c].id+'-legend" class="mapexpress-legend__items"></div>'),e=$("<div></div>");$(a[c].legendItem).appendTo(e),e.appendTo(d),$('<span class="noselect" style="white-space: nowrap;">'+a[c].displayName+"</span>").appendTo(d),d.appendTo(b)}},_updateViaListeners:function(){this.render(this._div)},_checkLayerLegendType:function(a,b){var c=MapExpress.Utils.LegendUtils._getLayerStyleTypesByZoomAndId(a);return"noGeometryTypes"===b&&0===c.length||c.indexOf(b)!==-1},_processLayerStyleToDiv:function(a,b){return MapExpress.Utils.LegendUtils.processLayerLegendToDiv(a,b)}}),MapExpress.Controls.MapControl=L.Evented.extend({options:{className:"",position:"center",modal:!1,titleText:!1,headerEnabled:!1,footerEnabled:!1,closeButtonEnabled:!0,draggable:!0,removalDelay:0,parentContainer:!1,closeOnLeave:!1,resizeable:!1,controlId:"mapexpress-control-id",destroyOnClose:!0},initialize:function(a,b){this._map=a,L.setOptions(this,b),this._initLayout()},show:function(){if(this._control||this._initLayout(),this._control){if(this.options.draggable&&this._controlHeaderBar){var a=new L.Draggable(this._control,this._controlHeaderBar);a.enable()}this.options.resizeable&&(this._control.style.resize="both"),this.options.removalDelay>0&&setTimeout(this.destroy.bind(this),this.options.removalDelay),this._control.style.visibility="visible",this.options.closeOnLeave&&this.closeOnLeave(),this.setMaxHeightWidthByContainer(),MapExpress.Controls.MapControlUtils.stopMousePropagationExceptClick(this._control),this.setPosition(this.options.position)}return this},setMaxHeightWidthByContainer:function(){var a=(this._getContainer().clientHeight-.4*this._getContainer().clientHeight).toString()+"px",b=this._getContainer().clientWidth.toString()/2+"px";this.setControlStyle({"max-height":a,"max-width":b})},setPosition:function(a){return a&&this._control&&(this.options.position=a,MapExpress.Controls.MapControlUtils.setPosition(this._getContainer(),this._control,this.options.position)),this},showErrorWindow:function(a,b){this._showSpecificWindow("Ошибка",a,b,"error")},showWarnWindow:function(a,b){this._showSpecificWindow(" Внимание",a,b,"warn")},showNotifyWindow:function(a,b){this.options.position="bottomRight",this._showSpecificWindow("Выполнено",a,b,"notify"),this.setControlStyle({opacity:1})},_showSpecificWindow:function(a,b,c,d){this.destroy(),this.options.headerEnabled=!0,this.options.closeButtonEnabled=!1,c?this.options.removalDelay=c:this.options.removalDelay=2500,this.show(),this.setTitle(a),this.setContent(b),MapExpress.Controls.MapControlUtils.addClassName(this._controlHeaderBar,"mapexpress-control-headerbar_"+d),MapExpress.Controls.MapControlUtils.addClassName(this._controlContent,"mapexpress-control-content_"+d)},showSmallCircleWaitControl:function(){return this.options.headerEnabled=!1,this.show(),this.setControlStyle({height:"36px",width:"36px","border-radius":"50%",padding:"0px",margin:"0px"}),this.setContentStyle({padding:"6px",display:"block"}),this.setContent(this.getPreloaderContent(24,12,10,4)),this._control&&$(this._control).attr("data-html2canvas-ignore","true"),this},showCircleWaitControl:function(){return this.options.headerEnabled=!1,this.show(),this.setControlStyle({height:"36px",width:"36px","border-radius":"50%",padding:"0px",margin:"0px"}),this.setContentStyle({padding:"0px",display:"block"}),this.setContent(this.getPreloaderContent(36,18,14,5)),this._control&&$(this._control).attr("data-html2canvas-ignore","true"),this},showWaitControl:function(a){return this.options.headerEnabled=!1,this.setControlStyle({height:"36px","border-radius":"36px"}),this.setContentStyle({padding:"0px",margin:"0px",display:"block"}),this.setContent(this.getPreloaderContent(36,18,14,5)+"<div class='noselect' style='margin-right:8px;margin-left:4px;float:right;font-size:13px;font-weight:500;display: inline-block;line-height: 36px;'>"+a+"</div>"),this._control&&$(this._control).attr("data-html2canvas-ignore","true"),this.show(),this},showSidebar:function(a,b,c,d){function e(a){h.html(a),h.addClass("active"),d&&"function"==typeof d&&d(),f.options.closeOnLeave&&f.closeOnLeave()}var f=this;this.options.position=!1,this.options.controlType="Sidebar",this.destroy();var g=this._getContainer();this._control=L.DomUtil.create("div",this.options.className+" mapexpress-sidebar-wrapper",g);var h=$(this._control);return h.attr("data-html2canvas-ignore","true"),h.attr("id","sidebar-"+b),MapExpress.Controls.MapControlUtils.stopMousePropagation(this._control),MapExpress.Controls.MapControlUtils.generateTemplate(a,b,c,e),this},hide:function(){this.fire("mapcontrol:remove:before",this),this._map&&this._map.fire("mapcontrol:remove:before",this),this._control&&(this.options.destroyOnClose===!0?this.destroy():this._control.style&&(this._control.style.visibility="hidden"))},destroy:function(){this._control&&($(this._control).remove(),delete this._control,this._modalWrapper&&($(this._modalWrapper).remove(),delete this._modalWrapper)),this.fire("mapcontrol:remove:after",this),this._map&&this._map.fire("mapcontrol:remove:after",this)},setContent:function(a){return this._controlContent&&$(this._controlContent).html(a),this.setPosition(this.options.position),this},setContentFromTemplate:function(a,b,c,d){function e(a){f.setContent(a),d&&"function"==typeof d&&d()}var f=this;return MapExpress.Controls.MapControlUtils.generateTemplate(a,b,c,e),this},setTitle:function(a){return this._controlTitle&&$(this._controlTitle).html(a),this},setFooterContent:function(a){return this._controlFooterBar&&$(this._controlFooterBar).html(a),this},setControlStyle:function(a){return this._control&&MapExpress.Controls.MapControlUtils.setStyle(this._control,a),this},setContentStyle:function(a){return MapExpress.Controls.MapControlUtils.setStyle(this._controlContent,a),this},setHeaderBarStyle:function(a){return MapExpress.Controls.MapControlUtils.setStyle(this._controlHeaderBar,a),this},setTitleBarStyle:function(a){return MapExpress.Controls.MapControlUtils.setStyle(this._controlTitleBar,a),this},setTitleStyle:function(a){return MapExpress.Controls.MapControlUtils.setStyle(this._controlTitle,a),this},setCloseButtonStyle:function(a){return MapExpress.Controls.MapControlUtils.setStyle(this._closeButton,a),this},setFooterBarStyle:function(a){return MapExpress.Controls.MapControlUtils.setStyle(this._controlFooterBar,a),this},_initLayout:function(){if(!this._control){var a=this._getContainer();if(this.options.modal&&(this._modalWrapper=L.DomUtil.create("div","modalWindow",a),MapExpress.Controls.MapControlUtils.stopMousePropagationExceptClick(this._modalWrapper)),this._control=L.DomUtil.create("div",this.options.className+" mapexpress-control-wrapper",a),this._control.style.visibility="hidden",$(this._control).attr("data-html2canvas-ignore","true"),$(this._control).attr("id",this.options.controlId),this.options.titleText&&(this.options.headerEnabled=!0),this.options.headerEnabled&&(this._controlHeaderBar=L.DomUtil.create("header","mapexpress-control-headerbar",this._control),this._controlTitleBar=L.DomUtil.create("div","mapexpress-control-titlebar",this._controlHeaderBar),this._controlTitle=L.DomUtil.create("div","mapexpress-control-title",this._controlTitleBar),this.options.titleText&&this.setTitle(this.options.titleText),this._controlToolbar=L.DomUtil.create("div","mapexpress-control-toolbar",this._controlHeaderBar),this.options.closeButtonEnabled)){this._closeButton=L.DomUtil.create("div","mapexpress-control-toolbar-btn",this._controlToolbar),$(this._closeButton).html("&#215");var b=this;$(this._closeButton).click(function(){b.hide()})}return this._controlContent=L.DomUtil.create("div","mapexpress-control-content",this._control),this.options.footerEnabled&&(this._controlFooterBar=L.DomUtil.create("footer","mapexpress-control-footerbar",this._control)),this}},bringToFront:function(){return this._control&&L.DomUtil.toFront(this._control),this},closeOnLeave:function(){function a(c){var d=$(b._control);d.is(c.target)||0!==d.has(c.target).length||b.hide(),$(document).off("click",a)}if(this._control){var b=this;$(document).on("click",a)}},getPreloaderContent:function(a,b,c,d){var e=".md-preloader{font-size:0;display:inline-block;-webkit-animation:outer 6600ms linear infinite;animation:outer 6600ms linear infinite}.md-preloader svg{-webkit-animation:inner 1320ms linear infinite;animation:inner 1320ms linear infinite}.md-preloader svg circle{fill:none;stroke:#3F51B5;stroke-linecap:square;-webkit-animation:arc 1320ms cubic-bezier(.8, 0, .4, .8) infinite;animation:arc 1320ms cubic-bezier(.8, 0, .4, .8) infinite}@-webkit-keyframes outer{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes outer{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes inner{0%{-webkit-transform:rotate(-100.8deg);transform:rotate(-100.8deg)}100%{-webkit-transform:rotate(0);transform:rotate(0)}}@keyframes inner{0%{-webkit-transform:rotate(-100.8deg);transform:rotate(-100.8deg)}100%{-webkit-transform:rotate(0);transform:rotate(0)}}@-webkit-keyframes arc{0%{stroke-dasharray:1 210.48670779px;stroke-dashoffset:0}40%{stroke-dasharray:151.55042961px,210.48670779px;stroke-dashoffset:0}100%{stroke-dasharray:1 210.48670779px;stroke-dashoffset:-151.55042961px}}@keyframes arc{0%{stroke-dasharray:1 210.48670779px;stroke-dashoffset:0}40%{stroke-dasharray:151.55042961px,210.48670779px;stroke-dashoffset:0}100%{stroke-dasharray:1 210.48670779px;stroke-dashoffset:-151.55042961px}}",f=document.createElement("style");f.styleSheet?f.styleSheet.cssText=e:f.appendChild(document.createTextNode(e)),this.preloaderStyleElement=document.getElementsByTagName("head")[0].appendChild(f);var g="<div class='md-preloader'><svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='{size}' width='{size}' viewbox='0 0 {size} {size}'><circle cx='{cx}' cy='{cx}' r='{r}' stroke-width='{strokewidth}'/></svg></div>",h=L.Util.template(g,{size:a,cx:b,r:c,strokewidth:d});return h},_getContainer:function(){return!this._container&&this.options.parentContainer&&(this._container=this.options.parentContainer),!this._container&&this._map&&(this._container=this._map.getContainer()),this._container||(this._container=document.body),this._container}}),MapExpress.Controls.MapControlUtils={stopMousePropagation:function(a){if(a){var b=L.DomEvent.stopPropagation;this.stopMousePropagationExceptClick(a),L.DomEvent.addListener(a,"click",b)}},stopMousePropagationExceptClick:function(a){if(a){var b=L.DomEvent.stopPropagation;L.DomEvent.addListener(a,"dblclick",b).addListener(a,"onwheel",b).addListener(a,"wheel",b).addListener(a,"dragenter",b).addListener(a,"dragover",b).addListener(a,"mousedown",b).addListener(a,"touchstart",b).addListener(a,"mousewheel",b)}},setPosition:function(a,b,c){return window.onresize=function(){MapExpress.Controls.MapControlUtils.setPosition(a,b,c)},"center"===c?void this.setCenterPosition(a,b):"topLeft"===c?void this.setTopLeftPosition(a,b):"left"===c?void this.setLeftPosition(a,b):"bottomLeft"===c?void this.setBottomLeftPosition(a,b):"right"===c?void this.setRightPosition(a,b):"topRight"===c?void this.setTopRightPosition(a,b):"top"===c?void this.setTopPosition(a,b):"bottom"===c?void this.setBottomPosition(a,b):"bottomRight"===c?void this.setBottomRightPosition(a,b):void this.setCenterPosition(a,b)},setCenterPosition:function(a,b){var c=$(a),d=$(b);b.style.left=Math.round((c.width()-d.width())/2)+"px",b.style.top=Math.round((c.height()-d.height())/2)+"px"},setTopLeftPosition:function(a,b){b.style.marginLeft="10px",b.style.marginTop="10px"},setLeftPosition:function(a,b){var c=$(a),d=$(b);b.style.marginLeft="10px",b.style.top=Math.round((c.height()-d.height())/2)+"px"},setTopPosition:function(a,b){var c=$(a),d=$(b);b.style.left=Math.round((c.width()-d.width())/2)+"px",b.style.marginTop="10px"},setRightPosition:function(a,b){var c=$(a),d=$(b);b.style.right="0px",b.style.marginRight="10px",b.style.top=Math.round((c.height()-d.height())/2)+"px"},setTopRightPosition:function(a,b){b.style.top="0px",b.style.right="0px",b.style.marginRight="10px",b.style.marginTop="10px"},setBottomLeftPosition:function(a,b){b.style.bottom="0px",b.style.left="0px",b.style.marginLeft="10px",b.style.marginBottom="10px"},setBottomRightPosition:function(a,b){b.style.bottom="0px",b.style.right="0px",b.style.marginRight="10px",b.style.marginBottom="10px"},setBottomPosition:function(a,b){var c=$(a),d=$(b);b.style.bottom="0px",b.style.marginBottom="10px",b.style.left=Math.round((c.width()-d.width())/2)+"px"},setStyle:function(a,b){if(a){if(b&&"string"==typeof b&&b.length>0)return void(a.style.cssText=a.style.cssText+";"+b);if(b&&"object"==typeof b)for(var c in b)a.style[c]=b[c]}},addClassName:function(a,b){if(a)return b&&"string"==typeof b&&b.length>0?void(a.className=a.className+" "+b):void 0},generateTemplate:function(a,b,c,d){var e=window.MAPEXPRESS_ROOT_PATH?window.MAPEXPRESS_ROOT_PATH+a:a,f=document.createElement("div");document.body.appendChild(f),$(f).load(e,function(){var a=$.templates("#"+b);if(a){var e=a.render(c);$(f).remove(),d&&"function"==typeof d&&d(e)}else $(f).remove()})}},MapExpress.Controls.MapPopupControl=MapExpress.Controls.MapControl.extend({setPosition:function(a){return this},setLatLngPosition:function(a){return this._latlng=L.latLng(a),this._updatePosition()},hide:function(){return this._map&&this._map.off(this.getEvents(),this),MapExpress.Controls.MapControl.prototype.hide.call(this)},show:function(){return this._map&&this._map.on(this.getEvents(),this),MapExpress.Controls.MapControl.prototype.show.call(this)},setMaxHeightWidthByContainer:function(){var a=this._map.getContainer(),b=(a.clientHeight-.1*a.clientHeight).toString()+"px",c=a.clientWidth.toString()/2+"px";this.setControlStyle({"max-height":b,"max-width":c})},_getContainer:function(){return this._container=this._map.getPane("mapPane"),this._container},_updatePosition:function(){if(this._map&&this._latlng&&this._control){var a=$(this._control),b=this._map.latLngToLayerPoint(this._latlng),c=b.x-Math.round(a.width()/2),d=b.y-a.height()-12;this._control.style.top=d+"px",this._control.style.left=c+"px",this._adjustPan()}return this},getEvents:function(){var a={zoom:this._updatePosition};return this._map._zoomAnimated&&(a.zoomanim=this._updatePosition),a},_adjustPan:function(){var a=this;if((!this._map._panAnim||!this._map._panAnim._inProgress)&&this._control){var b=$(this._control),c=0,d=0,e=$(a._map.getContainer()).width(),f=$(a._map.getContainer()).offset(),g=f.left,h=f.top,i=b.offset().left-g,j=b.offset().top-h,k=b.width();i>0&&i+k>e?d=-(e-i-k-12):i>0&&i+k<e?i<12?d=-(12-i):e-(i+k)<12&&(d=e-(i+k)):i<0&&(d=i-12),j<12&&j>=0?c=12-j:j<0&&(c=j-12),0===c&&0===d||this._map.fire("autopanstart").panBy([d,c])}}}),MapExpress.Controls.MapStatusbarControl=L.Control.extend({sections:[],options:{position:"bottomright",className:"mapexpress-statusbar"},initialize:function(a,b){this._mapManager=a,L.setOptions(this,b)},onAdd:function(){return this._createContainer()},addTo:function(){L.Control.prototype.addTo.call(this,this._mapManager._map)},removeSectionById:function(a){this._removeOrHideSectionById(a,!0)},hideSectionById:function(a){this._removeOrHideSectionById(a)},showSectionById:function(a){this._showSectionById(a)},addSection:function(a){return this.sections.push(a),this},getSectionById:function(a){for(var b=this.sections.length-1;b>=0;b--)if(this.sections[b].getId()===a)return this.sections[b];return null},refreshSections:function(){for(var a=0;a<this.sections.length;a++)null!==this.sections[a].getContainer()&&(this.sections[a].remove(),this.sections[a].addTo(this._container));this._refreshDividers()},setControlStyle:function(a){return this._container&&MapExpress.Controls.MapControlUtils.setStyle(this._container,a),this},_removeOrHideSectionById:function(a,b){var c=this.getSectionById(a);null!==c&&void 0!==c?(c.remove(),b&&this.sections.splice(this.sections.indexOf(c),1),this._refreshDividers()):console.warn("Неверно задан id сексии или секции не существует")},_showSectionById:function(a){var b=this.getSectionById(a);null!==b&&void 0!==b?(b.addTo(this._container),this.refreshSections()):console.warn("Неверно задан id сексии или секции не существует")},addDivider:function(){return L.DomUtil.create("span","mapexpress-statusbar__devider",this._container)},_refreshDividers:function(){$(".mapexpress-statusbar__devider").remove();for(var a=0,b=0;b<this.sections.length;b++)null!==this.sections[b].getContainer()&&(a=b);for(var c=0;c<this.sections.length;c++)null!==this.sections[c].getContainer()&&c!==a&&$(this.addDivider()).insertAfter($(this.sections[c].getContainer()))},_createContainer:function(){this._container=L.DomUtil.create("div",this.options.className),this._container.style.padding="2px";for(var a=0;a<this.sections.length;a++)this.sections[a].addTo(this._container);return this._refreshDividers(),MapExpress.Controls.MapControlUtils.stopMousePropagation(this._container),L.DomEvent.addListener(this._container,"mousemove",L.DomEvent.stopPropagation),this._container}}),MapExpress.Controls.mapStatusbarControl=function(a,b){return new MapExpress.Controls.MapStatusbarControl(a,b)},MapExpress.Controls.OkCancelDialog=MapExpress.Controls.MapControl.extend({options:{okButtonText:"ОК",cancelButtonText:"Отмена"},initialize:function(a,b){this._map=a,L.setOptions(this,b),this.options.footerEnabled=!0,this.options.headerEnabled=!0,this.options.modal=!0,this._initLayout(),this._initButtonGroup(),MapExpress.Controls.MapControlUtils.addClassName(this._controlContent,"mapexpress-control-content_notify")},onOK:function(a,b){function c(){a.call(b,this)}this.okButton.onclick=c},onCancel:function(a,b){function c(){a.call(b,this)}this.cancelButton.onclick=c},_initButtonGroup:function(){var a=this,b=L.DomUtil.create("div","mapexpress-control-footerbar__buttongroup",this._controlFooterBar);this.okButton=L.DomUtil.create("button","mapexpress-control-footerbar__buttongroup__button",b),this.okButton.setAttribute("id","okbutton");var c=L.DomUtil.create("span","mapexpress-control-footerbar__buttongroup__button__text",this.okButton);c.textContent=this.options.okButtonText,$(this.okButton).click(function(){a.hide()}),MapExpress.Controls.MapControlUtils.stopMousePropagation(this.okButton),this.cancelButton=L.DomUtil.create("button","mapexpress-control-footerbar__buttongroup__button cancel",b),this.cancelButton.setAttribute("id","cancelbutton");var d=L.DomUtil.create("span","mapexpress-control-footerbar__buttongroup__button__text",this.cancelButton);d.textContent=this.options.cancelButtonText,$(this.cancelButton).click(function(){a.hide()}),MapExpress.Controls.MapControlUtils.stopMousePropagation(this.cancelButton)}});var geoJSONAutoComplete=function(a){};geoJSONAutoComplete.prototype={initialize:function(a,b){this.options=a,this.activeSearchProvider=a.startProvider,void 0===a.drawStyleOptions&&(a.drawStyleOptions={color:"blue",weight:2,opacity:.65,fillColor:"red",fillOpacity:.2}),this.options.delay=300,this.options.limitToShowResults=25,this.features=[];var c=$(b.toString()).addClass("mapExpress-searchContainer");c.append('<input id="mapExpress-searchBox" class="mapExpress-searchBox" />'),c.append('<span class="mapExpress-divider"></span>'),c.append('<input id="mapExpress-clearButton" class="mapExpress-clearButton" type="submit" value=""/>'),c.append('<span class="mapExpress-divider"></span>'),c.append('<span class="mapExpress-searchServices"/>'),c.append('<div class="mapExpress-resultsDiv"/>'),this.createSearchProviderList(),this.searchBoxManage()},createSearchProviderList:function(){for(var a,b,c=this,d=$(".mapExpress-searchServices").attr("title",this.activeSearchProvider.getName()),e=$("<ul/>").addClass("mapExpress-searchServicesList").appendTo(d).hide(),f=0;f<this.options.providers.length;f++)this.options.providers[f].getName()===this.activeSearchProvider.getName()?(b=$("<li/>").appendTo(e),a=$("<a />").addClass("mapExpress-activeSearchProvider").text(this.activeSearchProvider.getName()).appendTo(b)):(b=$("<li/>").appendTo(e),a=$("<a />").addClass("mapExpress-SearchProvider").text(this.options.providers[f].getName()).appendTo(b));return $(".mapExpress-searchServices").click(function(){$(".mapExpress-resultList").hide(),e.is(":visible")?e.hide():e.show()}),$(e).click(function(a){if(a.stopPropagation(),"mapExpress-searchServicesList"!==$(a.target).attr("class"))if("mapExpress-SearchProvider"===$(a.target).attr("class")||"mapExpress-activeSearchProvider"===$(a.target).attr("class")){$(".mapExpress-activeSearchProvider").attr("class","mapExpress-SearchProvider"),$(a.target).attr("class","mapExpress-activeSearchProvider");for(var b=c.options.providers.length-1;b>=0;b--)c.options.providers[b].getName()===$(".mapExpress-activeSearchProvider").text()&&(c.activeSearchProvider=c.options.providers[b],$(".mapExpress-searchBox")[0].placeholder=c.activeSearchProvider.getName(),$(".mapExpress-searchServices").attr("title",c.activeSearchProvider.getName()));c.clearDivClick(),e.hide()}else e.hide()}),$(document).click(function(){e.is(":visible")&&e.hide()}),e.html()},searchBoxManage:function(){var a=$(".mapExpress-searchBox"),b=this;a[0].placeholder=b.activeSearchProvider.getName(),a.delayKeyup=function(a,b){var c=0;return $(this).keyup(function(d){13!==d.keyCode&&38!==d.keyCode&&40!==d.keyCode?(clearTimeout(c),c=setTimeout(function(){a(d)},b)):a(d)}),$(this)},a.value="",a.delayKeyup(function(c){switch(c.keyCode){case 13:b.getValuesAsGeoJson();break;default:a[0].value.length>0?b.getValuesAsGeoJson():b.clearDivClick()}},b.options.delay),a.focus(function(){void 0!==$(".mapExpress-resultList")[0]&&($(".mapExpress-resultList")[0].style.visibility="visible")}),a.blur(function(){void 0!==$(".mapExpress-resultList")[0]&&window.setTimeout(function(){a.focus()},0)}),$("#mapExpress-clearButton").click(function(){b.clearDivClick()}),a.click(function(){b.features.length>0&&b.createDropDown(b.features)}),$(document).click(function(){$(".mapExpress-resultList").is(":visible")&&$(".mapExpress-resultList").hide()})},clearDivClick:function(){$(".mapExpress-resultList").remove(),this.features=[],$(".mapExpress-searchBox")[0].value=""},getValuesAsGeoJson:function(){var a=this,b=$(".mapExpress-searchBox")[0].value;this.activeSearchProvider.getDataByMaskAsynch(b).then(function(b){a.features=b,b.length>0?a.createDropDown(b):a.processNoRecordsFoundOrError()},function(b){a.processNoRecordsFoundOrError()})},createDropDown:function(a){var b=this;$(".mapExpress-searchServicesList").hide(),$(".mapExpress-resultList").remove();for(var c=($(".mapExpress-searchContainer"),$(".mapExpress-resultsDiv")),d=$("<ul/>").addClass("mapExpress-resultList").appendTo(c),e=0;e<a.length;e++){if(e>b.options.limitToShowResults)return;var f=$("<li />").attr("id","mapExpress-listelement"+e).addClass("mapExpress-listelement").appendTo(d),g=$("<span />").addClass("mapExpress-content").appendTo(f);$("<img />").addClass("mapExpress-listElementContentImage").attr("src","images/"+(a[e].geojson||a[e].geometry).type+".png").attr("align","middle").appendTo(g),$("<font />").addClass("mapExpress-listElementContentText").text(a[e].display_name).appendTo(g)}$(".mapExpress-listelement").click(function(a){if("mapExpress-listelement"===$(a.target).attr("class"))b.dropDownManage(a.target);else{if("content"!==$(a.target).attr("class")&&"mapExpress-listElementContentText"!==$(a.target).attr("class"))return;b.dropDownManage(a.currentTarget)}})},dropDownManage:function(a){var b=parseInt(a.id.substr(22));this.activeSearchProvider.processResult(this.features[b],this.options),$(".mapExpress-searchBox")[0].value=this.features[b].display_name,$(".mapExpress-resultList").remove()},processNoRecordsFoundOrError:function(){$(".mapExpress-resultList").remove();var a=$("<ul/>").addClass("mapExpress-resultList").appendTo($(".mapExpress-resultsDiv")),b=$("<li />").addClass("mapExpress-listelementError").appendTo(a),c=$("<span />").addClass("mapExpress-content").appendTo(b);$("<font />").addClass("mapExpress-listElementContentText").text("По вашему запросу ничего не найдено").appendTo(c)}},MapExpress.Controls.ZoomStandartStatusbarSection=MapExpress.Controls.BaseStatusbarSection.extend({options:{id:"mapexpress-statusbar-section-zoom",containerClassName:"mapexpress-statusbar__section",contentClassName:"mapexpress-section__zoom",zoomTeplate:"Уровень: {zoom}"},initListeners:function(){MapExpress.Controls.BaseStatusbarSection.prototype.initListeners.call(this),this._mapManager._map.on("zoomend",this.updateContent,this)},updateContent:function(){$(this.section).html(L.Util.template(this.options.zoomTeplate,{zoom:this._mapManager._map.getZoom()}))},createContent:function(){return this.section=L.DomUtil.create("div",this.options.contentClassName,this.getContainer()),this.updateContent(),this.section}}),MapExpress.Controls.CoordinatesStandartStatusbarSection=MapExpress.Controls.BaseStatusbarSection.extend({options:{id:"mapexpress-statusbar-section-coordinates",containerClassName:"mapexpress-statusbar__section",contentClassName:"mapexpress-section__coordinates",latTemplate:"Широта: {lat}",lngTemplate:"Долгота: {lng}",useDMS:!0,separator:".",roundDecimals:4},initListeners:function(){return MapExpress.Controls.BaseStatusbarSection.prototype.initListeners.call(this),this._mapManager._map.on("mousemove",this.updateContent,this),this},removeListeners:function(){return MapExpress.Controls.BaseStatusbarSection.prototype.initListeners.call(this),this._mapManager._map.off("mousemove",this.updateContent,this),this},updateContent:function(a){var b=L.Util.template(this.options.lngTemplate,{lng:this.readableCords((a.latlng||a).lng)}),c=L.Util.template(this.options.latTemplate,{lat:this.readableCords((a.latlng||a).lat)});$(this.section).html(c+", "+b)},createContent:function(){return this.section=L.DomUtil.create("div",this.options.contentClassName,this.getContainer()),this.updateContent(this._mapManager._map.getCenter()),
this.section},readableCords:function(a){return this.options.useDMS?this.toDMS(a):this.round(a,this.options.roundDecimals,this.options.separator)},toDMS:function(a){var b=Math.floor(Math.abs(a)),c=60*(Math.abs(a)-b),d=Math.floor(c),e=60*(c-d),f=Math.round(e);60===f&&(d++,f="00"),60===d&&(b++,d="00"),f<10&&(f="0"+f),d<10&&(d="0"+d);var g="";return a<0&&(g="-"),""+g+b+"&deg; "+d+"' "+f+"''"},round:function(a,b,c){var d=L.Util.formatNum(a,b)+"",e=d.split(".");if(e[1]){for(var f=b-e[1].length;f>0;f--)e[1]+="0";d=e.join(c||".")}return d}}),MapExpress.Controls.AttibutionStandartStatusbarSection=MapExpress.Controls.BaseStatusbarSection.extend({options:{id:"mapexpress-statusbar-section-attibution",containerClassName:"mapexpress-statusbar__section",contentClassName:"mapexpress-section__attibution",attibution:[]},createContent:function(){var a=this;if(this.section=L.DomUtil.create("div",this.options.contentClassName,this.getContainer()),this.options.attibution&&this.options.attibution.length>0)for(var b=0;b<this.options.attibution.length;b++)$(L.DomUtil.create("a",!1,a.section)).attr("href",this.options.attibution[b].href).html(this.options.attibution[b].prefix),b!==this.options.attibution.length-1&&this.addDivider(a.section);return a.section}}),MapExpress.Controls.CurrentToolStatusbarSection=MapExpress.Controls.BaseStatusbarSection.extend({options:{id:"mapexpress-statusbar-section-current-tool",containerClassName:"mapexpress-statusbar__section",contentClassName:"mapexpress-section__currenttool",toolTemplate:"Инструмент: {tool}"},initialize:function(a,b,c){MapExpress.Controls.BaseStatusbarSection.prototype.initialize.call(this,a,b,c),window.MapManager.on("mapexpress:maptoolbar:command:activated",this._onActiveToolChanged,this)},createContent:function(){return this.section=L.DomUtil.create("div",this.options.contentClassName,this.getContainer()),this.updateContent(),this.section},_onActiveToolChanged:function(a){var b="Неизвестно";void 0!==a.options.title&&(b=a.options.title);var c=L.Util.template(this.options.toolTemplate,{tool:b});this.setContent(c)}}),MapExpress.Controls.ScaleStatusbarSection=MapExpress.Controls.BaseStatusbarSection.extend({options:{id:"mapexpress-statusbar-section-coordinates",containerClassName:"mapexpress-statusbar__section",contentClassName:"mapexpress-section__scale",scaleTemplate:" М 1: {formatScale}",separator:" "},initListeners:function(){this._mapManager._map.on("moveend",this.updateContent,this)},removeListeners:function(){return MapExpress.Controls.BaseStatusbarSection.prototype.removeListeners.call(this),this._mapManager._map.off("moveend",this.updateContent,this),this},pixelsInMeter:function(){var a=document.createElement("div");a.style.cssText="position: absolute;  left: -100%;  top: -100%;  width: 100cm;",document.body.appendChild(a);var b=a.offsetWidth;return document.body.removeChild(a),b},updateContent:function(a){var b=this._mapManager._map.getSize().y,c=this._mapManager._map.getSize().x,d=this._mapManager._map.containerPointToLatLng([0,b]).distanceTo(this._mapManager._map.containerPointToLatLng([c,b])),e=d/c,f=e*this.pixelsInMeter(),g=L.Util.template(this.options.scaleTemplate,{formatScale:this.readableScale(f)});$(this.section).html(g)},readableScale:function(a){return(10*Math.round(a/10)).toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.options.separator)},createContent:function(){return this.section=L.DomUtil.create("label",this.options.contentClassName,this.getContainer()),this.updateContent(this._mapManager._map.getCenter()),this.section}}),MapExpress.Controls.TreeLayerControl=L.Control.extend({options:{position:"topright",className:"mapexpress-control-treelayercontrol"},initialize:function(a,b){this._mapManager=a,L.setOptions(this,b),this._mapManager.on("mapexspress:mapmanager:layer:visiblechanged",this._updateViaListeners,this)},onAdd:function(){return this._div=L.DomUtil.create("div",this.options.className),this._div.setAttribute("id","treelayercontrol"),this._div},addTo:function(a){L.Control.prototype.addTo.call(this,this._mapManager._map),this.render(this._div)},render:function(a){var b=this,c=this._mapManager.getMapModel(),d={};d.id=c.id,d.text=c.options.displayName,this._processLayerModel(d,c._layers);var e={core:{data:d.children},plugins:["checkbox","wholerow"]};$.jstree.defaults.checkbox.keep_selected_style=!1,$.jstree.defaults.checkbox.tie_selection=!1;var f=a?a:document.getElementById("treelayercontrol");if(!f)return void this._mapManager.off("mapexspress:mapmanager:layer:visiblechanged",this._updateViaListeners,this);L.DomUtil.empty(f),MapExpress.Controls.MapControlUtils.stopMousePropagation(f),$.jstree.destroy();var g=$(f).jstree(e);g.on("check_node.jstree",function(a,c){c.node.parent&&"Базовые карты"===c.node.parent?(b._mapManager.setActiveBaseMap(c.node.id),b._mapManager.fire("treelayer:layer:show",{id:c.node.id})):(b._mapManager.setLayerVisible(c.node.id,!0),b._mapManager.fire("treelayer:layer:show",{id:c.node.id}))}),g.on("uncheck_node.jstree",function(a,c){c.node&&(b._mapManager.setLayerVisible(c.node.id,!1),b._mapManager.fire("treelayer:layer:hide",{id:c.node.id}))})},_processLayerModel:function(a,b){a.children=[];for(var c=0;c<b.length;c++){var d=b[c],e={};"base"===d.options.type&&"Базовые карты"!==a.text||d.options.showOnTOC===!1||(e=this._createNode(d),a.children.push(e)),d.hasChildren()&&(e||(e=a),this._processLayerModel(e,d._layers))}},_createNode:function(a){var b={};return b.id=a.id,b.text=a.options.displayName,a.mapLayer&&(b.state={checked:a.mapLayer.options.visible}),b},_updateViaListeners:function(a){var b=$("#treelayercontrol");b&&!b.hasClass("active")&&this.render(this._div)}}),MapExpress.Edit.VertexMarker=L.Editable.VertexMarker.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-vertex-icon mapexpress-edit-vertexmarker"},initialize:function(a,b,c,d){L.Editable.VertexMarker.prototype.initialize.call(this,a,b,c,d)}}),MapExpress.Edit.MiddleMarker=L.Editable.MiddleMarker.extend({options:{draggable:!0,className:"leaflet-div-icon leaflet-middle-icon mapexpress-edit-vertexmarker_middle"},initialize:function(a,b,c,d,e){L.Editable.MiddleMarker.prototype.initialize.call(this,a,b,c,d,e)}}),MapExpress.Edit.BaseLayerEditor=L.Evented.extend({CHANGE_TYPE:{insert:"insert",update:"update",delete:"delete"},options:{featureKeyFieldName:"id",useEditFeatureOriginalStyle:!1,editFeatureStyle:{color:"#424447",weight:3,fillOpacity:.1}},initialize:function(a,b){L.setOptions(this,b),this.editTools=new L.Editable(window.MapManager._map,b),this.editTools.options.vertexMarkerClass=MapExpress.Edit.VertexMarker,this.editTools.options.middleMarkerClass=MapExpress.Edit.MiddleMarker,window.MapManager._map.editTools=this.editTools,this.recreateEditLayerGroup(),this.setEditableLayer(a)},setEditableLayer:function(a){this._layerModel&&delete this._layerModel,this._layerModel=window.MapManager._mapModel.getLayerById(a),this.recreateEditLayerGroup(),this._layerModel&&this._layerModel.mapLayer&&(this._layerModel.mapLayer.layerEditor&&delete this._layerModel.mapLayer.layerEditor,this._layerModel.mapLayer.layerEditor=this,this._layerModel.on("mapexspress:layermodel:visiblechanged",function(a){this._layerModel.mapLayer.options.visible||this.clearEditLayer()},this),this._layerModel.mapLayer.on("mapexspress:layer:data:clear",function(a){this.clearEditLayer()},this)),this.options.useEditFeatureOriginalStyle||this.editTools.on("editable:editing",function(a){a.layer.setStyle(this.options.editFeatureStyle)},this)},getEditLayerGroup:function(){return this._editLayerGroup},recreateEditLayerGroup:function(){this.clearEditLayer(),this._editLayerGroup&&delete this._editLayerGroup;var a=this._layerModel&&this._layerModel.mapLayer?this._layerModel.mapLayer.options:null;this._editLayerGroup=new L.geoJSON(null,a).addTo(window.MapManager._map),this._bringToFrontEditLayer()},getEditableLayerModel:function(){return this._layerModel},getEditableMapLayer:function(){return this._layerModel.mapLayer},getEditTools:function(){return this.editTools},startEdit:function(){this.stopDrawing(),this._layerModel&&this._layerModel.mapLayer&&this._layerModel.mapLayer._map&&this._editLayerGroup&&(this._startEditLayer(),this._layerModel.mapLayer.off("mapexspress:layer:data:added",this._startEditLayer,this),this._layerModel.mapLayer.on("mapexspress:layer:data:added",this._startEditLayer,this),this._bringToFrontEditLayer(),window.MapManager.off("mapexspress:mapmanager:layer:overlaysreordered",this._bringToFrontEditLayer,this),window.MapManager.on("mapexspress:mapmanager:layer:overlaysreordered",this._bringToFrontEditLayer,this))},stopEdit:function(){this.clearEditLayer(),this._layerModel&&this._layerModel.mapLayer&&this._layerModel.mapLayer._map&&this._editLayerGroup&&this._layerModel.mapLayer.off("mapexspress:layer:data:added",this._startEditLayer,this),this.stopDrawing(),window.MapManager.off("mapexspress:mapmanager:layer:overlaysreordered",this._bringToFrontEditLayer,this),window.MapManager._map._container.style.cursor=""},startAddCircleMarker:function(){this.editTools.off("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.on("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.startCircle()},startAddPolyline:function(){this.editTools.off("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.on("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.startPolyline()},startAddPolygon:function(){this.editTools.off("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.on("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.startPolygon()},startAddPolygonShape:function(a){a&&a instanceof L.Polygon&&a.editor.newShape()},startAddRectangle:function(){this.editTools.off("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.on("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.startRectangle()},stopDrawing:function(){this.editTools&&(this.editTools.off("editable:drawing:commit",this._onInsertFeatureComplete,this),this.editTools.stopDrawing())},onSaveFeature:function(a){},onSaveAsFeatureCollection:function(a){},saveChanges:function(){this.onSaveAsFeatureCollection(this._editLayerGroup.toGeoJSON());for(var a=this._editLayerGroup.getLayers(),b=a.length-1;b>=0;b--){var c=a[b].toGeoJSON();this.onSaveFeature(c)}this.clearEditLayer()},rejectChanges:function(){this.clearEditLayer()},clearEditLayer:function(){this._editLayerGroup&&this._editLayerGroup.clearLayers()},_startEditLayer:function(){function a(){b._editLayerGroup.bringToFront()}var b=this;this._layerModel&&this._layerModel.mapLayer&&this._layerModel.mapLayer.eachLayer(function(a){a&&!b._getLayerByIdFromEditLayerGroup(a)&&b._addFeatureToEditLayer(a,b.CHANGE_TYPE.update)}),this._bringToFrontEditLayer(),window.setTimeout(a,1500)},_onInsertFeatureComplete:function(a){function b(a){var b={};b.layer=a.layer,b.geoJSON=a.layer.toGeoJSON(),c._fireAndForward("mapexpress:edit:newfeatureadded",b)}var c=this;this._addFeatureToEditLayer(a.layer,this.CHANGE_TYPE.insert,b),window.MapManager._map.removeLayer(a.layer),this._bringToFrontEditLayer()},_addFeatureToEditLayer:function(a,b,c){function d(b){c&&"function"==typeof c&&c(b),e._subscribeFeatureToEditOnClick(b),e._updateTempEditFeatureStyle(b.layer,a.options);var d={};d.layer=b.layer,d.geoJSON=b.layer.toGeoJSON(),e._fireAndForward("mapexpress:edit:featureaddedtoeditlayer",d)}var e=this;if(a){var f=a.toGeoJSON();MapExpress.Utils.GeoJSONUtils.featureHasCoordinates(f)&&(this._editLayerGroup.on("layeradd",d,this),this._editLayerGroup.addData(f),this._editLayerGroup.off("layeradd",d,this))}},_updateTempEditFeatureStyle:function(a,b){var c=this.options.useEditFeatureOriginalStyle?b:this.options.editFeatureStyle;a.setStyle(c)},_subscribeFeatureToEditOnClick:function(a){function b(){window.MapManager._map.dragging.disable(),e._bringToFrontEditLayer(),f.bringToFront();var a=e.getEditableMapLayer(),b=MapExpress.Utils.GeoJSONUtils.getLayerByPropertyValueFromLayerGroup(a,e.options.featureKeyFieldName,f.feature.properties[e.options.featureKeyFieldName]);b&&b._mapToAdd&&(g.circleMarker.setStyle(b.options),window.MapManager._map.removeLayer(b)),g.circleMarker.on("mouseup",c),e._fireAndForward("mapexpress:edit:circleMarker:dragstart",g),window.MapManager._map.on("mousemove touchmove",function(a){g.circleMarker.setLatLng(a.latlng),g.circleMarker.bringToFront(),e._fireAndForward("mapexpress:edit:circleMarker:drag",g)})}function c(){window.MapManager._map.removeEventListener("mousemove touchmove"),window.MapManager._map.dragging.enable(),e._fireAndForward("mapexpress:edit:circleMarker:dragend",g)}function d(b){if(e._bringToFrontEditLayer(),e._editLayerGroup.eachLayer(function(a){a.disableEdit&&a.disableEdit()}),a.layer.bringToFront(),b.target.bringToFront(),b.target.toggleEdit&&b.target.toggleEdit(),f.enableEdit){var c="undefined"!==f.editor&&f.editor?f.editor:f.enableEdit();(b.originalEvent.ctrlKey||b.originalEvent.metaKey)&&f.editEnabled()&&!c.alreadyStartHole&&(c.newHole(b.latlng),c.alreadyStartHole=!0)}}var e=this,f=a.layer;f.off("dblclick",L.DomEvent.stop),f.on("click",L.DomEvent.stop),f.off("dblclick",L.DomEvent.stop),f.on("click",L.DomEvent.stop);var g={};f instanceof L.CircleMarker?(g.editor=e,g.circleMarker=f,e._editLayerGroup.eachLayer(function(a){a.off("mouseup",c)}),f.on("mousedown touchstart",b)):(f.off("dblclick",L.DomEvent.stop).off("click",d),f.on("click",L.DomEvent.stop).on("click",d))},_getLayerByIdFromEditLayerGroup:function(a){var b=this.options.featureKeyFieldName;return!!(a&&a.feature&&a.feature.properties&&a.feature.properties.hasOwnProperty(b))&&MapExpress.Utils.GeoJSONUtils.getLayerByPropertyValueFromLayerGroup(this._editLayerGroup,this.options.featureKeyFieldName,a.feature.properties[b])},_bringToFrontEditLayer:function(){this._editLayerGroup&&this._editLayerGroup.bringToFront()},_fireAndForward:function(a,b){b=b||{},b.editor=this,this.fire(a,b),window.MapManager._map.fire(a,b)}}),MapExpress.Utils.BufferBuilder={createLineStringBuffer:function(a,b){return this._buffer(a,b/=111120)},_buffer:function(a,b){var c=new jsts.io.GeoJSONReader,d=new jsts.io.GeoJSONWriter,e=c.read(a).geometry.buffer(b,10,3);return d.write(e)}},MapExpress.Utils.BufferLine=L.Polyline.extend({options:{className:"leaflet-interactive mapexpress-buffer-linestring"}}),MapExpress.Utils.BufferVertex=L.Editable.VertexMarker.extend({options:{className:"leaflet-div-icon leaflet-editing-icon mapexpress-buffer-edge"},initialize:function(a,b,c,d){L.Editable.VertexMarker.prototype.initialize.call(this,a,b,c,d)},onAdd:function(a){L.Editable.VertexMarker.prototype.onAdd.call(this,a),this.on("drag",this.onVertexDrag),this.addMiddleMarkers()},onVertexDrag:function(a){}}),MapExpress.Utils.BufferMiddleVertex=L.Editable.MiddleMarker.extend({options:{className:"leaflet-div-icon leaflet-editing-icon mapexpress-buffer-middle-edge"},initialize:function(a,b,c,d,e,f){this.middle=f,L.Editable.MiddleMarker.prototype.initialize.call(this,a,b,c,d,e)},computeLatLng:function(a){var b,c,d,e;return this.middle&&void 0!==this.middle.m?(d=this.editor.map.latLngToContainerPoint(this.middle.m).y,e=this.editor.map.latLngToContainerPoint(this.middle.m).x):(b=this.editor.map.latLngToContainerPoint(this.left.latlng),c=this.editor.map.latLngToContainerPoint(this.right.latlng),d=(b.y+c.y)/2,e=(b.x+c.x)/2),this.editor.map.containerPointToLatLng([e,d])},onMouseDown:function(a){var b=L.DomUtil.getPosition(this._icon),c=this.editor.map.layerPointToLatLng(b);if(a={originalEvent:a,latlng:c},0!==this.options.opacity&&(L.Editable.makeCancellable(a),this.editor.onMiddleMarkerMouseDown(a),!a._cancelled)){this.latlngs.splice(this.index(),0,a.latlng),this.editor.refresh();var d=(this._icon,this.editor.addVertexMarker(a.latlng,this.latlngs));L.Draggable._dragging=!1,d.dragging._draggable._onDown(a.originalEvent),this.delete()}}}),L.BufferPathEditorInclude={addNonMiddleMarker:function(a,b,c,d){return new this.tools.options.middleMarkerClass(a,b,d,this,{},c)},onVertexDeleted:function(a){this.fireAndForward("editable:vertex:deleted",a);for(var b in this.editLayer._layers)this.editLayer._layers[b].middle&&this.editLayer._layers[b].remove()},onPathClick:function(){this.feature.on("click",function(a){var b=(a.layerPoint,this.feature.toGeoJSON());for(var c in this.editLayer._layers)this.editLayer._layers[c].middle&&this.editLayer._layers[c].remove();var d,e,f,g,h,i,j={},k={},l={m:a.latlng};if("LineString"===b.geometry.type||"MultiLineString"===b.geometry.type){for(var m=0;m<this.feature._rings.length;m++)for(var n=0;n<this.feature._rings[m].length-1;n++)if(i=[this.feature._rings[m][n],this.feature._rings[m][n+1]],j.x=a.layerPoint.x-this.feature._rings[m][n].x,j.y=a.layerPoint.y-this.feature._rings[m][n].y,k.x=a.layerPoint.x-this.feature._rings[m][n+1].x,k.y=a.layerPoint.y-this.feature._rings[m][n+1].y,d=j.x*k.x+j.y*k.y,e=L.LineUtil.pointToSegmentDistance(a.layerPoint,L.point(this.feature._rings[m][n].x,this.feature._rings[m][n].y),L.point(this.feature._rings[m][n+1].x,this.feature._rings[m][n+1].y)).toFixed(0),d<=0&&Number(e)<=1){for(h in this.editLayer._layers)this.editLayer._layers[h]._latlng.lat===this.feature._latlngs[n].lat&&this.editLayer._layers[h]._latlng.lng===this.feature._latlngs[n].lng&&(f=this.editLayer._layers[h]),this.editLayer._layers[h]._latlng.lat===this.feature._latlngs[n+1].lat&&this.editLayer._layers[h]._latlng.lng===this.feature._latlngs[n+1].lng&&(g=this.editLayer._layers[h]);this.addNonMiddleMarker(f,g,l,this.feature._latlngs)}}else if("Polygon"===b.geometry.type||"MultiPolygon"===b.geometry.type)for(var o=0;o<this.feature._rings.length;o++){for(var p=[],q=[],r=0;r<this.feature._rings[o].length;r++)p.push(this.feature._rings[o][r]),q.push(this.feature._latlngs[o][r]);p.push(this.feature._rings[o][0]),q.push(this.feature._latlngs[o][0]);for(var s=0;s<p.length-1;s++)if(i=[p[s],p[s+1]],j.x=a.layerPoint.x-p[s].x,j.y=a.layerPoint.y-p[s].y,k.x=a.layerPoint.x-p[s+1].x,k.y=a.layerPoint.y-p[s+1].y,d=j.x*k.x+j.y*k.y,e=L.LineUtil.pointToSegmentDistance(a.layerPoint,L.point(p[s].x,p[s].y),L.point(p[s+1].x,p[s+1].y)).toFixed(0),d<=0&&Number(e)<=1){for(h in this.editLayer._layers)this.editLayer._layers[h]._latlng.lat===q[s].lat&&this.editLayer._layers[h]._latlng.lng===q[s].lng&&(f=this.editLayer._layers[h]),this.editLayer._layers[h]._latlng.lat===q[s+1].lat&&this.editLayer._layers[h]._latlng.lng===q[s+1].lng&&(g=this.editLayer._layers[h]);this.addNonMiddleMarker(f,g,l,this.feature._latlngs[o])}}},this)},endDrawing:function(){this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),this._drawnLatLngs&&this._drawnLatLngs.length<this.MIN_VERTEX&&this.deleteShape(this._drawnLatLngs),L.Editable.BaseEditor.prototype.endDrawing.call(this),this.onPathClick(),delete this._drawnLatLngs}},MapExpress.Utils.BufferLineEditorClass=L.Editable.PolylineEditor.extend({includes:L.BufferPathEditorInclude}),MapExpress.Utils.BufferEditor=L.Editable.extend({options:{vertexMarkerClass:MapExpress.Utils.BufferVertex,middleMarkerClass:MapExpress.Utils.BufferMiddleVertex,polylineClass:MapExpress.Utils.BufferLine,polylineEditorClass:MapExpress.Utils.BufferLineEditorClass,lineGuideOptions:{color:"#1eb300"},skipMiddleMarkers:!0},initialize:function(a,b){L.Editable.prototype.initialize.call(this,a),L.setOptions(this,b),this.map=a,a.bufferTools&&(a.bufferTools.removeDrawing(),delete a.bufferTools),a.bufferTools=this},abortDrawing:function(){this.stopDrawing()},removeDrawing:function(){this.stopDrawing();var a=this;this.featuresLayer.eachLayer(function(b){b.remove(),delete a.featuresLayer._layers[b._leaflet_id]}),this.editLayer.eachLayer(function(b){b.remove(),delete a.editLayer._layers[b._leaflet_id]})},startPolyline:function(){return this.map.doubleClickZoom&&this.map.doubleClickZoom.disable(),this.on("editable:drawing:commit",this._endPolylineBuffer,this),this.on("editable:vertex:drag",this._redrawPolylineBuffers,this),L.Editable.prototype.startPolyline.call(this),this},_endPolylineBuffer:function(a){var b=this;setTimeout(function(){b.map.doubleClickZoom.enable()},400),this._drawBuffer(a.layer),this.on("editable:vertex:new",this._redrawPolylineBuffers,this),this.on("editable:vertex:deleted",this._redrawPolylineBuffers,this)},_redrawPolylineBuffers:function(){var a=this;this.featuresLayer.eachLayer(function(b){"bufferLineString"===b.type&&(b.remove(),delete a.featuresLayer._layers[b._leaflet_id])}),this.featuresLayer.eachLayer(function(b){a._drawBuffer(b)})},_drawBuffer:function(a){var b=MapExpress.Utils.BufferBuilder.createLineStringBuffer(a.toGeoJSON(),this.getDistance()),c=L.geoJSON(b);c.type="bufferLineString",this.featuresLayer.addLayer(c),this.featuresLayer.eachLayer(function(a){"bufferLineString"===a.type&&a.bringToBack()})},setDistance:function(a,b){if(Number(a)<0)throw new Error("Дистанция не может быть отрицательной!");if(isNaN(Number(a)))throw new Error("Ошибка задания дистанции!");this.distance=Number(a),b&&this._redrawPolylineBuffers()},getDistance:function(){if(!this.distance)throw new Error("Не задана дистанция буффера!");return this.distance},bufferDataToGeoJSON:function(a){var b=null;return this.featuresLayer.eachLayer(function(c){"bufferLineString"===c.type&&a?b=c.toGeoJSON().features[0]:"bufferLineString"===c.type||a||(b=c.toGeoJSON())}),b},createBufferResult:function(){var a=this;return this.featuresLayer.toGeoJSON().features.length?{bufferGeoJSON:a.bufferDataToGeoJSON(!0),lineStringGeoJSON:a.bufferDataToGeoJSON(!1)}:null}}),L.MeasureLine=L.Polyline.extend({options:{className:"leaflet-interactive leaflet-measure-line"}}),L.MeasurePolygon=L.Polygon.extend({options:{className:"leaflet-interactive leaflet-measure-polygon"}}),L.MeasureVertex=L.Editable.VertexMarker.extend({options:{className:"leaflet-div-icon leaflet-editing-icon leaflet-measure-edge"},initialize:function(a,b,c,d){L.Editable.VertexMarker.prototype.initialize.call(this,a,b,c,d)},onAdd:function(a){L.Editable.VertexMarker.prototype.onAdd.call(this,a),this.on("mouseover",this.onMouseOver),this.on("mouseout",this.onMouseOut),this.on("drag",this.onVertexDrag),this.addMiddleMarkers()},onVertexDrag:function(a){this.editor.continueBackward?a.target.editor.tools.getMeasureLength(a):this.editor.addNewEmptyHole&&a.target.editor.tools.getMeasureArea(a)},onMouseOver:function(a){this.editor.continueBackward?a.target.editor.tools.getMeasureLength(a):this.editor.addNewEmptyHole&&a.target.editor.tools.getMeasureArea(a)},onMouseOut:function(a){a.target._map.doubleClickZoom.enable(),this.editor.continueBackward?a.target.editor.tools.getMeasureLength(a):this.editor.addNewEmptyHole&&a.target.editor.tools.getMeasureArea(a)}}),L.MeasureMiddleVertex=L.Editable.MiddleMarker.extend({options:{className:"leaflet-div-icon leaflet-editing-icon leaflet-measure-middleEdge"},initialize:function(a,b,c,d,e,f){this.middle=f,L.Editable.MiddleMarker.prototype.initialize.call(this,a,b,c,d,e)},onAdd:function(a){L.Editable.MiddleMarker.prototype.onAdd.call(this,a),this.map=a,this.on("mouseover",this.calculateLength),this.on("mouseout",this.calculateLength)},computeLatLng:function(a){var b,c,d,e;return this.middle&&void 0!==this.middle.m?(d=this.editor.map.latLngToContainerPoint(this.middle.m).y,e=this.editor.map.latLngToContainerPoint(this.middle.m).x):(b=this.editor.map.latLngToContainerPoint(this.left.latlng),c=this.editor.map.latLngToContainerPoint(this.right.latlng),d=(b.y+c.y)/2,e=(b.x+c.x)/2),this.editor.map.containerPointToLatLng([e,d])},calculateLength:function(a){var b=[this.left.latlng,this.right.latlng],c=L.GeoUtil.lineLength(this.map,b),d=this.map.latLngToLayerPoint(this._latlng),e=L.GeoUtil.readableDistance(c),f=this.editor.options.editTools.options.labelStyle;"mouseover"===a.type?(d.newLabel("Длина сегмента: "+e,!0,"middle",null,f),this.layerPoint=d):void 0!==this.layerPoint&&this.layerPoint.removeLabel("middle")},onRemove:function(a){L.Editable.MiddleMarker.prototype.onRemove.call(this,a),void 0!==this.layerPoint&&this.layerPoint.removeLabel("middle")},onMouseDown:function(a){var b=L.DomUtil.getPosition(this._icon),c=this.editor.map.layerPointToLatLng(b);if(a={originalEvent:a,latlng:c},0!==this.options.opacity&&(L.Editable.makeCancellable(a),this.editor.onMiddleMarkerMouseDown(a),!a._cancelled)){this.latlngs.splice(this.index(),0,a.latlng),this.editor.refresh();var d=(this._icon,this.editor.addVertexMarker(a.latlng,this.latlngs));L.Draggable._dragging=!1,d.dragging._draggable._onDown(a.originalEvent),this.delete()}}}),L.MeasurablePathEditorInclude={addNonMiddleMarker:function(a,b,c,d){return new this.tools.options.middleMarkerClass(a,b,d,this,{},c)},onVertexDeleted:function(a){this.fireAndForward("editable:vertex:deleted",a);for(var b in this.editLayer._layers)this.editLayer._layers[b].middle&&this.editLayer._layers[b].remove()},onPathClick:function(){this.feature.on("click",function(a){var b=(a.layerPoint,this.feature.toGeoJSON());for(var c in this.editLayer._layers)this.editLayer._layers[c].middle&&this.editLayer._layers[c].remove();var d,e,f,g,h,i,j={},k={},l={m:a.latlng};if("LineString"===b.geometry.type||"MultiLineString"===b.geometry.type){for(var m=0;m<this.feature._rings.length;m++)for(var n=0;n<this.feature._rings[m].length-1;n++)if(i=[this.feature._rings[m][n],this.feature._rings[m][n+1]],j.x=a.layerPoint.x-this.feature._rings[m][n].x,j.y=a.layerPoint.y-this.feature._rings[m][n].y,k.x=a.layerPoint.x-this.feature._rings[m][n+1].x,k.y=a.layerPoint.y-this.feature._rings[m][n+1].y,d=j.x*k.x+j.y*k.y,e=L.LineUtil.pointToSegmentDistance(a.layerPoint,L.point(this.feature._rings[m][n].x,this.feature._rings[m][n].y),L.point(this.feature._rings[m][n+1].x,this.feature._rings[m][n+1].y)).toFixed(0),d<=0&&Number(e)<=1){for(h in this.editLayer._layers)this.editLayer._layers[h]._latlng.lat===this.feature._latlngs[n].lat&&this.editLayer._layers[h]._latlng.lng===this.feature._latlngs[n].lng&&(f=this.editLayer._layers[h]),this.editLayer._layers[h]._latlng.lat===this.feature._latlngs[n+1].lat&&this.editLayer._layers[h]._latlng.lng===this.feature._latlngs[n+1].lng&&(g=this.editLayer._layers[h]);this.addNonMiddleMarker(f,g,l,this.feature._latlngs)}}else if("Polygon"===b.geometry.type||"MultiPolygon"===b.geometry.type)for(var o=0;o<this.feature._rings.length;o++){for(var p=[],q=[],r=0;r<this.feature._rings[o].length;r++)p.push(this.feature._rings[o][r]),q.push(this.feature._latlngs[o][r]);p.push(this.feature._rings[o][0]),q.push(this.feature._latlngs[o][0]);for(var s=0;s<p.length-1;s++)if(i=[p[s],p[s+1]],j.x=a.layerPoint.x-p[s].x,j.y=a.layerPoint.y-p[s].y,k.x=a.layerPoint.x-p[s+1].x,k.y=a.layerPoint.y-p[s+1].y,d=j.x*k.x+j.y*k.y,e=L.LineUtil.pointToSegmentDistance(a.layerPoint,L.point(p[s].x,p[s].y),L.point(p[s+1].x,p[s+1].y)).toFixed(0),d<=0&&Number(e)<=1){for(h in this.editLayer._layers)this.editLayer._layers[h]._latlng.lat===q[s].lat&&this.editLayer._layers[h]._latlng.lng===q[s].lng&&(f=this.editLayer._layers[h]),this.editLayer._layers[h]._latlng.lat===q[s+1].lat&&this.editLayer._layers[h]._latlng.lng===q[s+1].lng&&(g=this.editLayer._layers[h]);this.addNonMiddleMarker(f,g,l,this.feature._latlngs[o])}}},this)},endDrawing:function(){this.tools.detachForwardLineGuide(),this.tools.detachBackwardLineGuide(),this._drawnLatLngs&&this._drawnLatLngs.length<this.MIN_VERTEX&&this.deleteShape(this._drawnLatLngs),L.Editable.BaseEditor.prototype.endDrawing.call(this),this.onPathClick(),delete this._drawnLatLngs}},L.MeasureablePolylineEditorClass=L.Editable.PolylineEditor.extend({includes:L.MeasurablePathEditorInclude}),L.MeasureablePolygonEditorClass=L.Editable.PolygonEditor.extend({includes:L.MeasurablePathEditorInclude}),L.Measurable=L.Editable.extend({options:{vertexMarkerClass:L.MeasureVertex,polylineClass:L.MeasureLine,polygonClass:L.MeasurePolygon,middleMarkerClass:L.MeasureMiddleVertex,polylineEditorClass:L.MeasureablePolylineEditorClass,polygonEditorClass:L.MeasureablePolygonEditorClass,lineGuideOptions:{color:"#424447"},skipMiddleMarkers:!0,labelStyle:{rec:{rx:1,ry:1,stroke:"#424447","stroke-width":"0px",fill:"#424447","fill-opacity":1},cross:{stroke:"#424447","stroke-width":"0px",fill:"#424447"},text:{"fill-opacity":1,"text-anchor":"middle","font-size":"14px",color:"white",stroke:"white",fill:"white","stroke-width":"0px"}}},initialize:function(a,b){function c(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}L.Editable.prototype.initialize.call(this,a),L.setOptions(this,b),a.measureTools&&(a.measureTools.abortDrawing(),delete a.measureTools),a.measureTools=this,this.id=c(),this.map=a,this.endedPoint={}},initBaseListeners:function(){var a=this;this.map.doubleClickZoom&&this.map.doubleClickZoom.disable(),this.on("editable:drawing:commit editable:vertex:dragend editable:vertex:clicked",function(){a.layerPoint.removeLabel("vertex")})},abortDrawing:function(){this.stopDrawing()},removeDrawing:function(){this.stopDrawing();var a=this;this.featuresLayer.eachLayer(function(b){a.layerPoint&&(a.layerPoint.removeLabel("vertex"),a.layerPoint.removeLabelById("null"),a.layerPoint.removeLabelById(b._leaflet_id)),b.remove()}),this.editLayer.eachLayer(function(a){a.remove()})},startPolyline:function(){var a=this;return this.initBaseListeners(),this.on("editable:drawing:start",function(){a.on("editable:drawing:move",a.getMeasureLength)}),this.on("editable:drawing:commit",this._endPolyline,this),L.Editable.prototype.startPolyline.call(this),this},_endPolyline:function(){var a=this;this.map.doubleClickZoom&&this.map.doubleClickZoom.disable(),this.off("editable:drawing:move",this.getMeasureLength),this.createEndedLabel(this,"Polyline"),this.featuresLayer.eachLayer(function(b){b.toGeoJSON&&b.toGeoJSON().geometry&&"LineString"===b.toGeoJSON().geometry.type&&b.on({mousemove:a.getMeasureLength,mouseover:a.getMeasureLength,mouseout:a.getMeasureLength})})},startPolygon:function(){var a=this;return this.initBaseListeners(),this.on("editable:drawing:start",function(){a.on("editable:drawing:move",a.getMeasureArea)}),this.on("editable:drawing:commit",this._endPolygon,this),L.Editable.prototype.startPolygon.call(this),this},_endPolygon:function(){var a=this;this.map.doubleClickZoom&&this.map.doubleClickZoom.disable(),a.off("editable:drawing:move",a.getMeasureArea),a.createEndedLabel(this,"Polygon")},getMeasureLength:function(a){var b=[];b[0]=a.latlng;var c,d,e;d=this.map?this.map:this._map,a.target.latlngs?c=a.target.latlngs:a.target._latlngs?c=a.target._latlngs:a.layer._defaultShape()&&(c=a.layer._defaultShape());var f=[];if("editable:drawing:move"===a.type)f=c.concat(b);else if(!a.target._icon&&"mouseover"===a.type||"mousemove"===a.type||"mouseout"!==a.type&&a.target._path)for(var g=1;g<a.target._parts[0].length;g++){var h=a.layerPoint,i=a.target._parts[0][g-1],j=a.target._parts[0][g],k=L.LineUtil.pointToSegmentDistance(h,i,j,!0);if(k<5)for(var l=1;l<c.length;l++)f=[c[g-1],c[g]]}else{for(var m,n=0;n<c.length;n++){a.latlng;c[n].lat===a.latlng.lat&&(m=n)}f=c.slice(0,m+1)}for(var o=0;o<f.length;o++)this.layerPoint&&this.layerPoint.removeLabel("vertex");if("mouseout"===a.type)return void this.layerPoint.removeLabel("vertex");var p=L.GeoUtil.readableDistance(L.GeoUtil.lineLength(d,f));this.layerPoint=d.latLngToLayerPoint(a.latlng);var q;if(e=a.target._path?"Длина сегмента: ":"Расстояние: ",q=void 0!==this.options&&void 0!==this.options.labelStyle?this.options.labelStyle:this.editor.options.editTools.options.labelStyle,void 0!==f[f.length-1])this.layerPoint.newLabel(e+p,!0,"vertex",null,q);else if(!f[f.length-1]&&f.length>1)this.layerPoint.newLabel(e+p,!0,"vertex",null,q);else if(void 0===f[f.length-1])return},getMeasureArea:function(a){var b=[];b[0]=a.latlng;var c,d;d=this.map?this.map:this._map,a.target.latlngs?c=a.target.latlngs:a.target._latlngs?c=a.target._latlngs[0]:a.layer._defaultShape()&&(c=a.layer._defaultShape());var e=[];e="editable:drawing:move"===a.type?c.concat(b):c;for(var f=0;f<e.length;f++)this.layerPoint&&this.layerPoint.removeLabel("vertex");if("mouseout"===a.type)return void this.layerPoint.removeLabel("vertex");
var g=[L.GeoUtil.readableArea(L.GeoUtil.geodesicArea(e)),L.GeoUtil.readableDistance(L.GeoUtil.lineLength(d,e.concat(e[0])))],h=this.options.labelStyle;if(void 0!==e[e.length-1].__vertex)this.layerPoint=d.latLngToLayerPoint(a.latlng),this.layerPoint.newLabel(g,!0,"vertex",null,h);else if(!e[e.length-1].__vertex&&e.length>1)this.layerPoint=d.latLngToLayerPoint(a.latlng),this.layerPoint.newLabel(g,!0,"vertex",null,h);else if(void 0===e[e.length-1].__vertex)return;this.layerPoint.newLabel(g,!0,"vertex",null,h)},createEndedLabel:function(a,b){function c(a){var b,c=j.options.labelStyle;if("zoomend"!==a.type){var d=a.layer;if(b=d._leaflet_id,this.endedPoint.removeLabelById(b),"editable:vertex:dragstart"===a.type)return;g=a.layer._defaultShape(),h="Расстояние: "+L.GeoUtil.readableDistance(L.GeoUtil.lineLength(this.map,g));var e=$(".leaflet-map-pane").css("transform").replace("(",",").replace(")","").split(",");this.endedPoint=this.map.latLngToContainerPoint(g[g.length-1]),this.endedPoint.x=this.endedPoint.x-e[e.length-2],this.endedPoint.y=this.endedPoint.y-e[e.length-1],this.endedPoint.newLabel(h,!0,"endedPoint",b,c)}else this.map.eachLayer(function(a){if(a.labeled===!0&&a.toGeoJSON&&"LineString"===a.toGeoJSON().geometry.type){b=a._leaflet_id,j.endedPoint.removeLabelById(b),g=a._defaultShape(),h="Расстояние: "+L.GeoUtil.readableDistance(L.GeoUtil.lineLength(j.map,g));var d=$(".leaflet-map-pane").css("transform").replace("(",",").replace(")","").split(",");j.endedPoint=j.map.latLngToContainerPoint(g[g.length-1]),j.endedPoint.x=j.endedPoint.x-d[d.length-2],j.endedPoint.y=j.endedPoint.y-d[d.length-1],j.endedPoint.newLabel(h,!0,"endedPoint",b,c)}})}function d(a){var b={};for(var c in j.options.labelStyle)b[c]=j.options.labelStyle[c];b.forPolygon=!0,b.notVertex=!0;var d;if("zoomend"!==a.type){var e=a.layer;if(d=e._leaflet_id,this.endedPoint.removeLabelById(d),"editable:vertex:dragstart"===a.type)return;g=e._defaultShape();for(var f=[],k=0;k<g.length;k++)f.push(g[k]);f.push(g[0]),h=[i=L.GeoUtil.readableArea(L.GeoUtil.geodesicArea(f)),L.GeoUtil.readableDistance(L.GeoUtil.lineLength(this.map,f))];var l=$(".leaflet-map-pane").css("transform").replace("(",",").replace(")","").split(",");setTimeout(function(){j.endedPoint=j.map.latLngToContainerPoint(e.getCenter()),j.endedPoint.x=j.endedPoint.x-l[l.length-2],j.endedPoint.y=j.endedPoint.y-l[l.length-1],j.endedPoint.newLabel(h,!0,"endedPoint",d,b)},0)}else this.map.eachLayer(function(a){if(a.labeled===!0&&a.toGeoJSON&&"Polygon"===a.toGeoJSON().geometry.type){d=a._leaflet_id,j.endedPoint.removeLabelById(d),g=a._defaultShape();for(var c=[],e=0;e<g.length;e++)c.push(g[e]);c.push(g[0]),h=[i=L.GeoUtil.readableArea(L.GeoUtil.geodesicArea(c)),L.GeoUtil.readableDistance(L.GeoUtil.lineLength(j.map,c))];var f=$(".leaflet-map-pane").css("transform").replace("(",",").replace(")","").split(",");j.endedPoint=j.map.latLngToContainerPoint(a.getCenter()),j.endedPoint.x=j.endedPoint.x-f[f.length-2],j.endedPoint.y=j.endedPoint.y-f[f.length-1],j.endedPoint.newLabel(h,!0,"endedPoint",d,b)}})}function e(a){return"Polyline"===b?c.call(this,a):"Polygon"===b?d.call(this,a):void 0}function f(a){for(var b=a.layerPoint.x,c=a.layerPoint.y,d=0;d<this.endedPoint.rectangleRegion.length;d++){var g=this.endedPoint.rectangleRegion[d]._groups[0][0].width.baseVal.value,h=this.endedPoint.rectangleRegion[d]._groups[0][0].height.baseVal.value,i=this.endedPoint.rectangleRegion[d]._groups[0][0].x.baseVal.value,j=this.endedPoint.rectangleRegion[d]._groups[0][0].y.baseVal.value,l=this._pointIntersectionMath([b,c],[[i,j],[i+g,j],[i+g,j+h],[i,j+h]]);if(l===!0){var m=this;this.endedPoint.removeLabelById(k),this.map.eachLayer(function(a){a._leaflet_id.toString()===k.toString()&&(a.labeled=!1,m.layerPoint.removeLabel("vertex"),a.remove(),delete m.map.editTools.featuresLayer._layers[a._leaflet_id])}),this.map.off("zoomend",e,this),this.map.off("click",f,this),this.off("editable:vertex:dragstart editable:vertex:deleted editable:vertex:dragend",e)}}}var g,h,i,j=this,k=a.featuresLayer._layers[Object.keys(a.featuresLayer._layers)[0]]._leaflet_id,l=$(".leaflet-map-pane").css("transform").replace("(",",").replace(")","").split(",");if(g=a.featuresLayer._layers[Object.keys(a.featuresLayer._layers)[0]]._defaultShape(),a.featuresLayer._layers[Object.keys(a.featuresLayer._layers)[0]].labeled=!0,"Polyline"===b)h="Расстояние: "+L.GeoUtil.readableDistance(L.GeoUtil.lineLength(this.map,g)),this.endedPoint=this.map.latLngToContainerPoint(g[g.length-1]);else if("Polygon"===b){for(var m=[],n=0;n<g.length;n++)m.push(g[n]);m.push(g[0]),h=[L.GeoUtil.readableArea(L.GeoUtil.geodesicArea(m)),L.GeoUtil.readableDistance(L.GeoUtil.lineLength(this.map,m))],this.endedPoint=this.map.latLngToContainerPoint(a.featuresLayer._layers[k].getCenter())}this.endedPoint.x=this.endedPoint.x-l[l.length-2],this.endedPoint.y=this.endedPoint.y-l[l.length-1];var o={};for(var p in j.options.labelStyle)o[p]=j.options.labelStyle[p];o.forPolygon=!0,o.notVertex=!0,this.endedPoint.newLabel(h,!0,"endedPoint",k,o),this.map.on("zoomend",e,this),this.map.on("click",f,this),this.on("editable:vertex:dragstart editable:vertex:deleted editable:vertex:dragend",e)},_pointIntersectionMath:function(a,b){for(var c=a[0],d=a[1],e=!1,f=0,g=b.length-1;f<b.length;g=f++){var h=b[f][0],i=b[f][1],j=b[g][0],k=b[g][1],l=i>d!=k>d&&c<(j-h)*(d-i)/(k-i)+h;l&&(e=!e)}return e}}),L.Point.prototype.newLabel=function(a,b,c,d,e){function f(a,b){a.each(function(){for(var a=d3.select(this),c=h.split("/").reverse(),d=!0,e=[],f=0,g=1.1,i=a.attr("x"),j=a.attr("y"),k=0,l=a.text(null).append("tspan").attr("x",i).attr("y",j).attr("dy",k+"em");d;)d=c.pop(),e.push(d),l.text(e.join(" ")),l.node().getComputedTextLength()>b&&(e.pop(),l.text(e.join("/")),e=[d],l=a.append("tspan").attr("x",i).attr("y",j).attr("dy",++f*g+k+"em").text(d))})}var g=this;if((0!==g.x||0!==g.y)&&void 0!==a){a.isArray||(a.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});var h,i,j;a.isArray?(h=" Площадь: "+a[0]+"/Периметр: "+a[1],e&&e.forPolygon&&e.forPolygon===!0&&void 0!==e.notVertex?(i=0,j=0):(i=80,j=30)):(h=a,e&&e.forPolyline&&e.forPolyline===!0?(i=0,j=0):(i=40,j=15));var k=d3.select("svg").append("g").attr("class","leaflet-measure-measurmentLabel"+c);d&&"null"!==d&&k.attr("id","measurmentLabel"+d);var l;b===!0&&(l=k.append("rect"));var m=k.append("text").attr("x",g.x+i).attr("y",g.y-j).attr("class","leaflet-measure-label-text").call(f,180);if(e.text)for(var n in e.text)m.style(n,e.text[n]);var o;if(null!==m.node()){if(o=m.node().getBBox(),b===!0){var p=o.width+12,q=o.height+2;if(l.attr("class","leaflet-measure-label-rectangle").attr("width",p+5).attr("height",q).attr("x",o.x-5).attr("y",o.y-1),e.rec)for(var r in e.rec)l.style(r,e.rec[r])}void 0!==d&&l.attr("id",d);var s=l.node().getBBox(),t=k.append("svg").attr("width","18px").attr("height","18px").attr("viewBox","0 0 26 20").attr("x",s.x+s.width-9).attr("y",s.y-10);t.append("circle").attr("class","leaflet-measure-label-circle").attr("cx",12).attr("cy",12).attr("r",10).style("fill",e.cross.stroke).style("stroke-width",e.cross["stroke-width"]).style("stroke",e.cross.stroke),t.append("path").attr("class","leaflet-measure-label-cross").attr("d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z").style("stroke-width","1px").style("stroke","white").style("fill","white").style("fill-rule","evenodd");this.rectangleRegion=[l,t]}}},L.Point.prototype.removeLabel=function(a){var b=$(".leaflet-measure-measurmentLabel"+a);b&&b.remove()},L.Point.prototype.removeLabelById=function(a){var b=$("#measurmentLabel"+a);b&&b.remove()},L.GeoUtil=L.extend(L.GeoUtil||{},{geodesicArea:function(a){var b,c,d=a.length,e=0,f=Math.PI/180;if(d>2){for(var g=0;g<d;g++)b=a[g],c=a[(g+1)%d],e+=(c.lng-b.lng)*f*(2+Math.sin(b.lat*f)+Math.sin(c.lat*f));e=e*L.Projection.SphericalMercator.R*L.Projection.SphericalMercator.R/2}return Math.abs(e)},readableArea:function(a){var b;return a<1e4?b=L._("{area} м²",{area:a.toFixed(3)}):(a/=1e6,b=L._("{area} км²",{area:a.toFixed(3)})),b},readableDistance:function(a,b){var c;return c=a>1e4?L._("{distance} км",{distance:(a/1e3).toFixed(3)}):L._("{distance} м",{distance:(a/1).toFixed(2)})},lineLength:function(a,b){for(var c,d,e=0,f=0;f<b.length;f++)c=b[f],d&&(e+=a.distance(c,d)),d=c;return e}}),L._=L._||function(a,b){return L.Util.template(a,b)},MapExpress.Layers.GeoJSONServiceLayer=L.GeoJSON.extend({options:{dynamicData:!0,useVectorTile:!1,smoothFactor:2},initialize:function(a,b){L.GeoJSON.prototype.initialize.call(this,null,b),L.setOptions(this,b),this.options.pointToLayer=this._pointToLayer,this.options.onEachFeature=this._eachFeature.bind(this),this._dataPovider=a,this._prevMapView={},this._singleDataLoaded=!1},onAdd:function(a){L.GeoJSON.prototype.onAdd.call(this,a),a.on("moveend",this._updateData,this),this._updateData()},onRemove:function(a){this.clearLayers(),this._removeLabels(),L.GeoJSON.prototype.onRemove.call(this,a),a.off("moveend",this._updateData,this),this._prevMapView={},this._singleDataLoaded=!1},_eachFeature:function(a,b){b.options.smoothFactor&&this.options.smoothFactor&&(b.options.smoothFactor=this.options.smoothFactor)},_pointToLayer:function(a,b){var c=new L.CircleMarker(b,{radius:4,fillColor:"gray",color:"black",weight:1,opacity:.8,fillOpacity:.3});return c},_refreshData:function(){if(this._map)if(MapExpress.Utils.BrowserUtils.detectIE()){var a=this._map.getCenter();this._map.setView(L.latLng([a.lat+1e-5,a.lng+1e-5]),this._map.getZoom())}else this._updateData(!1)},_updateData:function(a){if(this._map){var b=this._map.getBounds(),c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom)return this.clearLayers(),this._removeLabels(),this._singleDataLoaded=!1,void this.fire("mapexspress:layer:data:clear",this);if("undefined"!==a&&a&&this._prevMapView&&this._prevMapView.bounds&&this._prevMapView.bounds.equals(b))return void this._storeMapView();this._removeLabels(),this.options.dynamicData?this.options.useVectorTile?this._updateVectorTileData(b,c):this._updateVectorDataInBounds(b,c):this._singleDataLoaded||(this._singleDataLoaded=!0,this._addVectorData()),this._storeMapView()}},_addVectorData:function(){var a=this;this._dataPovider.getDataAsync().then(function(b){a._replaceData(b),a._singleDataLoaded=!0,a.fire("mapexspress:geojsonlayer:singledata:added",b),a.fire("mapexspress:layer:data:added",b)},function(){a.clearLayers(),a._removeLabels()})},_updateVectorDataInBounds:function(a,b){var c=this;this._dataPovider.getDataInBoundsAsync(a,b).then(function(a){c._replaceData(a),c.fire("mapexspress:geojsonlayer:vectordatainbounds:added",a),c.fire("mapexspress:layer:data:added",a)},function(a){c.clearLayers(),c._removeLabels(),console.log(a)})},_updateVectorTileData:function(a,b){var c=this._dataPovider._getAddedTileCoordRangeByMapBounds(this._prevMapView.bounds,this._prevMapView.zoom,a,b);if(this._map.getZoom()!==this._prevMapView.zoom)this.clearLayers(),this._removeLabels();else for(var d=this._dataPovider._getRemovedTileCoordRangeByMapBounds(this._prevMapView.bounds,this._prevMapView.zoom,a,b),e=0;e<d.length;e++)this._removeVectorTile(d[e]);for(var f=0;f<c.length;f++)this._addVectorTile(c[f])},_addVectorTile:function(a){var b=this;this._dataPovider.getDataByTileAsync(a).then(function(c){if(void 0!==c&&c.features&&c.features.length>0){var d=b.addData(c),e=b._dataPovider._tileCoordsToKey(a);for(var f in d._layers)d._layers[f]._tileCoordKey||(d._layers[f]._tileCoordKey=e);b._updateStyleAndLabels()}})},_removeVectorTile:function(a){var b=this._dataPovider._tileCoordsToKey(a);for(var c in this._layers){var d=this._layers[c];d._tileCoordKey&&d._tileCoordKey===b&&this.removeLayer(d)}},_replaceData:function(a){this.clearLayers(),this._removeLabels(),a&&(this.addData(a),this._updateStyleAndLabels())},_storeMapView:function(){this._prevMapView.zoom=this._map.getZoom(),this._prevMapView.bounds=this._map.getBounds(),this._prevMapView.center=this._map.getCenter()},_updateStyleAndLabels:function(){this.updateStyle(),this._labelLayer()},_getFeaturesAtPoint:function(a,b,c,d,e){var f=this,g=$.Deferred();try{var h=[];for(var i in f._layers){var j=f._layers[i];if(j instanceof L.Marker&&j._latlng)a.distanceTo(j._latlng)<8&&h.push(j.feature);else{var k=j._clickTolerance;k&&(j._clickTolerance=function(){return 8}),j._containsPoint&&j._containsPoint(b)&&h.push(j.feature),k&&(j._clickTolerance=k)}}g.resolve(h)}catch(a){a.layer=f,g.reject(a)}return g.promise()},updateStyle:function(){var a=this,b=!1,c=this._getStyleByZoom();if(c&&this.setStyle&&this.setStyle(c),c||(b=!0),c&&"undefined"===c.overrideStyle&&(b=!0),c&&"undefined"!==c.overrideStyle&&c.overrideStyle===!1&&(b=!0),b)for(var d in a._layers){var e=a._layers[d];if(e.setStyle){var f=a._getStyleByLayerProperties(e);f&&e.setStyle(f)}e instanceof L.Marker&&a._updateMarkerStyle(e,c)}},_updateMarkerStyle:function(a,b){b&&(a instanceof L.Marker&&a.options.icon&&(a.options.icon.options.html=b.markerDivInnerHtml,a.options.icon.options.className=b.markerDivClassName),a.setDivStyle&&a.setDivStyle(b.markerDivStyle))},_getStyleByZoom:function(){if(this._map&&this.styles&&this.styles.length>0){for(var a=this._map.getZoom(),b=!0,c=0;c<this.styles.length;c++){var d=this.styles[c];if(a<=d.maxZoom&&a>=d.minZoom)return d;this.styles[c].minZoom&&this.styles[c].maxZoom&&(b=!1)}if(b)return this.styles[0]}},_getStyleByLayerProperties:function(a){var b=null;if(a&&a.feature&&a.feature.properties&&a.feature.properties.style)if("string"==typeof a.feature.properties.style)try{b=JSON.parse(a.feature.properties.style)}catch(a){return null}else b=a.feature.properties.style;return b},_labelLayer:function(){if(this._removeLabels(),this._map&&this.options.labelEnabled){var a=this._getLabelLayerOptionsByZoom();if(a&&a.length>0){var b=a[0];this.labelOverlay||(this.labelOverlay=new L.LabelOverlay(this,b,!1)),L.Util.setOptions(this.labelOverlay,a[0]),this.labelOverlay._resetLabels()}else this._removeLabels()}else this._removeLabels()},_removeLabels:function(){if(this.labelOverlay){var a=this._leaflet_id;this.labelOverlay._removeLabels(a),delete this.labelOverlay}},_getLabelLayerOptionsByZoom:function(){var a=[];if(this.labels&&this.labels.length>0&&this._map)for(var b=this._map.getZoom(),c=0;c<this.labels.length;c++){var d=this.labels[c];b<=d.maxZoom&&b>=d.minZoom&&a.push(d)}return a}}),MapExpress.Layers.geoJSONServiceLayer=function(a,b){return new MapExpress.Layers.GeoJSONServiceLayer(a,b)},MapExpress.Layers.ImageOverlayLayer=L.ImageOverlay.extend({initialize:function(a,b){if(this._dataPovider=a,L.setOptions(this,b),void 0!==this._dataPovider&&this._dataPovider instanceof MapExpress.Service.SingleImageProvider){var c=this._dataPovider.getDataUrl(),d=this._dataPovider.getImageBounds();L.ImageOverlay.prototype.initialize.call(this,c,d,this.options)}},onAdd:function(a){void 0===this._dataPovider||this._dataPovider instanceof MapExpress.Service.SingleImageProvider||(a.on("moveend",this._reset,this),this._bounds=this._map.getBounds()),L.ImageOverlay.prototype.onAdd.call(this,a)},onRemove:function(a){L.ImageOverlay.prototype.onRemove.call(this,a),a.off("moveend",this._reset,this)},_reset:function(){void 0===this._dataPovider||this._dataPovider instanceof MapExpress.Service.SingleImageProvider||this._updateData(),L.ImageOverlay.prototype._reset.call(this)},_updateData:function(){if(this.setUrl(""),this._map){var a=this._map.getZoom();if(!(a>this.options.maxZoom||a<this.options.minZoom)){this._bounds=this._map.getBounds();var b=this._dataPovider.getDataUrlByBounds(this._bounds,this._map.getSize());this.setUrl(b),this.fire("mapexspress:layer:data:added",b)}}}}),MapExpress.Layers.imageOverlayLayer=function(a,b){return new MapExpress.Layers.ImageOverlayLayer(a,b)},L.LabelOverlay=L.Class.extend({options:{minZoom:5,maxZoom:23,fieldToLabel:"layer.feature.properties.id",textAnchor:"middle",fontSize:"11px",textColor:"#800000",fontFamily:"Arial, Roboto",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",opacity:1,dy:0,dx:0,markerLabelPlace:"right",halo:!0,haloWidth:"2px",haloColor:"white",haloOpacity:.8,typeOfLabel:"pointedAlong",repeat:!0,repeatOffset:300,simpleAlongPointPosition:"50%",rectangle:!1,ellipse:!1,circle:!1,autorecWidthHeight:!0,recWidth:5,recHeight:0,recFill:"#ccc",recFillOpacity:.2,recStroke:"#666",recStrokeWidth:"1px",recStrokeOpacity:.7,labelTemplate:!1},initialize:function(a,b,c){this.labelingLayer=a,L.Util.setOptions(this,b),this.options.maxZoom||(this.options.maxZoom=this.labelingLayer.options.maxZoom),this.options.minZoom||(this.options.minZoom=this.labelingLayer.options.minZoom),void 0!==c&&c===!0&&this.labelingLayer.on("add",this._onParentLayerAddToMap,this),this.labelingLayer.on("remove",this._onParentLayerRemoveFromMap,this),this.options.repeat=!1,this._correctOptions()},_correctOptions:function(){null===this.options.repeatOffset&&(this.options.repeatOffset=500),this.options.repeatOffset<0&&this.options.repeatOffset*-1,this.options.repeatOffset<20&&console.log("Возможно, выставлено слишком маленькое значение и сильно нагружает систему, т.к. значенеия выставлены в пикселах"),null===this.options.simpleAlongPointPosition&&(this.options.simpleAlongPointPosition="50%")},_onParentLayerAddToMap:function(){this.labelingLayer._mapToAdd&&this.labelingLayer._mapToAdd.on("moveend",this._resetLabels,this),this._resetLabels()},_onParentLayerRemoveFromMap:function(){this.labelingLayer._mapToAdd&&this.labelingLayer._mapToAdd.off("moveend",this._resetLabels,this),this._removeLabels()},_resetLabels:function(){var a=this.labelingLayer._leaflet_id;this._removeLabels(a);var b=this.labelingLayer._map.getZoom();b<this.options.minZoom||b>this.options.maxZoom||this.labelingLayer.eachLayer(function(b){if("Point"===b.feature.geometry.type)this._PointLabel(b,a);else if("LineString"===b.feature.geometry.type)this._LineLabel(b,a);else if("Polygon"===b.feature.geometry.type)this._PolygonLabel(b,a);else if("MultiPoint"===b.feature.geometry.type){var c=b.feature;b.eachLayer(function(b){b.feature=c,this._PointLabel(b,a)},this)}else"MultiLineString"===b.feature.geometry.type?this._LineLabel(b,a):"MultiPolygon"===b.feature.geometry.type?this._PolygonLabel(b,a):alert("Некорректные входящие данные!")},this)},_LineLabel:function(layer,nameForGroups){this._correctOptions();var options=this.options;layer._path.id="layer"+layer._leaflet_id;var group=d3.select("svg").append("g").attr("class","Labels"+nameForGroups).append("g").attr("class","lineLabels"),that=this;options.startLineOffset=-4,d3.selectAll("#layer"+layer._leaflet_id).each(function(d,i){var textEval=function(){if(that.options.labelTemplate)string="function"==typeof that.options.labelTemplate?that.options.labelTemplate(options.fieldToLabel):L.Util.template(that.options.labelTemplate,{label:string});else{var string=eval(options.fieldToLabel);void 0!==string&&"undefined"!==string||(string="")}return string};if("simpleAlong"===options.typeOfLabel){options.halo===!0&&that.haloPrototype.call(this,group,options).append("textPath").attr("xlink:href","#layer"+layer._leaflet_id).attr("startOffset",options.simpleAlongPointPosition).text(textEval);var text=that.textPrototype.call(this,group,options).append("textPath").attr("xlink:href","#layer"+layer._leaflet_id).attr("startOffset",options.simpleAlongPointPosition).text(textEval)}else if(options.repeat===!0){if("pointedAlong"===options.typeOfLabel){var lineLengthPointedAlong=d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getTotalLength(),start,end;switch(!0){case lineLengthPointedAlong<20:return;case lineLengthPointedAlong<50&&lineLengthPointedAlong>=20:start=10,end=10;break;case lineLengthPointedAlong<100&&lineLengthPointedAlong>=50:start=20,end=20;break;case lineLengthPointedAlong>=100:start=30,end=30}for(var i=start;i<lineLengthPointedAlong-end;i+=options.repeatOffset){var all=layer._parts,arrayOfPointOfParts=[];all.forEach(function(a,b,c){a.forEach(function(a,b,c){arrayOfPointOfParts.push(a)})});var ax=arrayOfPointOfParts[d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPathSegAtLength(i)].x,ay=arrayOfPointOfParts[d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPathSegAtLength(i)].y,bx=arrayOfPointOfParts[d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPathSegAtLength(i)-1].x,by=arrayOfPointOfParts[d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPathSegAtLength(i)-1].y,BC=ax-bx,AC=ay-by,angle;if(angle=ax<bx&&ay>by?270-180*Math.atan(BC/AC)/Math.PI:ax<bx&&ay<by?90-180*Math.atan(BC/AC)/Math.PI:ax>bx&&ay<by?270-180*Math.atan(BC/AC)/Math.PI:ax>bx&&ay>by?90-180*Math.atan(BC/AC)/Math.PI:0,options.circle===!0)var circle=group.append("circle");if(options.ellipse===!0)var ellipse=group.append("ellipse");if(options.rectangle===!0)var rectangle=group.append("rect");options.halo===!0&&that.haloPrototype.call(this,group,options).attr("x",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).x).attr("y",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).y).attr("transform","rotate("+angle+", "+d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).x+", "+d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).y+")").text(textEval);var text=that.textPrototype.call(this,group,options).attr("x",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).x).attr("y",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).y).attr("transform","rotate("+angle+", "+d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).x+", "+d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).y+")").text(textEval),bbox=text.node().getBBox(),centerX=d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).x,centerY=d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).y;if(options.rectangle===!0){var rectangleWidth,rectangleHeight;options.autorecWidthHeight===!0?(rectangleWidth=bbox.width,rectangleHeight=bbox.height):(rectangleWidth=0,rectangleHeight=0),that.rectangleProtype.call(this,rectangle,options).attr("x",bbox.x-2).attr("y",bbox.y).attr("width",rectangleWidth+options.recWidth).attr("height",rectangleHeight+options.recHeight).attr("transform","rotate("+angle+", "+centerX+", "+centerY+")")}if(options.circle===!0){var circleRad;circleRad=options.autorecWidthHeight===!0?bbox.width:0,that.circlePrototype.call(this,circle,options).attr("cx",bbox.x+bbox.width/2).attr("cy",bbox.y+bbox.height/2).attr("r",circleRad/2+options.recWidth).attr("transform","rotate("+angle+", "+centerX+", "+centerY+")")}if(options.ellipse===!0){var ellipceWidth,ellipceHeight;options.autorecWidthHeight===!0?(ellipceWidth=bbox.width,ellipceHeight=bbox.height):(ellipceWidth=0,ellipceHeight=0),that.ellipsePrototype.call(this,ellipse,options).attr("cx",bbox.x+bbox.width/2).attr("cy",bbox.y+bbox.height/2).attr("rx",ellipceWidth+options.recWidth).attr("ry",ellipceHeight+options.recHeight).attr("transform","rotate("+angle+", "+centerX+", "+centerY+")")}}}else if("pointedAlongGorisontal"===options.typeOfLabel){var lineLengthPointedAlongGorisontal=d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getTotalLength(),start,end;switch(!0){case lineLengthPointedAlongGorisontal<25:return;case lineLengthPointedAlongGorisontal<50&&lineLengthPointedAlongGorisontal>=20:start=10,end=10;break;case lineLengthPointedAlongGorisontal<100&&lineLengthPointedAlongGorisontal>=50:start=20,end=20;break;case lineLengthPointedAlongGorisontal>=100:start=30,end=30}for(var i=start;i<lineLengthPointedAlongGorisontal-end;i+=options.repeatOffset){if(options.circle===!0)var circle=group.append("circle");if(options.ellipse===!0)var ellipse=group.append("ellipse");if(options.rectangle===!0)var rectangle=group.append("rect");options.halo===!0&&that.haloPrototype.call(this,group,options).attr("x",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).x).attr("y",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).y).text(textEval);var text=that.textPrototype.call(this,group,options).attr("x",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).x).attr("y",d3.selectAll("#layer"+layer._leaflet_id)._groups[0][0].getPointAtLength(i).y).text(textEval),bbox=text.node().getBBox();if(options.rectangle===!0){var rectangleWidth,rectangleHeight;options.autorecWidthHeight===!0?(rectangleWidth=bbox.width,rectangleHeight=bbox.height):(rectangleWidth=0,rectangleHeight=0),that.rectangleProtype.call(this,rectangle,options).attr("x",bbox.x-2).attr("y",bbox.y).attr("width",rectangleWidth+options.recWidth).attr("height",rectangleHeight+options.recHeight)}if(options.circle===!0){var circleRad;circleRad=options.autorecWidthHeight===!0?bbox.width:0,that.circlePrototype.call(this,circle,options).attr("cx",bbox.x+bbox.width/2).attr("cy",bbox.y+bbox.height/2).attr("r",circleRad/2+options.recWidth)}if(options.ellipse===!0){var ellipceWidth,ellipceHeight;options.autorecWidthHeight===!0?(ellipceWidth=bbox.width,ellipceHeight=bbox.height):(ellipceWidth=0,ellipceHeight=0),that.ellipsePrototype.call(this,ellipse,options).attr("cx",bbox.x+bbox.width/2).attr("cy",bbox.y+bbox.height/2).attr("rx",ellipceWidth+options.recWidth).attr("ry",ellipceHeight+options.recHeight)}}}}else if(options.repeat!==!0){var allParts=layer._parts,length=0;if(allParts.length>1&&(allParts=[allParts[0]]),allParts.forEach(function(a,b,c){length+=Math.sqrt(Math.pow(a[b+1].y-a[b].y,2)+Math.pow(a[b+1].x-a[b].x,2))}),length<25)return;"pointedAlongGorisontal"===options.typeOfLabel?allParts.forEach(function(a,b,c){function d(){if(options.rectangle===!0){var a,b;options.autorecWidthHeight===!0?(a=l.width,b=l.height):(a=0,b=0),that.rectangleProtype.call(this,j,options).attr("x",l.x-2).attr("y",l.y).attr("width",a+options.recWidth).attr("height",b+options.recHeight)}if(options.circle===!0){var c;c=options.autorecWidthHeight===!0?l.width:0,that.circlePrototype.call(this,h,options).attr("cx",l.x+l.width/2).attr("cy",l.y+l.height/2).attr("r",c/2+options.recWidth)}if(options.ellipse===!0){var d,e;options.autorecWidthHeight===!0?(d=l.width,e=l.height):(d=0,e=0),that.ellipsePrototype.call(this,i,options).attr("cx",l.x+l.width/2).attr("cy",l.y+l.height/2).attr("rx",d+options.recWidth).attr("ry",e+options.recHeight)}}if(a.length>2){var e=Math.floor(a.length/2),f=(a[e].x+a[e+1].x)/2,g=(a[e].y+a[e+1].y)/2;if(options.circle===!0)var h=group.append("circle");if(options.ellipse===!0)var i=group.append("ellipse");if(options.rectangle===!0)var j=group.append("rect");options.halo===!0&&that.haloPrototype.call(this,group,options).attr("x",f).attr("y",g).text(textEval);var k=that.textPrototype.call(this,group,options).attr("x",f).attr("y",g).text(textEval),l=k.node().getBBox();d()}else{var f=(a[0].x+a[1].x)/2,g=(a[0].y+a[1].y)/2;if(options.circle===!0)var h=group.append("circle");if(options.ellipse===!0)var i=group.append("ellipse");if(options.rectangle===!0)var j=group.append("rect");options.halo===!0&&that.haloPrototype.call(this,group,options).attr("x",f).attr("y",g).text(textEval);var k=that.textPrototype.call(this,group,options).attr("x",f).attr("y",g).attr("fill-opacity",options.opacity).text(textEval),l=k.node().getBBox();d()}}):"pointedAlong"===options.typeOfLabel&&allParts.forEach(function(a,b,c){function d(){if(options.rectangle===!0){var a,b;options.autorecWidthHeight===!0?(a=o.width,b=o.height):(a=0,b=0),that.rectangleProtype.call(this,m,options).attr("x",o.x-3).attr("y",o.y).attr("width",a+options.recWidth).attr("height",b+options.recHeight).attr("transform","rotate("+e+", "+g+", "+h+")")}if(options.circle===!0){var c;c=options.autorecWidthHeight===!0?o.width:0,that.circlePrototype.call(this,k,options).attr("cx",o.x+o.width/2).attr("cy",o.y+o.height/2).attr("r",c/2+options.recWidth).attr("transform","rotate("+e+", "+g+", "+h+")")}if(options.ellipse===!0){var d,f;options.autorecWidthHeight===!0?(d=o.width,f=o.height):(d=0,f=0),that.ellipsePrototype.call(this,l,options).attr("cx",o.x+o.width/2).attr("cy",o.y+o.height/2).attr("rx",d+options.recWidth).attr("ry",f+options.recHeight).attr("transform","rotate("+e+", "+g+", "+h+")")}}if(a.length>2){var e,f=Math.floor(a.length/2),g=(a[f].x+a[f+1].x)/2,h=(a[f].y+a[f+1].y)/2,i=a[f].x-a[f+1].x,j=a[f].y-a[f+1].y;if(e=a[f].x<a[f+1].x&&a[f].y>a[f+1].y?270-180*Math.atan(i/j)/Math.PI:a[f].x<a[f+1].x&&a[f].y<a[f+1].y?90-180*Math.atan(i/j)/Math.PI:a[f].x>a[f+1].x&&a[f].y<a[f+1].y?270-180*Math.atan(i/j)/Math.PI:a[f].x>a[f+1].x&&a[f].y>a[f+1].y?90-180*Math.atan(i/j)/Math.PI:0,options.circle===!0)var k=group.append("circle");if(options.ellipse===!0)var l=group.append("ellipse");if(options.rectangle===!0)var m=group.append("rect");options.halo===!0&&that.haloPrototype.call(this,group,options).attr("x",g).attr("y",h).attr("transform","rotate("+e+", "+g+", "+h+")").text(textEval);var n=that.textPrototype.call(this,group,options).attr("x",g).attr("y",h).attr("transform","rotate("+e+", "+g+", "+h+")").text(textEval),o=n.node().getBBox();d()}else{var e,g=(a[0].x+a[1].x)/2,h=(a[0].y+a[1].y)/2,i=a[0].x-a[1].x,j=a[0].y-a[1].y;if(e=a[0].x<a[1].x&&a[0].y>a[1].y?270-180*Math.atan(i/j)/Math.PI:a[0].x<a[1].x&&a[0].y<a[1].y?90-180*Math.atan(i/j)/Math.PI:a[0].x>a[1].x&&a[0].y<a[1].y?270-180*Math.atan(i/j)/Math.PI:a[0].x>a[1].x&&a[0].y>a[1].y?90-180*Math.atan(i/j)/Math.PI:0,options.circle===!0)var k=group.append("circle");if(options.ellipse===!0)var l=group.append("ellipse");if(options.rectangle===!0)var m=group.append("rect");options.halo===!0&&that.haloPrototype.call(this,group,options).attr("x",g).attr("y",h).attr("transform","rotate("+e+", "+g+", "+h+")").text(textEval);var n=that.textPrototype.call(this,group,options).attr("x",g).attr("y",h).attr("transform","rotate("+e+", "+g+", "+h+")").text(textEval),o=n.node().getBBox();d()}})}})},_PolygonLabel:function(layer,nameForGroups){var options=this.options;layer._path.id="layer"+layer._leaflet_id;var group=d3.select("svg").append("g").attr("class","Labels"+nameForGroups).append("g").attr("class","polygonLabels"),that=this;d3.selectAll("#layer"+layer._leaflet_id).each(function(d,i){var textEval=function(){if(that.options.labelTemplate)string="function"==typeof that.options.labelTemplate?that.options.labelTemplate(options.fieldToLabel):L.Util.template(that.options.labelTemplate,{label:string});else{var string=eval(options.fieldToLabel);void 0!==string&&"undefined"!==string||(string="")}return string},bounds=this.getBBox(),labelPositions={x:bounds.x+bounds.width/2,y:bounds.y+bounds.height/2};if(0!==labelPositions.x||0!==labelPositions.y){if(options.circle===!0)var circle=group.append("circle");if(options.ellipse===!0)var ellipse=group.append("ellipse");if(options.rectangle===!0)var rectangle=group.append("rect");options.halo===!0&&that.haloPrototype.call(this,group,options).attr("x",labelPositions.x).attr("y",labelPositions.y).text(textEval);var text=that.textPrototype.call(this,group,options).attr("x",labelPositions.x).attr("y",labelPositions.y).text(textEval),bbox=text.node().getBBox();if(options.rectangle===!0){var rectangleWidth,rectangleHeight;options.autorecWidthHeight===!0?(rectangleWidth=bbox.width,rectangleHeight=bbox.height):(rectangleWidth=0,rectangleHeight=0),that.rectangleProtype.call(this,rectangle,options).attr("x",bbox.x).attr("y",bbox.y).attr("width",rectangleWidth+options.recWidth).attr("height",rectangleHeight+options.recHeight)}if(options.circle===!0){var circleRad;circleRad=options.autorecWidthHeight===!0?bbox.width:0,that.circlePrototype.call(this,circle,options).attr("cx",bbox.x+bbox.width/2).attr("cy",bbox.y+bbox.height/2).attr("r",circleRad/2+options.recWidth)}if(options.ellipse===!0){var ellipceWidth,ellipceHeight;options.autorecWidthHeight===!0?(ellipceWidth=bbox.width,ellipceHeight=bbox.height):(ellipceWidth=0,ellipceHeight=0),that.ellipsePrototype.call(this,ellipse,options).attr("cx",bbox.x+bbox.width/2).attr("cy",bbox.y+bbox.height/2).attr("rx",ellipceWidth+options.recWidth).attr("ry",ellipceHeight+options.recHeight);
}}})},_PointLabel:function(layer,nameForGroups){var options=this.options,icon=!0,imageWigth,imageHeight,iconX,iconY;if(void 0!==layer._icon?layer._icon.id="marker_"+layer._leaflet_id:(layer._path.id="marker_"+layer._leaflet_id,icon=!1),null!==d3.select("svg")._groups[0][0])var group=d3.select("svg").append("g").attr("class","Labels"+nameForGroups).append("g").attr("class","pointLabels");else var polygon=L.polygon([[0,-.1],[-.1,-.02],[-.02,0]],{color:"red",opacity:0,fillColor:"#f03",fillOpacity:0}).addTo(this.labelingLayer._map),group=d3.select("svg").append("g").attr("class","Labels"+nameForGroups).append("g").attr("class","pointLabels");var that=this;d3.selectAll("#marker_"+layer._leaflet_id).each(function(){var textEval=function(){if(that.options.labelTemplate)string="function"==typeof that.options.labelTemplate?that.options.labelTemplate(options.fieldToLabel):L.Util.template(that.options.labelTemplate,{label:string});else{var string=eval(options.fieldToLabel);void 0!==string&&"undefined"!==string||(string="")}return string};if(icon===!0)iconX=layer._icon._leaflet_pos.x,iconY=layer._icon._leaflet_pos.y;else{var bounds=this.getBBox();if(iconX=bounds.x+bounds.width/2,iconY=bounds.y+bounds.height/2,0===iconX&&0===iconY)return}if(options.circle===!0)var circle=group.append("circle");if(options.ellipse===!0)var ellipse=group.append("ellipse");if(options.rectangle===!0)var rectangle=group.append("rect");icon===!0?(imageWigth=parseInt(this.style.width,10),imageHeight=parseInt(this.style.height,10)):imageWigth=imageHeight=layer._radius;var labelPositions={};if(options.halo===!0)var halo=that.haloPrototype.call(this,group,options).text(textEval);var text=that.textPrototype.call(this,group,options).text(textEval),bbox=text.node().getBBox();if("top"===options.markerLabelPlace?(labelPositions.x=iconX,labelPositions.y=iconY-imageHeight/2):"bottom"===options.markerLabelPlace?(labelPositions.x=iconX,labelPositions.y=iconY+imageHeight/2+bbox.height):"left"===options.markerLabelPlace?(labelPositions.x=iconX-bbox.width/2-3-imageWigth/2,labelPositions.y=iconY+bbox.height/4):"right"===options.markerLabelPlace&&(labelPositions.x=iconX+bbox.width/2+3+imageWigth/2,labelPositions.y=iconY+bbox.height/4),0!==labelPositions.x||0!==labelPositions.y){options.halo===!0&&halo.attr("x",labelPositions.x).attr("y",labelPositions.y),text.attr("x",labelPositions.x).attr("y",labelPositions.y);var newBbox=text.node().getBBox();if(options.rectangle===!0){var rectangleWidth,rectangleHeight;options.autorecWidthHeight===!0?(rectangleWidth=newBbox.width,rectangleHeight=newBbox.height):(rectangleWidth=0,rectangleHeight=0),that.rectangleProtype.call(this,rectangle,options).attr("x",newBbox.x).attr("y",newBbox.y).attr("width",rectangleWidth+options.recWidth).attr("height",rectangleHeight+options.recHeight)}if(options.circle===!0){var circleRad;circleRad=options.autorecWidthHeight===!0?newBbox.width:0,that.circlePrototype.call(this,circle,options).attr("cx",newBbox.x+newBbox.width/2).attr("cy",newBbox.y+newBbox.height/2).attr("r",circleRad/2+options.recWidth)}if(options.ellipse===!0){var ellipceWidth,ellipceHeight;options.autorecWidthHeight===!0?(ellipceWidth=newBbox.width,ellipceHeight=newBbox.height):(ellipceWidth=0,ellipceHeight=0),that.ellipsePrototype.call(this,ellipse,options).attr("cx",newBbox.x+newBbox.width/2).attr("cy",newBbox.y+newBbox.height/2).attr("rx",ellipceWidth+options.recWidth).attr("ry",ellipceHeight+options.recHeight)}}})},haloPrototype:function(a,b){var c;c=b.startLineOffset&&void 0!==b.startLineOffset?b.startLineOffset:0;var d=a.append("text").attr("class","halo").attr("dx",b.dx).attr("dy",b.dy+c).style("stroke",b.haloColor).style("opacity",b.haloOpacity).style("stroke-width",b.haloWidth).style("text-anchor",b.textAnchor).style("font-size",b.fontSize).style("font-weight",b.fontWeight).style("font-style",b.fontStyle).style("text-decoration",b.textDecoration).style("font-family",b.fontFamily);return d},textPrototype:function(a,b){var c;c=b.startLineOffset&&void 0!==b.startLineOffset?b.startLineOffset:0;var d=a.append("text").attr("class","textpath").attr("dx",b.dx).attr("dy",b.dy+c).style("fill-opacity",b.opacity).style("text-anchor",b.textAnchor).style("font-size",b.fontSize).style("font-weight",b.fontWeight).style("font-style",b.fontStyle).style("text-decoration",b.textDecoration).style("fill",b.textColor).style("font-family",b.fontFamily);return d},circlePrototype:function(a,b){return a.style("fill",b.recFill).style("fill-opacity",b.recFillOpacity).style("stroke",b.recStroke).style("stroke-width",b.recStrokeWidth).style("stroke-opacity",b.recStrokeOpacity),a},ellipsePrototype:function(a,b){return a.style("fill",b.recFill).style("fill-opacity",b.recFillOpacity).style("stroke",b.recStroke).style("stroke-width",b.recStrokeWidth).style("stroke-opacity",b.recStrokeOpacity),a},rectangleProtype:function(a,b){return a.style("fill",b.recFill).style("fill-opacity",b.recFillOpacity).style("stroke",b.recStroke).style("stroke-width",b.recStrokeWidth).style("stroke-opacity",b.recStrokeOpacity),a},_removeLabels:function(a){var b=$(".Labels"+a);b&&b.remove()}}),MapExpress.Layers.TileServiceLayer=L.TileLayer.extend({initialize:function(a,b){L.TileLayer.prototype.initialize.call(this,null,b),b.pane="tilePane",b.minNativeZoom=void 0,b.maxNativeZoom=void 0,b.zoomOffset=0,b.updateWhenIdle=L.Browser.mobile,b.updateWhenZooming=!0,b.updateInterval=200,b.keepBuffer=2,L.setOptions(this,b),this._dataPovider=a},createTile:function(a,b){var c=document.createElement("img");return L.DomEvent.on(c,"load",L.bind(this._tileOnLoad,this,b,c)),L.DomEvent.on(c,"error",L.bind(this._tileOnError,this,b,c)),this.options.crossOrigin&&(c.crossOrigin=""),c.alt="",c.setAttribute("role","presentation"),c.src=this._dataPovider.getDataUrlByTile(a),c}}),MapExpress.Layers.tileServiceLayer=function(a,b){return new MapExpress.Layers.TileServiceLayer(a,b)},MapExpress.Mapping.LayerModel=L.Evented.extend({initialize:function(a,b){this.id=a,this._layers=[],L.setOptions(this,b),null!==this.id&&"undefined"!==this.id||(this.id=L.Util.stamp(this).toString())},addLayer:function(a){this._layers.push(a)},removeLayerById:function(a){var b=this.getLayerById(a);if(b){var c=this._findIndex(this._layers,function(b){return b.id===a});this._layers.splice(c,1)}},getLayerById:function(a){function b(a,b){return a.filter(function(a){return a.id===b})}var c=this.getAllLayers();if(c){var d=b(c,a);return d.length>0?d[0]:null}},getAllLayers:function(){return this._layers},hasChildren:function(){return this._layers&&this._layers.length>0},_arraymove:function(a,b,c){var d=a[b];a.splice(b,1),a.splice(c,0,d)},layerModelToJSON:function(){var a={};if(a.id=this.id,a.options=this.options,a.layers=[],this._layers.length>0){a.layerClass=null,a.dataProviderClass=null;for(var b=0;b<this._layers.length;b++)a.layers.push(this._layers[b].layerModelToJSON())}else a.dataProviderClass={},a.dataProviderClass.constructor=this.getProviderClassName(this),a.dataProviderClass.args=this.mapLayer._dataPovider._dataUrl,a.dataProviderClass.options=this.mapLayer._dataPovider.options,a.layerClass={},a.layerClass.constructor=this.getLayerClassName(this),a.layerClass.options=this.mapLayer.options,a.layerClass.styles=this.mapLayer.styles,a.layerClass.labels=this.mapLayer.labels;return a},getProviderClassName:function(a){function b(a,b){return a.p instanceof b.p?-1:b.p instanceof a.p?1:0}var c=null,d=MapExpress.Service;if(void 0===a.mapLayer)return c;var e=(a.mapLayer._dataPovider,[]);for(var f in d)a.mapLayer._dataPovider instanceof d[f]&&e.push({a:f,p:d[f]});var g=e.sort(b);return g.length>0&&(c="MapExpress.Service."+g[g.length-1].a),c},getLayerClassName:function(a){var b=MapExpress.Layers,c=null;if(void 0===a.mapLayer)return c;a.mapLayer;for(var d in b)a.mapLayer instanceof b[d]&&(c="MapExpress.Layers."+d);return c},_findIndex:function(a,b){var c,d;for(c in a)if(d=a[c],b(d))return parseInt(c);return-1}}),MapExpress.Mapping.MapInitializerHelper={initializeFromURL:function(a,b,c,d){this._initialize(MapExpress.Mapping.MapWorkspaseLoader.getMapWorkspaceFromURLAsync(b),a,c,d)},initializeFromFile:function(a,b,c,d){this._initialize(MapExpress.Mapping.MapWorkspaseLoader.getMapWorkspaceFromFileAsync(b),a,c,d)},_initialize:function(a,b,c,d){var e=L.map(b,{zoomControl:!1,editable:!0,attributionControl:!1});window.MapManager=new MapExpress.Mapping.MapManager(e),a.then(function(a){window.MapManager.renderMap(a),c&&"function"==typeof c&&c(e)},function(a){d&&"function"==typeof d?d(a):new MapExpress.Controls.MapControl(window.MapManager._map).showErrorWindow("Не удалось загрузить рабочий набор карты")})}},MapExpress.Mapping.MapManager=L.Evented.extend({initialize:function(a,b,c){this._map=a,L.setOptions(this,c),this._mapModelBuilder=b?b:new MapExpress.Mapping.MapModelBuilder(a,c),this.selections=[]},renderMap:function(a){this._mapModel=this._mapModelBuilder.createMapModel(a),L.setOptions(this._map,this._mapModel.options),this._map.setView(this._mapModel.options.center,this._mapModel.options.zoom);var b=this._mapModel.getBaseLayers();this._mapModel.sortLayersByVisibleIndex(b),this._mapModel._reorderLayersVisibleIndex(b);for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.mapLayer.options.visible){d.mapLayer.addTo(this._map);break}}var e=this._mapModel.getOverlayLayers();this._mapModel.sortLayersByVisibleIndex(e),this._mapModel._reorderLayersVisibleIndex(e),this._mapModel.sortLayersByVisibleIndex(e);for(var f=e.length-1;f>=0;f--){var g=e[f];g.mapLayer&&g.mapLayer.options.visible&&(g.mapLayer.on("mapexspress:layer:data:added",this._reorderOverlays,this),g.mapLayer.addTo(this._map))}return this._map},setActiveBaseMap:function(a){var b=this._mapModel.getLayerById(a);if(b&&b.mapLayer){for(var c=this._mapModel.getBaseLayers(),d=c.length-1;d>=0;d--){var e=c[d];e.mapLayer&&(e.mapLayer.options.visible=!1,this._map.removeLayer(e.mapLayer))}b.mapLayer.options.visible=!0,b.mapLayer.addTo(this._map),b.mapLayer.bringToBack()}},getActiveBaseMap:function(){for(var a,b=window.MapManager.getMapModel().getBaseLayers(),c=0;c<b.length;c++)b[c].mapLayer&&b[c].mapLayer.options.visible===!0&&(a=b[c]);return a},removeLayerById:function(a){var b=this._mapModel.getLayerById(a);b&&b.mapLayer&&(b.mapLayer.off("mapexspress:layer:data:added",this._reorderOverlays,this),this._map.removeLayer(b.mapLayer)),this._mapModel.removeLayerById(a)},setLayerVisible:function(a,b){var c=this._mapModel.getLayerById(a);if(c&&c.mapLayer&&(b?(c.mapLayer.on("mapexspress:layer:data:added",this._reorderOverlays,this),this._map.addLayer(c.mapLayer)):(c.mapLayer.off("mapexspress:layer:data:added",this._reorderOverlays,this),this._map.removeLayer(c.mapLayer)),c.mapLayer.options.visible=b,c.fire("mapexspress:layermodel:visiblechanged",c)),c&&(c.visibleForFavorites=b),c&&c.hasChildren())for(var d=c._layers.length-1;d>=0;d--){var e=c._layers[d];this.setLayerVisible(e.id,b)}var f={};f.layerId=a,f.layerModel=c,f.visible=b,this.fire("mapexspress:mapmanager:layer:visiblechanged",f)},toogleLayerVisible:function(a){var b=this._mapModel.getLayerById(a);b&&b.mapLayer&&("base"===b.options.type?this.setActiveBaseMap(a):this.setLayerVisible(a,!b.mapLayer.options.visible))},moveOverlay:function(a,b){var c=this._mapModel.getLayerById(a);c&&c.mapLayer&&(this._mapModel.setLayerVisibleIndex(a,b),this._reorderOverlays())},toogleLabelLayer:function(a){if(this.layerLabelingEnabledInZoom(a)){var b=this._mapModel.getLayerById(a);b.mapLayer&&(b.mapLayer.options.labelEnabled=!b.mapLayer.options.labelEnabled,b.mapLayer._labelLayer())}},layerEnabled:function(a){var b=this._mapModel.getLayerById(a);return!!(b&&b.mapLayer&&b.mapLayer.options&&b.mapLayer.options.visible&&this.layerVisibleEnableInZoom(a))},layerVisibleEnableInZoom:function(a){var b=this._mapModel.getLayerById(a);if(b&&b.mapLayer&&b.mapLayer.options){var c=this._map.getZoom();if(c<=b.mapLayer.options.maxZoom&&c>=b.mapLayer.options.minZoom)return!0}return!1},layerLabelingEnabledInZoom:function(a){var b=this._mapModel.getLayerById(a);if(b&&b.mapLayer&&b.mapLayer.options){var c=b.mapLayer instanceof MapExpress.Layers.GeoJSONServiceLayer;if(c){var d=b.mapLayer._getLabelLayerOptionsByZoom();return d&&d.length>0}}return!1},_reorderOverlays:function(){var a=this._mapModel.getOverlayLayers();this._mapModel.sortLayersByVisibleIndex(a),this._mapModel._reorderLayersVisibleIndex(a),this._mapModel.sortLayersByVisibleIndex(a);for(var b=a.length-1;b>=0;b--){var c=a[b];if(c&&c.mapLayer&&c.mapLayer._map)try{c.mapLayer.bringToFront()}catch(a){}}this.fire("mapexspress:mapmanager:layer:overlaysreordered",this)},getMapModel:function(){return this._mapModel},getSelection:function(a,b){var c=this._findIndex(this.selections,function(b){return b._layerId===a});if(c>-1)return this.selections[c];var d=new MapExpress.Mapping.Selection(a,b);return this.selections.push(d),d},clearSelections:function(){if(this.selections){for(var a=this.selections.length-1;a>=0;a--)this.selections[a].destroySelection();this.selections.length=0}},addPulseMarker:function(a,b,c){return this.removePulseMarker(),c||(c={iconSize:[12,12],color:"blue"}),this.pulseMarker=new MapExpress.Styles.PulseMarker(a,c),this._map.addLayer(this.pulseMarker),b>0&&window.setTimeout(this.removePulseMarker.bind(this),b),this.pulseMarker},removePulseMarker:function(){this.pulseMarker&&(this._map.removeLayer(this.pulseMarker),delete this.pulseMarker)},_findIndex:function(a,b){var c,d;for(c in a)if(d=a[c],b(d))return parseInt(c);return-1},mapModelToJSON:function(){return JSON.stringify(this.getMapModel().mapModelToJSON())},rememberMapStateInSessionStorageBeforeLeave:function(){function a(){window.sessionStorage.setItem("MAPEXPRESS_MAP_STATE_ZOOM",b._map.getZoom()),window.sessionStorage.setItem("MAPEXPRESS_MAP_STATE_COORDINATES_LAT",b._map.getCenter().lat),window.sessionStorage.setItem("MAPEXPRESS_MAP_STATE_COORDINATES_LNG",b._map.getCenter().lng),window.sessionStorage.setItem("MAPEXPRESS_MAP_STATE_ACTIVE_BASEMAP",window.MapManager.getActiveBaseMap().id);var a=window.MapManager.getMapModel().getVisibleLayers(),c=[];if(a.length>0)for(var d=0;d<a.length;d++)a[d].id!==window.MapManager.getActiveBaseMap().id&&c.push(a[d].id);window.sessionStorage.setItem("MAPEXPRESS_MAP_STATE_VISIBLE_LAYERS",c.toString())}if(!window.sessionStorage)return void console.warn('Устаревший браузер. Нет поддержки "sessionStorage"');var b=this;window.addEventListener("beforeunload",function(b){return a(),null})},recallMapStateFromSessionStorage:function(){if(!window.sessionStorage)return void console.warn('Устаревший браузер. Нет поддержки "sessionStorage"');var a,b,c,d=this,e=window.sessionStorage.getItem("MAPEXPRESS_MAP_STATE_ZOOM"),f=window.sessionStorage.getItem("MAPEXPRESS_MAP_STATE_COORDINATES_LAT"),g=window.sessionStorage.getItem("MAPEXPRESS_MAP_STATE_COORDINATES_LNG");null!==e&&void 0!==e&&(a=Number(e)),null!==f&&void 0!==f&&null!==g&&void 0!==g&&(b=Number(f),c=Number(g)),void 0!==a&&void 0!==b&&void 0!==c?d._map.setView([b,c],a):d._map.setView([window.MapManager.getMapModel().options.center[0],window.MapManager.getMapModel().options.center[1]],window.MapManager.getMapModel().options.zoom);var h=window.sessionStorage.getItem("MAPEXPRESS_MAP_STATE_ACTIVE_BASEMAP");null!==h&&void 0!==h&&window.MapManager.setActiveBaseMap(h);var i=window.sessionStorage.getItem("MAPEXPRESS_MAP_STATE_VISIBLE_LAYERS");if(null!==i&&void 0!==i)for(var j=i.split(","),k=0;k<j.length;k++)window.MapManager.setLayerVisible(j[k],!0)},setFeaturePositionAndSelect:function(a,b,c,d){this.setFeaturePosition(a,b,c,d,!0)},setFeaturePosition:function(a,b,c,d,e){function f(){h(),window.MapManager.setLayerVisible(b.id,!0),e?b.once("mapexspress:layer:data:added",g):i()}function g(){i();var a=new MapExpress.Mapping.Selection.SingleUseSelection(b.id);a.options.featureKeyFieldName=c,a.addSelectionByFeaturePropertyValue(c,d)}function h(){window.MapManager._map.fitBounds(l.getBounds()),window.MapManager._map.getZoom()>19&&window.MapManager._map.setZoom(19)}function i(){l&&(window.MapManager.getMapModel().removeLayerById(l.id),l._map&&window.MapManager._map.removeLayer(l)),l=!1}window.MapManager.clearSelections(),i();try{var j=b.id+c+d,k=new MapExpress.Service.GeoJSONProvider(a),l=new MapExpress.Layers.GeoJSONServiceLayer(k,{stroke:!1,fillOpacity:0,opacity:0});l.options.dynamicData=!1,l.id=j;var m=new MapExpress.Mapping.LayerModel(j);m.mapLayer=l,m.options.showOnTOC=!1,window.MapManager.getMapModel().addLayer(m),window.MapManager.setLayerVisible(j,!0),l.once("mapexspress:geojsonlayer:singledata:added",f)}catch(a){i()}}}),MapExpress.Mapping.MapModel=MapExpress.Mapping.LayerModel.extend({initialize:function(a,b){this.id=a,this._layers=[],this._favoriteLayers=[],L.setOptions(this,b)},getAllLayers:function(){var a=[];return this._fillAllLayers(this,a),a},getBaseLayers:function(){return this.getLayersByType("base")},getOverlayLayers:function(){return this.getLayersByType("overlay")},getLayersByType:function(a){return this.getLayersByOptionValue("type",a)},getVisibleLayers:function(){return this.getMapLayersByOptionValue("visible",!0)},getQueryableLayers:function(){return this.getMapLayersByOptionValue("queryable",!0)},getSelectableLayers:function(){return this.getMapLayersByOptionValue("selectable",!0)},getLayersByOptionValue:function(a,b){var c=this.getAllLayers(),d=c.filter(function(c){if(c.options.hasOwnProperty(a))return c.options[a]===b});return d},getFirstLayerByOptionValue:function(a,b){var c=this.getLayersByOptionValue(a,b);return!!(c&&c.length>0)&&c[0]},getFavoriteLayers:function(){return this._favoriteLayers},getMapLayersByOptionValue:function(a,b){var c=this.getAllLayers(),d=c.filter(function(c){if(c.mapLayer&&c.mapLayer.options&&c.mapLayer.options.hasOwnProperty(a))return"undefined"!==c.mapLayer.options[a]&&c.mapLayer.options[a]===b});return d},mapModelToJSON:function(){var a={};a.id=this.id,a.options=this.options,a.layers=[];for(var b=0;b<this._layers.length;b++)a.layers.push(this._layers[b].layerModelToJSON());return a},_fillAllLayers:function(a,b){for(var c=a._layers.length-1;c>=0;c--){var d=a._layers[c];b.push(d),d.hasChildren()&&this._fillAllLayers(d,b)}},setLayerVisibleIndex:function(a,b){var c=this.getLayerById(a);if(c){c.mapLayer.options.visibleIndex=b;var d=this.getOverlayLayers();this.sortLayersByVisibleIndex(d);var e=this._findIndex(d,function(b){return b.id===a});this._arraymove(d,e,b),this.sortLayersByVisibleIndex(d),this._reorderLayersVisibleIndex(d)}},sortLayersByVisibleIndex:function(a){function b(a,b){try{return a.mapLayer&&b.mapLayer?a.mapLayer.options.visibleIndex-b.mapLayer.options.visibleIndex:-1}catch(c){console.log(a),console.log(b)}}a.sort(b)},_reorderLayersVisibleIndex:function(a){for(var b=a.length-1;b>=0;b--){var c=a[b];c.mapLayer&&(c.mapLayer.options.visibleIndex=b)}return a}}),MapExpress.Mapping.MapModelBuilder=L.Class.extend({initialize:function(a,b){this._map=a,L.setOptions(this,b)},createMapModel:function(a){var b=new MapExpress.Mapping.MapModel(a.id,a.options);if(this._jsonMapModel=a,a.layers&&a.layers.length>0)for(var c=0;c<a.layers.length;c++){var d=a.layers[c];this._processLayerModel(d,b)}return b},_processLayerModel:function(a,b){var c=new MapExpress.Mapping.LayerModel(a.id,a.options);if(c.mapLayer=this._createLayerClass(a),b.addLayer(c),a.layers&&a.layers.length>0)for(var d=0;d<a.layers.length;d++){var e=a.layers[d];this._processLayerModel(e,c)}},_createLayerClass:function(a){var b;if(a.dataProviderClass&&a.layerClass){var c=this._createProvider(a.dataProviderClass.constructor,a.dataProviderClass.args,a.dataProviderClass.options);if(c){switch(a.layerClass.args||(a.layerClass.args=[]),a.layerClass.args.splice(0,0,c),a.layerClass.constructor){case"MapExpress.Layers.GeoJSONServiceLayer":b=this._applyToConstructor(MapExpress.Layers.GeoJSONServiceLayer,a.layerClass.args,a.layerClass.options);break;case"MapExpress.Layers.ImageOverlayLayer":b=this._applyToConstructor(MapExpress.Layers.ImageOverlayLayer,a.layerClass.args,a.layerClass.options);break;case"MapExpress.Layers.TileServiceLayer":b=this._applyToConstructor(MapExpress.Layers.TileServiceLayer,a.layerClass.args,a.layerClass.options)}b&&(b.id=a.id,b.styles=a.layerClass.styles,b.labels=a.layerClass.labels)}}return b},_createProvider:function(a,b,c){var d;switch(a){case"MapExpress.Service.TileProvider":d=this._applyToConstructor(MapExpress.Service.TileProvider,b,c);break;case"MapExpress.Service.GeoJSONProvider":d=this._applyToConstructor(MapExpress.Service.GeoJSONProvider,b,c);break;case"MapExpress.Service.MapServiceAgsProvider":d=this._applyToConstructor(MapExpress.Service.MapServiceAgsProvider,b,c);break;case"MapExpress.Service.FeatureServiceAgsProvider":d=this._applyToConstructor(MapExpress.Service.FeatureServiceAgsProvider,b,c);break;case"MapExpress.Service.WmsProvider":d=this._applyToConstructor(MapExpress.Service.WmsProvider,b,c);break;case"MapExpress.Service.SingleImageProvider":d=this._applyToConstructor(MapExpress.Service.SingleImageProvider,b,c);break;case"MapExpress.Service.WFSProvider":d=this._applyToConstructor(MapExpress.Service.WFSProvider,b,c)}return d},_applyToConstructor:function(a,b,c){var d=[null].concat(b,c),e=a.bind.apply(a,d);return new e}}),MapExpress.Mapping.Selection=L.Class.extend({options:{featureKeyFieldName:"id",selectionStyle:{weight:2,color:"red",fillColor:"red",radius:5,fillOpacity:.3},singleSelect:!1},initialize:function(a,b){this._layerId=a,this._selection=[],L.setOptions(this,b),this._layerModel=window.MapManager._mapModel.getLayerById(this._layerId),this._subscribeLayerEvents(!0),this._restoreSelection()},getSelections:function(){return this._selection},addSelection:function(a,b){a&&(this._layerModel.fire("mapexpress:selection:before:selected",this),b?this._layerModel.fire("mapexpress:selection:manual:before:selected",this):this._layerModel.fire("mapexpress:selection:map:before:selected",this),this.options.singleSelect&&this.clearSelection(),a.oldStyle=$.extend({},a.options),a.setStyle(this.options.selectionStyle),this.isLayerSelected(a)||(this._selection.push(a),this._layerModel.fire("mapexpress:selection:after:selected",a),b?this._layerModel.fire("mapexpress:selection:manual:after:selected",a):this._layerModel.fire("mapexpress:selection:map:after:selected",a)))},addSelectionByFeaturePropertyValue:function(a,b){var c=MapExpress.Utils.GeoJSONUtils.getLayerByPropertyValueFromLayerGroup(this._layerModel.mapLayer,a,b);c&&this.addSelection(c)},invertSelection:function(a){a&&(this.isLayerSelected(a)?this.removeSelection(a,!0):this.addSelection(a,!0))},removeSelection:function(a,b){if(a){this._layerModel.fire("mapexpress:selection:before:deselected",this),b?this._layerModel.fire("mapexpress:selection:manual:before:deselected",this):this._layerModel.fire("mapexpress:selection:map:before:deselected",this);var c=this._getLayerIndex(a);c>-1&&(this._resetLayerStyle(a),this._selection.splice(c,1),this._layerModel.fire("mapexpress:selection:after:deselected",a),b?this._layerModel.fire("mapexpress:selection:manual:after:deselected",a):this._layerModel.fire("mapexpress:selection:map:after:deselected",a))}},clearSelection:function(){for(var a=this._selection.length-1;a>=0;a--)this.removeSelection(this._selection[a],!1);this._selection.length=0},destroySelection:function(){this._selectFeatureOnClick(!1),this._subscribeLayerEvents(!1),this.clearSelection()},isLayerSelected:function(a){return this._getLayerIndex(a)>-1},_subscribeLayerEvents:function(a){function b(a){this._layerModel.mapLayer.options.visible||this.clearSelection()}this._layerModel&&a&&(this._layerModel.on("mapexspress:layermodel:visiblechanged",b.bind(this),this),this._layerModel.mapLayer.on("mapexspress:layer:data:added",this._onDataAdded,this)),this._layerModel&&!a&&(this._selectFeatureOnClick(!1),this._layerModel.off("mapexspress:layermodel:visiblechanged",b.bind(this),this),this._layerModel.mapLayer.off("mapexspress:layer:data:added",this._onDataAdded,this))},_onDataAdded:function(a){this._restoreSelection()},_getLayerIndex:function(a){var b=this._findIndex(this._selection,function(b){return b._leaflet_id===a._leaflet_id});return b},_resetLayerStyle:function(a){if(a&&a instanceof MapExpress.Layers.GeoJSONServiceLayer&&a.updateStyle(),a&&a.feature&&a.feature.properties&&a.feature.properties.style)try{var b=JSON.parse(a.feature.properties.style);if(b)return void a.setStyle(b)}catch(b){return void a.setStyle(a.oldStyle)}a.setStyle(a.oldStyle)},_restoreSelection:function(){var a=this._selection.slice(0);if(this.clearSelection(),this._layerModel&&this._layerModel.mapLayer)for(var b=a.length-1;b>=0;b--){var c=a[b],d=MapExpress.Utils.GeoJSONUtils.getLayerByPropertyValueFromLayerGroup(this._layerModel.mapLayer,this.options.featureKeyFieldName,c.feature.properties[this.options.featureKeyFieldName]);d&&this.addSelection(d,!1)}this._selectFeatureOnClick(!0)},featureOnClick:function(a){this.invertSelection(a.target)},_selectFeatureOnClick:function(a){var b=this;this._layerModel&&this._layerModel.mapLayer&&this._layerModel.mapLayer.eachLayer(function(c){a?(c.off("click",b.featureOnClick,b),c.on("click",b.featureOnClick,b)):c.off("click",b.featureOnClick,b)})},_findIndex:function(a,b){var c,d;for(c in a)if(d=a[c],b(d))return parseInt(c);return-1}}),MapExpress.Mapping.Selection.SingleUseSelection=MapExpress.Mapping.Selection.extend({featureOnClick:function(a){this.destroySelection()}}),MapExpress.Mapping.MapWorkspaseLoader={getMapWorkspaceFromURLAsync:function(a){return MapExpress.Utils.Promise.GetJSON(a)},getMapWorkspaceFromFileAsync:function(a){var b=$.Deferred();if(window.File&&window.FileReader&&window.FileList&&window.Blob){if("undefined"===a)return void b.reject("file === undefined");var c=new FileReader;c.readAsText(a),c.onload=function(a){var c=a.target.result,d=JSON.parse(c);b.resolve(d)},c.onerror=function(a){b.reject(a.target.error)}}return b.promise()}},function(){"use strict";var a={projections:{"Местная Нижегородская":"+proj=tmerc +lat_0=0 +lon_0=43.9678807083333 +k=1 +x_0=-1169.898 +y_0=-6242460.881 +ellps=krass +towgs84=-35.344,-35.841,-82.937,2.49759,1.4563,-1.85984,-2.046708 +units=m +no_defs","МСК 01, зона 1":"+title= МСК-01 зона 1 Республика Адыгея    +proj=tmerc +lat_0=0 +lon_0=37.98333333333 +k=1 +x_0=1300000 +y_0=-4511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 01, зона 2":"+title= МСК-01 зона 2 Республика Адыгея    +proj=tmerc +lat_0=0 +lon_0=40.98333333333 +k=1 +x_0=2300000 +y_0=-4511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 02, зона 1":"+title= МСК-02 зона 1 Республика Башкортостан    +proj=tmerc +lat_0=0 +lon_0=55.03333333333 +k=1 +x_0=1300000 +y_0=-5409414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 02, зона 2":"+title= МСК-02 зона 2 Республика Башкортостан    +proj=tmerc +lat_0=0 +lon_0=58.03333333333 +k=1 +x_0=2300000 +y_0=-5409414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 03, зона 1":"+title= МСК-03 зона 1 Республика Бурятия    +proj=tmerc +lat_0=0 +lon_0=100.03333333333 +k=1 +x_0=1250000 +y_0=-5211057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 03, зона 2":"+title= МСК-03 зона 2 Республика Бурятия    +proj=tmerc +lat_0=0 +lon_0=103.03333333333 +k=1 +x_0=2250000 +y_0=-5211057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 03, зона 3":"+title= МСК-03 зона 3 Республика Бурятия    +proj=tmerc +lat_0=0 +lon_0=106.03333333333 +k=1 +x_0=3250000 +y_0=-5211057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 03, зона 4":"+title= МСК-03 зона 4 Республика Бурятия    +proj=tmerc +lat_0=0 +lon_0=109.03333333333 +k=1 +x_0=4250000 +y_0=-5211057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 03, зона 5":"+title= МСК-03 зона 5 Республика Бурятия    +proj=tmerc +lat_0=0 +lon_0=112.03333333333 +k=1 +x_0=5250000 +y_0=-5211057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 03, зона 6":"+title= МСК-03 зона 6 Республика Бурятия    +proj=tmerc +lat_0=0 +lon_0=115.03333333333 +k=1 +x_0=6250000 +y_0=-5211057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 03, зона 7":"+title= МСК-03 зона 7 Республика Бурятия    +proj=tmerc +lat_0=0 +lon_0=118.03333333333 +k=1 +x_0=7250000 +y_0=-5211057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 04, зона 1":"+title= МСК-04 зона 1 Республика Алтай    +proj=tmerc +lat_0=0 +lon_0=85.46666666666 +k=1 +x_0=1300000 +y_0=-5112900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 04, зона 2":"+title= МСК-04 зона 2 Республика Алтай    +proj=tmerc +lat_0=0 +lon_0=88.46666666666 +k=1 +x_0=2300000 +y_0=-5112900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 05, зона 1":"+title= МСК-05 зона 1 Республика Дагестан    +proj=tmerc +lat_0=0 +lon_0=46.98333333333 +k=1 +x_0=4300000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 06, зона 1":"+title= МСК-06 зона 1 Республика Ингушетия    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=1300000 +y_0=-4311057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 07, зона 1":"+title= МСК-07 зона 1 Кабардино-Балкарская Республика    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=1300000 +y_0=-4311057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 08, зона 1":"+title= МСК-08 зона 1 Республика Калмыкия    +proj=tmerc +lat_0=0 +lon_0=40.98333333333 +k=1 +x_0=1300000 +y_0=-4711057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 08, зона 2":"+title= МСК-08 зона 2 Республика Калмыкия    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=2300000 +y_0=-4711057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 08, зона 3":"+title= МСК-08 зона 3 Республика Калмыкия    +proj=tmerc +lat_0=0 +lon_0=46.98333333333 +k=1 +x_0=3300000 +y_0=-4711057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 09, зона 1":"+title= МСК-09 зона 1 Республика Карачаево-Черкесия    +proj=tmerc +lat_0=0 +lon_0=40.98333333333 +k=1 +x_0=1300000 +y_0=-4311057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 10, зона 1":"+title= МСК-10 зона 1 (6 градусная) Республика Карелия    +proj=tmerc +lat_0=0 +lon_0=32.03333333333 +k=1 +x_0=1400000 +y_0=-6511057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 10, зона 2":"+title= МСК-10 зона 2 (6 градусная) Республика Карелия    +proj=tmerc +lat_0=0 +lon_0=38.03333333333 +k=1 +x_0=2400000 +y_0=-6511057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 1":"+title= МСК-11 зона 1 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=41.03333333333 +k=1 +x_0=1400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 2":"+title= МСК-11 зона 2 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=44.03333333333 +k=1 +x_0=2400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 3":"+title= МСК-11 зона 3 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=47.03333333333 +k=1 +x_0=3400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 4":"+title= МСК-11 зона 4 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=50.03333333333 +k=1 +x_0=4400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 5":"+title= МСК-11 зона 5 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=53.03333333333 +k=1 +x_0=5400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs",
"МСК 11, зона 6":"+title= МСК-11 зона 6 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=56.03333333333 +k=1 +x_0=6400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 7":"+title= МСК-11 зона 7 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=59.03333333333 +k=1 +x_0=7400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 8":"+title= МСК-11 зона 8 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=62.03333333333 +k=1 +x_0=8400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 11, зона 9":"+title= МСК-11 зона 9 Республика Коми    +proj=tmerc +lat_0=0 +lon_0=65.03333333333 +k=1 +x_0=9400000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 12, зона 1":"+title= МСК-12 зона 1 Республика Марий Эл    +proj=tmerc +lat_0=0 +lon_0=47.55 +k=1 +x_0=1250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 12, зона 2":"+title= МСК-12 зона 2 Республика Марий Эл    +proj=tmerc +lat_0=0 +lon_0=50.55 +k=1 +x_0=2250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 13, зона 1":"+title= МСК-13 зона 1 Республика Мордовия    +proj=tmerc +lat_0=0 +lon_0=44.55 +k=1 +x_0=1250000 +y_0=-5614743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 13, зона 2":"+title= МСК-13 зона 2 Республика Мордовия    +proj=tmerc +lat_0=0 +lon_0=47.55 +k=1 +x_0=2250000 +y_0=-5614743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 1":"+title= МСК-14 зона 1 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=108.45 +k=1 +x_0=1400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 2":"+title= МСК-14 зона 2 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=114.45 +k=1 +x_0=2400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 3":"+title= МСК-14 зона 3 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=120.45 +k=1 +x_0=3400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 4":"+title= МСК-14 зона 4 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=126.45 +k=1 +x_0=4400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 5":"+title= МСК-14 зона 5 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=132.45 +k=1 +x_0=5400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 6":"+title= МСК-14 зона 6 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=138.45 +k=1 +x_0=6400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 7":"+title= МСК-14 зона 7 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=144.45 +k=1 +x_0=7400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 8":"+title= МСК-14 зона 8 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=150.45 +k=1 +x_0=8400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 14, зона 9":"+title= МСК-14 зона 9 (6 градусная) Республика Саха (Якутия)    +proj=tmerc +lat_0=0 +lon_0=156.45 +k=1 +x_0=9400000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 15, зона 1":"+title= МСК-15 зона 1 Северная Осетия - Алания    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=1300000 +y_0=-4311057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 16, зона 1":"+title= МСК-16 зона 1 Республика Татарстан    +proj=tmerc +lat_0=0 +lon_0=49.033333333333 +k=1 +x_0=1300000 +y_0=-5709414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 16, зона 2":"+title= МСК-16 зона 2 Республика Татарстан    +proj=tmerc +lat_0=0 +lon_0=52.033333333333 +k=1 +x_0=2300000 +y_0=-5709414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 16, зона 3":"+title= МСК-16 зона 3 Республика Татарстан    +proj=tmerc +lat_0=0 +lon_0=55.033333333333 +k=1 +x_0=3300000 +y_0=-5709414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 18, зона 1":"+title= МСК-18 зона 1 Удмуртская Республика    +proj=tmerc +lat_0=0 +lon_0=50.55 +k=1 +x_0=1250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 18, зона 2":"+title= МСК-18 зона 2 Удмуртская Республика    +proj=tmerc +lat_0=0 +lon_0=53.55 +k=1 +x_0=2250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 20, зона 1":"+title= МСК-20 зона 1 Чеченская Республика    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=1300000 +y_0=-4311057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 20, зона 2":"+title= МСК-20 зона 2 Чеченская Республика    +proj=tmerc +lat_0=0 +lon_0=46.98333333333 +k=1 +x_0=2300000 +y_0=-4311057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 21, зона 1":"+title= МСК-21 зона 1 Чувашская Республика    +proj=tmerc +lat_0=0 +lon_0=47.55 +k=1 +x_0=1250000 +y_0=-5814743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 21, зона 2":"+title= МСК-21 зона 2 Чувашская Республика    +proj=tmerc +lat_0=0 +lon_0=50.55 +k=1 +x_0=2250000 +y_0=-5814743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 22, зона 1":"+title= МСК-22 зона 1 Алтайский край    +proj=tmerc +lat_0=0 +lon_0=79.46666666666 +k=1 +x_0=1300000 +y_0=-5312900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 22, зона 2":"+title= МСК-22 зона 2 Алтайский край    +proj=tmerc +lat_0=0 +lon_0=82.46666666666 +k=1 +x_0=2300000 +y_0=-5312900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 22, зона 3":"+title= МСК-22 зона 3 Алтайский край    +proj=tmerc +lat_0=0 +lon_0=85.46666666666 +k=1 +x_0=3300000 +y_0=-5312900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 23, зона 1":"+title= МСК-23 зона 1 Краснодарский край    +proj=tmerc +lat_0=0 +lon_0=37.98333333333 +k=1 +x_0=1300000 +y_0=-4511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 23, зона 2":"+title= МСК-23 зона 2 Краснодарский край    +proj=tmerc +lat_0=0 +lon_0=40.98333333333 +k=1 +x_0=2300000 +y_0=-4511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 24, зона 1":"+title= МСК-24 зона 1 (6 градусная) Красноярский край    +proj=tmerc +lat_0=0 +lon_0=81.51666666666 +k=1 +x_0=1500000 +y_0=-5416586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 24, зона 2":"+title= МСК-24 зона 2 (6 градусная) Красноярский край    +proj=tmerc +lat_0=0 +lon_0=87.51666666666 +k=1 +x_0=2500000 +y_0=-5416586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 24, зона 3":"+title= МСК-24 зона 3 (6 градусная) Красноярский край    +proj=tmerc +lat_0=0 +lon_0=93.51666666666 +k=1 +x_0=3500000 +y_0=-5416586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 24, зона 4":"+title= МСК-24 зона 4 (6 градусная) Красноярский край    +proj=tmerc +lat_0=0 +lon_0=99.51666666666 +k=1 +x_0=4500000 +y_0=-5416586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 24, зона 5":"+title= МСК-24 зона 5 (6 градусная) Красноярский край    +proj=tmerc +lat_0=0 +lon_0=105.51666666666 +k=1 +x_0=5500000 +y_0=-5416586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 24, зона 6":"+title= МСК-24 зона 6 (6 градусная) Красноярский край    +proj=tmerc +lat_0=0 +lon_0=111.51666666666 +k=1 +x_0=6500000 +y_0=-5416586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК г. Красноярск":"+title= МСК г. Красноярск    +proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=54304.47 +y_0=-6196680.59 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 164":"+title= МСК-164 Красноярский край    +proj=tmerc +lat_0=0 +lon_0=84 +k=1 +x_0=86209.80 +y_0=-6542783.50 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 165":"+title= МСК-165 Красноярский край    +proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=105295.80 +y_0=-5652185.00 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 166":"+title= МСК-166 Красноярский край    +proj=tmerc +lat_0=0 +lon_0=90 +k=1 +x_0=107543.30 +y_0=-5540944.50 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 167":"+title= МСК-167 Красноярский край    +proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=106797.80 +y_0=-5578022.50 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 168":"+title= МСК-168 Красноярский край    +proj=tmerc +lat_0=0 +lon_0=96 +k=1 +x_0=108285.20 +y_0=-5503868.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 169":"+title= МСК-169 Красноярский край    +proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=117308.60 +y_0=-5503868.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 25, зона 1":"+title= МСК-25 зона 1 Приморский край    +proj=tmerc +lat_0=0 +lon_0=130.71666666666 +k=1 +x_0=1300000 +y_0=-4416586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 25, зона 2":"+title= МСК-25 зона 2 Приморский край    +proj=tmerc +lat_0=0 +lon_0=133.71666666666 +k=1 +x_0=2300000 +y_0=-4416586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 25, зона 3":"+title= МСК-25 зона 3 Приморский край    +proj=tmerc +lat_0=0 +lon_0=136.71666666666 +k=1 +x_0=3300000 +y_0=-4416586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 25, зона 4":"+title= МСК-25 зона 4 Приморский край    +proj=tmerc +lat_0=0 +lon_0=139.71666666666 +k=1 +x_0=4300000 +y_0=-4416586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 26, зона 1":"+title= МСК-26 зона 1 Ставропольский край    +proj=tmerc +lat_0=0 +lon_0=40.98333333333 +k=1 +x_0=1300000 +y_0=-4511057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 26, зона 2":"+title= МСК-26 зона 2 Ставропольский край    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=2300000 +y_0=-4511057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 27, зона 1":"+title= МСК-27 зона 1 Хабаровский край    +proj=tmerc +lat_0=0 +lon_0=130.71666666666 +k=1 +x_0=1300000 +y_0=-4916586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 27, зона 2":"+title= МСК-27 зона 2 Хабаровский край    +proj=tmerc +lat_0=0 +lon_0=133.71666666666 +k=1 +x_0=2300000 +y_0=-4916586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 27, зона 3":"+title= МСК-27 зона 3 Хабаровский край    +proj=tmerc +lat_0=0 +lon_0=136.71666666666 +k=1 +x_0=3300000 +y_0=-4916586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 27, зона 4":"+title= МСК-27 зона 4 Хабаровский край    +proj=tmerc +lat_0=0 +lon_0=139.71666666666 +k=1 +x_0=4300000 +y_0=-4916586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 27, зона 5":"+title= МСК-27 зона 5 Хабаровский край    +proj=tmerc +lat_0=0 +lon_0=142.71666666666 +k=1 +x_0=5300000 +y_0=-4916586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 27, зона 6":"+title= МСК-27 зона 6 Хабаровский край    +proj=tmerc +lat_0=0 +lon_0=145.71666666666 +k=1 +x_0=6300000 +y_0=-4916586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 28, зона 1":"+title= МСК-28 зона 1 Амурская область    +proj=tmerc +lat_0=0 +lon_0=121.71666666666 +k=1 +x_0=1300000 +y_0=-5116586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 28, зона 2":"+title= МСК-28 зона 2 Амурская область    +proj=tmerc +lat_0=0 +lon_0=124.71666666666 +k=1 +x_0=2300000 +y_0=-5116586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 28, зона 3":"+title= МСК-28 зона 3 Амурская область    +proj=tmerc +lat_0=0 +lon_0=127.71666666666 +k=1 +x_0=3300000 +y_0=-5116586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 28, зона 4":"+title= МСК-28 зона 4 Амурская область    +proj=tmerc +lat_0=0 +lon_0=130.71666666666 +k=1 +x_0=4300000 +y_0=-5116586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 28, зона 5":"+title= МСК-28 зона 5 Амурская область    +proj=tmerc +lat_0=0 +lon_0=133.71666666666 +k=1 +x_0=5300000 +y_0=-5116586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 29, зона 1":"+title= МСК-29 зона 1 (6 градусная) Архангельская область    +proj=tmerc +lat_0=0 +lon_0=32.03333333333 +k=1 +x_0=1400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 29, зона 2":"+title= МСК-29 зона 2 (6 градусная) Архангельская область    +proj=tmerc +lat_0=0 +lon_0=38.03333333333 +k=1 +x_0=2400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 29, зона 3":"+title= МСК-29 зона 3 (6 градусная) Архангельская область    +proj=tmerc +lat_0=0 +lon_0=44.03333333333 +k=1 +x_0=3400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 29, зона 4":"+title= МСК-29 зона 4 (6 градусная) Архангельская область    +proj=tmerc +lat_0=0 +lon_0=50.03333333333 +k=1 +x_0=4400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 30, зона 1":"+title= МСК-30 зона 1 Астраханская область    +proj=tmerc +lat_0=0 +lon_0=46.05 +k=1 +x_0=1300000 +y_0=-4714743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 30, зона 2":"+title= МСК-30 зона 2 Астраханская область    +proj=tmerc +lat_0=0 +lon_0=49.05 +k=1 +x_0=2300000 +y_0=-4714743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 31, зона 1":"+title= МСК-31 зона 1 Белгородская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=1250000 +y_0=-5212900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 31, зона 2":"+title= МСК-31 зона 2 Белгородская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=2250000 +y_0=-5212900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 32, зона 1":"+title= МСК-32 зона 1 Брянская область    +proj=tmerc +lat_0=0 +lon_0=32.48333333333 +k=1 +x_0=1250000 +y_0=-5412900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 32, зона 2":"+title= МСК-32 зона 2 Брянская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=2250000 +y_0=-5412900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 33, от СК-63 зона 1":"+title= МСК-33 от СК-63 зона 1 Владимирская область    +proj=tmerc +lat_0=0 +lon_0=38.55 +k=1 +x_0=1250000 +y_0=-5814743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 33, от СК-63 зона 2":"+title= МСК-33 от СК-63 зона 2 Владимирская область    +proj=tmerc +lat_0=0 +lon_0=41.55 +k=1 +x_0=2250000 +y_0=-5814743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 33, от СК-63 зона 3":"+title= МСК-33 от СК-63 зона 3 Владимирская область    +proj=tmerc +lat_0=0 +lon_0=44.55 +k=1 +x_0=3250000 +y_0=-5814743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 33, от СК-95":"+title= МСК-33 от СК-95 Владимирская область    +proj=tmerc +lat_0=0 +lon_0=39 +k=1 +x_0=134156.988 +y_0=-6032524.376 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 34, зона 1":"+title= МСК-34 зона 1 Волгоградская область    +proj=tmerc +lat_0=0 +lon_0=43.05 +k=1 +x_0=1300000 +y_0=-4914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 34, зона 2":"+title= МСК-34 зона 2 Волгоградская область    +proj=tmerc +lat_0=0 +lon_0=46.05 +k=1 +x_0=2300000 +y_0=-4914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 35, зона 1":"+title= МСК-35 зона 1 Вологодская область    +proj=tmerc +lat_0=0 +lon_0=35.55 +k=1 +x_0=1250000 +y_0=-6214743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 35, зона 2":"+title= МСК-35 зона 2 Вологодская область    +proj=tmerc +lat_0=0 +lon_0=38.55 +k=1 +x_0=2250000 +y_0=-6214743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 35, зона 3":"+title= МСК-35 зона 3 Вологодская область    +proj=tmerc +lat_0=0 +lon_0=41.55 +k=1 +x_0=3250000 +y_0=-6214743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 35, зона 4":"+title= МСК-35 зона 4 Вологодская область    +proj=tmerc +lat_0=0 +lon_0=44.55 +k=1 +x_0=4250000 +y_0=-6214743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 36, зона 1":"+title= МСК-36 зона 1 Воронежская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=1250000 +y_0=-5212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 36, зона 2":"+title= МСК-36 зона 2 Воронежская область    +proj=tmerc +lat_0=0 +lon_0=41.48333333333 +k=1 +x_0=2250000 +y_0=-5212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 37, зона 1":"+title= МСК-37 зона 1 Ивановская область    +proj=tmerc +lat_0=0 +lon_0=38.55 +k=1 +x_0=1250000 +y_0=-6014743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 37, зона 2":"+title= МСК-37 зона 2 Ивановская область    +proj=tmerc +lat_0=0 +lon_0=41.55 +k=1 +x_0=2250000 +y_0=-6014743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 1":"+title= МСК-38 зона 1 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=97.03333333333 +k=1 +x_0=1250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 2":"+title= МСК-38 зона 2 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=100.03333333333 +k=1 +x_0=2250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 3":"+title= МСК-38 зона 3 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=103.03333333333 +k=1 +x_0=3250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 4":"+title= МСК-38 зона 4 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=106.03333333333 +k=1 +x_0=4250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 5":"+title= МСК-38 зона 5 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=109.03333333333 +k=1 +x_0=5250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 6":"+title= МСК-38 зона 6 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=112.03333333333 +k=1 +x_0=6250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 7":"+title= МСК-38 зона 7 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=115.03333333333 +k=1 +x_0=7250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 38, зона 8":"+title= МСК-38 зона 8 Иркутская область    +proj=tmerc +lat_0=0 +lon_0=118.03333333333 +k=1 +x_0=8250000 +y_0=-5411057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 39, зона 1":"+title= МСК-39 зона 1 Калининградская область    +proj=tmerc +lat_0=0 +lon_0=21.45 +k=1 +x_0=1250000 +y_0=-5711057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 40, зона 1":"+title= МСК-40 зона 1 Калужская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=1250000 +y_0=-5612900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 41, зона 1":"+title= МСК-41 зона 1 (6 градусная) Камчатский край    +proj=tmerc +lat_0=0 +lon_0=158.46666666667 +k=1 +x_0=1400000 +y_0=-5316586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 41, зона 2":"+title= МСК-41 зона 2 (6 градусная) Камчатский край    +proj=tmerc +lat_0=0 +lon_0=164.46666666667 +k=1 +x_0=2400000 +y_0=-5316586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 41, зона 3":"+title= МСК-41 зона 3 (6 градусная) Камчатский край    +proj=tmerc +lat_0=0 +lon_0=170.46666666667 +k=1 +x_0=3400000 +y_0=-5316586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 42, зона 1":"+title= МСК-42 зона 1 Кемеровская область    +proj=tmerc +lat_0=0 +lon_0=85.46666666666 +k=1 +x_0=1300000 +y_0=-5512900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 42, зона 2":"+title= МСК-42 зона 2 Кемеровская область    +proj=tmerc +lat_0=0 +lon_0=88.46666666666 +k=1 +x_0=2300000 +y_0=-5512900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 43, зона 1":"+title= МСК-43 зона 1 Кировская область    +proj=tmerc +lat_0=0 +lon_0=47.55 +k=1 +x_0=1250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 43, зона 2":"+title= МСК-43 зона 2 Кировская область    +proj=tmerc +lat_0=0 +lon_0=50.55 +k=1 +x_0=2250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 43, зона 3":"+title= МСК-43 зона 3 Кировская область    +proj=tmerc +lat_0=0 +lon_0=53.55 +k=1 +x_0=3250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 44, зона 1":"+title= МСК-44 зона 1 Костромская область    +proj=tmerc +lat_0=0 +lon_0=41.55 +k=1 +x_0=1250000 +y_0=-6114743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 44, зона 2":"+title= МСК-44 зона 2 Костромская область    +proj=tmerc +lat_0=0 +lon_0=44.55 +k=1 +x_0=2250000 +y_0=-6114743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 44, зона 3":"+title= МСК-44 зона 3 Костромская область    +proj=tmerc +lat_0=0 +lon_0=47.55 +k=1 +x_0=3250000 +y_0=-6114743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 45, зона 1":"+title= МСК-45 зона 1 Курганская область    +proj=tmerc +lat_0=0 +lon_0=61.03333333333 +k=1 +x_0=1300000 +y_0=-5709414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 45, зона 2":"+title= МСК-45 зона 2 Курганская область    +proj=tmerc +lat_0=0 +lon_0=64.03333333333 +k=1 +x_0=2300000 +y_0=-5709414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 45, зона 3":"+title= МСК-45 зона 3 Курганская область    +proj=tmerc +lat_0=0 +lon_0=67.03333333333 +k=1 +x_0=3300000 +y_0=-5709414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 46, зона 1":"+title= МСК-46 зона 1 Курская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=1250000 +y_0=-5312900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 46, зона 2":"+title= МСК-46 зона 2 Курская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=2250000 +y_0=-5312900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 47, зона 1":"+title= МСК-47 зона 1 Ленинградская область    +proj=tmerc +lat_0=0 +lon_0=27.95 +k=1 +x_0=1250000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 47, зона 2":"+title= МСК-47 зона 2 Ленинградская область    +proj=tmerc +lat_0=0 +lon_0=30.95 +k=1 +x_0=2250000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 47, зона 3":"+title= МСК-47 зона 3 Ленинградская область    +proj=tmerc +lat_0=0 +lon_0=33.95 +k=1 +x_0=3250000 +y_0=-6211057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 1964 Санкт-Петербург":"+title= МСК-1964 Санкт-Петербург    +proj=tmerc +lat_0=0 +lon_0=30 +k=1 +x_0=95942.17 +y_0=-6552810.0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 48, зона 1":"+title= МСК-48 зона 1 Липецкая область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=1250000 +y_0=-5412900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 48, зона 2":"+title= МСК-48 зона 2 Липецкая область    +proj=tmerc +lat_0=0 +lon_0=41.48333333333 +k=1 +x_0=2250000 +y_0=-5412900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 49, зона 1":"+title= МСК-49 зона 1 (6 градусная) Магаданская область    +proj=tmerc +lat_0=0 +lon_0=144.45 +k=1 +x_0=1400000 +y_0=-6212900.566  +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 49, зона 2":"+title= МСК-49 зона 2 (6 градусная) Магаданская область    +proj=tmerc +lat_0=0 +lon_0=150.45 +k=1 +x_0=2400000 +y_0=-6212900.566  +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 49, зона 3":"+title= МСК-49 зона 3 (6 градусная) Магаданская область    +proj=tmerc +lat_0=0 +lon_0=156.45 +k=1 +x_0=3400000 +y_0=-6212900.566  +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 49, зона 4":"+title= МСК-49 зона 4 (6 градусная) Магаданская область    +proj=tmerc +lat_0=0 +lon_0=162.45 +k=1 +x_0=4400000 +y_0=-6212900.566  +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Московская СК (МГГТ)":"+title= Московская СК (МГГТ)    +proj=tmerc +lat_0=55.66666666667 +lon_0=37.5 +k=1 +x_0=16.098 +y_0=14.512 +ellps=bessel +towgs84=316.151,78.924,589.650,-1.57273,2.69209,2.34693,8.4507 +units=m +no_defs","МСК 50, зона 1":"+title= МСК-50 зона 1 Московская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=1250000 +y_0=-5712900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 50, зона 2":"+title= МСК-50 зона 2 Московская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=2250000 +y_0=-5712900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 51, зона 1":"+title= МСК-51 зона 1 (6 градусная) Мурманская область    +proj=tmerc +lat_0=0 +lon_0=32.03333333333 +k=1 +x_0=1400000 +y_0=-7011057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 51, зона 2":"+title= МСК-51 зона 2 (6 градусная) Мурманская область    +proj=tmerc +lat_0=0 +lon_0=38.03333333333 +k=1 +x_0=2400000 +y_0=-7011057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 52, зона 1":"+title= МСК-52 зона 1 Нижегородская область    +proj=tmerc +lat_0=0 +lon_0=41.55 +k=1 +x_0=1250000 +y_0=-5714743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 52, зона 2":"+title= МСК-52 зона 2 Нижегородская область    +proj=tmerc +lat_0=0 +lon_0=44.55 +k=1 +x_0=2250000 +y_0=-5714743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 52, зона 3":"+title= МСК-52 зона 3 Нижегородская область    +proj=tmerc +lat_0=0 +lon_0=47.55 +k=1 +x_0=3250000 +y_0=-5714743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 53, зона 1":"+title= МСК-53 зона 1 Новгородская область    +proj=tmerc +lat_0=0 +lon_0=29.48333333333 +k=1 +x_0=1250000 +y_0=-5912900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 53, зона 2":"+title= МСК-53 зона 2 Новгородская область    +proj=tmerc +lat_0=0 +lon_0=32.48333333333 +k=1 +x_0=2250000 +y_0=-5912900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 53, зона 3":"+title= МСК-53 зона 3 Новгородская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=3250000 +y_0=-5912900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 54, зона 1":"+title= МСК-54 зона 1 Новосибирская область    +proj=tmerc +lat_0=0 +lon_0=74.73333333333 +k=1 +x_0=1250000 +y_0=-5612900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 54, зона 2":"+title= МСК-54 зона 2 Новосибирская область    +proj=tmerc +lat_0=0 +lon_0=77.73333333333 +k=1 +x_0=2250000 +y_0=-5612900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 54, зона 3":"+title= МСК-54 зона 3 Новосибирская область    +proj=tmerc +lat_0=0 +lon_0=80.73333333333 +k=1 +x_0=3250000 +y_0=-5612900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 54, зона 4":"+title= МСК-54 зона 4 Новосибирская область    +proj=tmerc +lat_0=0 +lon_0=83.73333333333 +k=1 +x_0=4250000 +y_0=-5612900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 55, зона 1":"+title= МСК-55 зона 1 Омская область    +proj=tmerc +lat_0=0 +lon_0=71.73333333333 +k=1 +x_0=1250000 +y_0=-5612900.563 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 55, зона 2":"+title= МСК-55 зона 2 Омская область    +proj=tmerc +lat_0=0 +lon_0=74.73333333333 +k=1 +x_0=2250000 +y_0=-5612900.563 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 56, зона 1":"+title= МСК-56 зона 1 Оренбургская область    +proj=tmerc +lat_0=0 +lon_0=52.03333333333 +k=1 +x_0=1300000 +y_0=-5309414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 56, зона 2":"+title= МСК-56 зона 2 Оренбургская область    +proj=tmerc +lat_0=0 +lon_0=55.03333333333 +k=1 +x_0=2300000 +y_0=-5309414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 56, зона 3":"+title= МСК-56 зона 3 Оренбургская область    +proj=tmerc +lat_0=0 +lon_0=58.03333333333 +k=1 +x_0=3300000 +y_0=-5309414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 56, зона 4":"+title= МСК-56 зона 4 Оренбургская область    +proj=tmerc +lat_0=0 +lon_0=61.03333333333 +k=1 +x_0=4300000 +y_0=-5309414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 57, зона 1":"+title= МСК-57 зона 1 Орловская область    +proj=tmerc +lat_0=0 +lon_0=32.48333333333 +k=1 +x_0=1250000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 57, зона 2":"+title= МСК-57 зона 2 Орловская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=2250000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 57, зона 3":"+title= МСК-57 зона 3 Орловская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=3250000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs",
"МСК 58, зона 1":"+title= МСК-58 зона 1 Пензенская область    +proj=tmerc +lat_0=0 +lon_0=43.05 +k=1 +x_0=1300000 +y_0=-5514743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 58, зона 2":"+title= МСК-58 зона 2 Пензенская область    +proj=tmerc +lat_0=0 +lon_0=46.05 +k=1 +x_0=2300000 +y_0=-5514743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 59, зона 1":"+title= МСК-59 зона 1 Пермский край    +proj=tmerc +lat_0=0 +lon_0=53.55 +k=1 +x_0=1250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 59, зона 2":"+title= МСК-59 зона 2 Пермский край    +proj=tmerc +lat_0=0 +lon_0=56.55 +k=1 +x_0=2250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 59, зона 3":"+title= МСК-59 зона 3 Пермский край    +proj=tmerc +lat_0=0 +lon_0=59.55 +k=1 +x_0=3250000 +y_0=-5914743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 60, зона 1":"+title= МСК-60 зона 1 Псковская область    +proj=tmerc +lat_0=0 +lon_0=27.95 +k=1 +x_0=1250000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 60, зона 2":"+title= МСК-60 зона 2 Псковская область    +proj=tmerc +lat_0=0 +lon_0=30.95 +k=1 +x_0=2250000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 60, зона 3":"+title= МСК-60 зона 3 Псковская область    +proj=tmerc +lat_0=0 +lon_0=33.95 +k=1 +x_0=3250000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 61, зона 1":"+title= МСК-61 зона 1 Ростовская область    +proj=tmerc +lat_0=0 +lon_0=37.98333333333 +k=1 +x_0=1300000 +y_0=-4811057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 61, зона 2":"+title= МСК-61 зона 2 Ростовская область    +proj=tmerc +lat_0=0 +lon_0=40.98333333333 +k=1 +x_0=2300000 +y_0=-4811057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 61, зона 3":"+title= МСК-61 зона 3 Ростовская область    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=3300000 +y_0=-4811057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 62, зона 1":"+title= МСК-62 зона 1 Рязанская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=1250000 +y_0=-5612900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 62, зона 2":"+title= МСК-62 зона 2 Рязанская область    +proj=tmerc +lat_0=0 +lon_0=41.48333333333 +k=1 +x_0=2250000 +y_0=-5612900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 62, зона 3":"+title= МСК-62 зона 3 Рязанская область    +proj=tmerc +lat_0=0 +lon_0=44.48333333333 +k=1 +x_0=3250000 +y_0=-5612900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 63, зона 1":"+title= МСК-63 зона 1 Самарская область    +proj=tmerc +lat_0=0 +lon_0=49.03333333333 +k=1 +x_0=1300000 +y_0=-5509414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 63, зона 2":"+title= МСК-63 зона 2 Самарская область    +proj=tmerc +lat_0=0 +lon_0=52.03333333333 +k=1 +x_0=2300000 +y_0=-5509414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 64, зона 1":"+title= МСК-64 зона 1 Саратовская область    +proj=tmerc +lat_0=0 +lon_0=43.05 +k=1 +x_0=1300000 +y_0=-5214743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 64, зона 2":"+title= МСК-64 зона 2 Саратовская область    +proj=tmerc +lat_0=0 +lon_0=46.05 +k=1 +x_0=2300000 +y_0=-5214743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 64, зона 3":"+title= МСК-64 зона 3 Саратовская область    +proj=tmerc +lat_0=0 +lon_0=49.05 +k=1 +x_0=3300000 +y_0=-5214743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 65, зона 1":"+title= МСК-65 зона 1 Сахалинская область    +proj=tmerc +lat_0=0 +lon_0=142.71666666667 +k=1 +x_0=1300000 +y_0=-4516586.439 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 66, зона 1":"+title= МСК-66 зона 1 Свердловская область    +proj=tmerc +lat_0=0 +lon_0=60.05 +k=1 +x_0=1500000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 66, зона 2":"+title= МСК-66 зона 2 Свердловская область    +proj=tmerc +lat_0=0 +lon_0=63.05 +k=1 +x_0=2500000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 66, зона 3":"+title= МСК-66 зона 3 Свердловская область    +proj=tmerc +lat_0=0 +lon_0=66.05 +k=1 +x_0=3500000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 66, зона 1 (6 градусная)":"+title= МСК-66 зона 1 (6 градусная) Свердловская область    +proj=tmerc +lat_0=0 +lon_0=60.05 +k=1 +x_0=1500000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 66, зона 2 (6 градусная)":"+title= МСК-66 зона 2 (6 градусная) Свердловская область    +proj=tmerc +lat_0=0 +lon_0=66.05 +k=1 +x_0=2500000 +y_0=-5911057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 67, зона 1":"+title= МСК-67 зона 1 Смоленская область    +proj=tmerc +lat_0=0 +lon_0=32.48333333333 +k=1 +x_0=1250000 +y_0=-5612900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 67, зона 2":"+title= МСК-67 зона 2 Смоленская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=2250000 +y_0=-5612900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 67, зона 3":"+title= МСК-67 зона 3 Смоленская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=3250000 +y_0=-5612900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 68, зона 1":"+title= МСК-68 зона 1 Тамбовская область    +proj=tmerc +lat_0=0 +lon_0=41.48333333333 +k=1 +x_0=1250000 +y_0=-5412900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 68, зона 2":"+title= МСК-68 зона 2 Тамбовская область    +proj=tmerc +lat_0=0 +lon_0=44.48333333333 +k=1 +x_0=2250000 +y_0=-5412900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 68, зона 3":"+title= МСК-68 зона 3 Тамбовская область    +proj=tmerc +lat_0=0 +lon_0=47.48333333333 +k=1 +x_0=3250000 +y_0=-5412900.56 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 69, зона 1":"+title= МСК-69 зона 1 Тверская область    +proj=tmerc +lat_0=0 +lon_0=32.48333333333 +k=1 +x_0=1250000 +y_0=-6012900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 69, зона 2":"+title= МСК-69 зона 2 Тверская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=2250000 +y_0=-6012900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 69, зона 3":"+title= МСК-69 зона 3 Тверская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=3250000 +y_0=-6012900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 70, зона 1":"+title= МСК-70 зона 1 Томская область    +proj=tmerc +lat_0=0 +lon_0=74.73333333333 +k=1 +x_0=1250000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 70, зона 2":"+title= МСК-70 зона 2 Томская область    +proj=tmerc +lat_0=0 +lon_0=77.73333333333 +k=1 +x_0=2250000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 70, зона 3":"+title= МСК-70 зона 3 Томская область    +proj=tmerc +lat_0=0 +lon_0=80.73333333333 +k=1 +x_0=3250000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 70, зона 4":"+title= МСК-70 зона 4 Томская область    +proj=tmerc +lat_0=0 +lon_0=83.73333333333 +k=1 +x_0=4250000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 70, зона 5":"+title= МСК-70 зона 5 Томская область    +proj=tmerc +lat_0=0 +lon_0=86.73333333333 +k=1 +x_0=5250000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 70, зона 6":"+title= МСК-70 зона 6 Томская область    +proj=tmerc +lat_0=0 +lon_0=89.73333333333 +k=1 +x_0=6250000 +y_0=-5912900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 71 от СК-63, зона 1":"+title= МСК-71 от СК-63 зона 1 Тульская область    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=1250000 +y_0=-5612900.563 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 71 от СК-63, зона 2":"+title= МСК-71 от СК-63 зона 2 Тульская область    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=2250000 +y_0=-5612900.563 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 71.1 от СК-95, зона 1":"+title= МСК-71.1 от СК-95 зона 1 Тульская область    +proj=tmerc +lat_0=0 +lon_0=37.427222222222 +k=1 +x_0=250000 +y_0=-5263444.764 +ellps=krass +towgs84=24.83,-130.97,-81.74,0,0,0.13,-0.22 +units=m +no_defs","МСК 72, зона 1 (1.5 градусная)":"+title= МСК-72 зона 1 (1.5 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=66.08333333 +k=1 +x_0=1500000 +y_0=-6000000 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 2 (1.5 градусная)":"+title= МСК-72 зона 2 (1.5 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=67.58333333 +k=1 +x_0=2500000 +y_0=-6000000 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 3 (1.5 градусная)":"+title= МСК-72 зона 3 (1.5 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=69.08333333 +k=1 +x_0=3500000 +y_0=-6000000 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 4 (1.5 градусная)":"+title= МСК-72 зона 4 (1.5 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=70.58333333 +k=1 +x_0=4500000 +y_0=-6000000 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 5 (1.5 градусная)":"+title= МСК-72 зона 5 (1.5 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=72.08333333 +k=1 +x_0=5500000 +y_0=-6000000 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 6 (1.5 градусная)":"+title= МСК-72 зона 6 (1.5 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=73.58333333 +k=1 +x_0=6500000 +y_0=-6000000 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 1":"+title= МСК-72 зона 1 Тюменская область    +proj=tmerc +lat_0=0 +lon_0=63.05 +k=1 +x_0=1500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 2":"+title= МСК-72 зона 2 Тюменская область    +proj=tmerc +lat_0=0 +lon_0=66.05 +k=1 +x_0=2500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 3":"+title= МСК-72 зона 3 Тюменская область    +proj=tmerc +lat_0=0 +lon_0=69.05 +k=1 +x_0=3500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 4":"+title= МСК-72 зона 4 Тюменская область    +proj=tmerc +lat_0=0 +lon_0=72.05 +k=1 +x_0=4500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 5":"+title= МСК-72 зона 5 Тюменская область    +proj=tmerc +lat_0=0 +lon_0=75.05 +k=1 +x_0=5500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 1 (6 градусная)":"+title= МСК-72 зона 1 (6 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=63.05 +k=1 +x_0=1500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 2 (6 градусная)":"+title= МСК-72 зона 2 (6 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=69.05 +k=1 +x_0=2500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 72, зона 3 (6 градусная)":"+title= МСК-72 зона 3 (6 градусная) Тюменская область    +proj=tmerc +lat_0=0 +lon_0=75.05 +k=1 +x_0=3500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 73, зона 1":"+title= МСК-73 зона 1 Ульяновская область    +proj=tmerc +lat_0=0 +lon_0=46.05 +k=1 +x_0=1300000 +y_0=-5514743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 73, зона 2":"+title= МСК-73 зона 2 Ульяновская область    +proj=tmerc +lat_0=0 +lon_0=49.05 +k=1 +x_0=2300000 +y_0=-5514743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 74, зона 1":"+title= МСК-74 зона 1 Челябинская область    +proj=tmerc +lat_0=0 +lon_0=58.03333333333 +k=1 +x_0=1300000 +y_0=-5509414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 74, зона 2":"+title= МСК-74 зона 2 Челябинская область    +proj=tmerc +lat_0=0 +lon_0=61.03333333333 +k=1 +x_0=2300000 +y_0=-5509414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 74, зона 3":"+title= МСК-74 зона 3 Челябинская область    +proj=tmerc +lat_0=0 +lon_0=64.03333333333 +k=1 +x_0=3300000 +y_0=-5509414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 75, зона 1":"+title= МСК-75 зона 1 Забайкальский край    +proj=tmerc +lat_0=0 +lon_0=109.03333333333 +k=1 +x_0=1250000 +y_0=-5111057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 75, зона 2":"+title= МСК-75 зона 2 Забайкальский край    +proj=tmerc +lat_0=0 +lon_0=112.03333333333 +k=1 +x_0=2250000 +y_0=-5111057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 75, зона 3":"+title= МСК-75 зона 3 Забайкальский край    +proj=tmerc +lat_0=0 +lon_0=115.03333333333 +k=1 +x_0=3250000 +y_0=-5111057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 75, зона 4":"+title= МСК-75 зона 4 Забайкальский край    +proj=tmerc +lat_0=0 +lon_0=118.03333333333 +k=1 +x_0=4250000 +y_0=-5111057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 75, зона 5":"+title= МСК-75 зона 5 Забайкальский край    +proj=tmerc +lat_0=0 +lon_0=121.03333333333 +k=1 +x_0=5250000 +y_0=-5111057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 76, зона 1":"+title= МСК-76 зона 1 Ярославская область    +proj=tmerc +lat_0=0 +lon_0=38.55 +k=1 +x_0=1250000 +y_0=-6014743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 76, зона 2":"+title= МСК-76 зона 2 Ярославская область    +proj=tmerc +lat_0=0 +lon_0=41.55 +k=1 +x_0=2250000 +y_0=-6014743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 83, зона 3":"+title= МСК-83 зона 3 (6 градусная) Ненецкий автономный округ    +proj=tmerc +lat_0=0 +lon_0=44.03333333333 +k=1 +x_0=3400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 83, зона 4":"+title= МСК-83 зона 4 (6 градусная) Ненецкий автономный округ    +proj=tmerc +lat_0=0 +lon_0=50.03333333333 +k=1 +x_0=4400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 83, зона 5":"+title= МСК-83 зона 5 (6 градусная) Ненецкий автономный округ    +proj=tmerc +lat_0=0 +lon_0=56.03333333333 +k=1 +x_0=5400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 83, зона 6":"+title= МСК-83 зона 6 (6 градусная) Ненецкий автономный округ    +proj=tmerc +lat_0=0 +lon_0=62.03333333333 +k=1 +x_0=6400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 83, зона 7":"+title= МСК-83 зона 7 (6 градусная) Ненецкий автономный округ    +proj=tmerc +lat_0=0 +lon_0=68.03333333333 +k=1 +x_0=7400000 +y_0=-6511057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 86, зона 1":"+title= МСК-86 зона 1 (6 градусная) Ханты-Мансийский автономный округ — Югра    +proj=tmerc +lat_0=0 +lon_0=60.05 +k=1 +x_0=1500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 86, зона 2":"+title= МСК-86 зона 2 (6 градусная) Ханты-Мансийский автономный округ — Югра    +proj=tmerc +lat_0=0 +lon_0=66.05 +k=1 +x_0=2500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 86, зона 3":"+title= МСК-86 зона 3 (6 градусная) Ханты-Мансийский автономный округ — Югра    +proj=tmerc +lat_0=0 +lon_0=72.05 +k=1 +x_0=3500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 86, зона 4":"+title= МСК-86 зона 4 (6 градусная) Ханты-Мансийский автономный округ — Югра    +proj=tmerc +lat_0=0 +lon_0=78.05 +k=1 +x_0=4500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 86, зона 5":"+title= МСК-86 зона 5 (6 градусная) Ханты-Мансийский автономный округ — Югра    +proj=tmerc +lat_0=0 +lon_0=84.05 +k=1 +x_0=5500000 +y_0=-5811057.63 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 87, зона 3":"+title= МСК-87 зона 3 (6 градусная) Чукотский автономный округ    +proj=tmerc +lat_0=0 +lon_0=156.45 +k=1 +x_0=3400000 +y_0=-6212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 87, зона 4":"+title= МСК-87 зона 4 (6 градусная) Чукотский автономный округ    +proj=tmerc +lat_0=0 +lon_0=162.45 +k=1 +x_0=4400000 +y_0=-6212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 87, зона 5":"+title= МСК-87 зона 5 (6 градусная) Чукотский автономный округ    +proj=tmerc +lat_0=0 +lon_0=168.45 +k=1 +x_0=5400000 +y_0=-6212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 87, зона 6":"+title= МСК-87 зона 6 (6 градусная) Чукотский автономный округ    +proj=tmerc +lat_0=0 +lon_0=174.45 +k=1 +x_0=6400000 +y_0=-6212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 87, зона 7":"+title= МСК-87 зона 7 (6 градусная) Чукотский автономный округ    +proj=tmerc +lat_0=0 +lon_0=180.45 +k=1 +x_0=7400000 +y_0=-6212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","МСК 87, зона 8":"+title= МСК-87 зона 8 (6 градусная) Чукотский автономный округ    +proj=tmerc +lat_0=0 +lon_0=186.45 +k=1 +x_0=8400000 +y_0=-6212900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район C, зона 1":"+title= СК-1963 район C зона 1    +proj=tmerc +lat_0=0 +lon_0=24.95 +k=1 +x_0=1250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район C, зона 2":"+title= СК-1963 район C зона 2    +proj=tmerc +lat_0=0 +lon_0=27.95 +k=1 +x_0=2250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район C, зона 3":"+title= СК-1963 район C зона 3    +proj=tmerc +lat_0=0 +lon_0=30.95 +k=1 +x_0=3250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район C, зона 4":"+title= СК-1963 район C зона 4    +proj=tmerc +lat_0=0 +lon_0=33.95 +k=1 +x_0=4250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район C, зона 5":"+title= СК-1963 район C зона 5    +proj=tmerc +lat_0=0 +lon_0=36.95 +k=1 +x_0=5250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район C, зона 6":"+title= СК-1963 район C зона 6    +proj=tmerc +lat_0=0 +lon_0=39.95 +k=1 +x_0=6250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 1":"+title= СК-1963 район D зона 1    +proj=tmerc +lat_0=0 +lon_0=38.55 +k=1 +x_0=1250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 2":"+title= СК-1963 район D зона 2    +proj=tmerc +lat_0=0 +lon_0=41.55 +k=1 +x_0=2250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 3":"+title= СК-1963 район D зона 3    +proj=tmerc +lat_0=0 +lon_0=44.55 +k=1 +x_0=3250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 4":"+title= СК-1963 район D зона 4    +proj=tmerc +lat_0=0 +lon_0=47.55 +k=1 +x_0=4250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 5":"+title= СК-1963 район D зона 5    +proj=tmerc +lat_0=0 +lon_0=50.55 +k=1 +x_0=5250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 6":"+title= СК-1963 район D зона 6    +proj=tmerc +lat_0=0 +lon_0=53.55 +k=1 +x_0=6250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 7":"+title= СК-1963 район D зона 7    +proj=tmerc +lat_0=0 +lon_0=56.55 +k=1 +x_0=7250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район D, зона 8":"+title= СК-1963 район D зона 8    +proj=tmerc +lat_0=0 +lon_0=59.55 +k=1 +x_0=8250000 +y_0=-14743.504 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район F, зона 1":"+title= СК-1963 район F зона 1    +proj=tmerc +lat_0=0 +lon_0=97.033333333333 +k=1 +x_0=1250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район F, зона 2":"+title= СК-1963 район F зона 2    +proj=tmerc +lat_0=0 +lon_0=100.033333333333 +k=1 +x_0=2250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район F, зона 3":"+title= СК-1963 район F зона 3    +proj=tmerc +lat_0=0 +lon_0=103.033333333333 +k=1 +x_0=3250000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 1":"+title= СК-1963 район G зона 1    +proj=tmerc +lat_0=0 +lon_0=121.71666666667 +k=1 +x_0=1300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 2":"+title= СК-1963 район G зона 2    +proj=tmerc +lat_0=0 +lon_0=124.71666666667 +k=1 +x_0=2300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 3":"+title= СК-1963 район G зона 3    +proj=tmerc +lat_0=0 +lon_0=127.71666666667 +k=1 +x_0=3300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 4":"+title= СК-1963 район G зона 4    +proj=tmerc +lat_0=0 +lon_0=130.71666666667 +k=1 +x_0=4300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 5":"+title= СК-1963 район G зона 5    +proj=tmerc +lat_0=0 +lon_0=133.71666666667 +k=1 +x_0=5300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 6":"+title= СК-1963 район G зона 6    +proj=tmerc +lat_0=0 +lon_0=136.71666666667 +k=1 +x_0=6300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 7":"+title= СК-1963 район G зона 7    +proj=tmerc +lat_0=0 +lon_0=139.71666666667 +k=1 +x_0=7300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 8":"+title= СК-1963 район G зона 8    +proj=tmerc +lat_0=0 +lon_0=142.71666666667 +k=1 +x_0=8300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район G, зона 9":"+title= СК-1963 район G зона 9    +proj=tmerc +lat_0=0 +lon_0=145.71666666667 +k=1 +x_0=9300000 +y_0=-16586.44 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район I, зона 1":"+title= СК-1963 район I зона 1    +proj=tmerc +lat_0=0 +lon_0=71.73333333333 +k=1 +x_0=1250000 +y_0=-12900.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район I, зона 2":"+title= СК-1963 район I зона 2    +proj=tmerc +lat_0=0 +lon_0=74.73333333333 +k=1 +x_0=2250000 +y_0=-12900.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район I, зона 3":"+title= СК-1963 район I зона 3    +proj=tmerc +lat_0=0 +lon_0=77.73333333333 +k=1 +x_0=3250000 +y_0=-12900.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район I, зона 4":"+title= СК-1963 район I зона 4    +proj=tmerc +lat_0=0 +lon_0=80.73333333333 +k=1 +x_0=4250000 +y_0=-12900.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район I, зона 5":"+title= СК-1963 район I зона 5    +proj=tmerc +lat_0=0 +lon_0=83.73333333333 +k=1 +x_0=5250000 +y_0=-12900.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район I, зона 6":"+title= СК-1963 район I зона 6    +proj=tmerc +lat_0=0 +lon_0=86.73333333333 +k=1 +x_0=6250000 +y_0=-12900.60 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район L, зона 1":"+title= СК-1963 район L зона 1 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=81.51666666667 +k=1 +x_0=1500000 +y_0=-16586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район L, зона 2":"+title= СК-1963 район L зона 2 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=87.51666666667 +k=1 +x_0=2500000 +y_0=-16586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район L, зона 3":"+title= СК-1963 район L зона 3 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=93.51666666667 +k=1 +x_0=3500000 +y_0=-16586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район L, зона 4":"+title= СК-1963 район L зона 4 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=99.51666666667 +k=1 +x_0=4500000 +y_0=-16586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район L, зона 5":"+title= СК-1963 район L зона 5 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=105.51666666667 +k=1 +x_0=5500000 +y_0=-16586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район L, зона 6":"+title= СК-1963 район L зона 6 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=111.51666666667 +k=1 +x_0=6500000 +y_0=-16586.442 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район M, зона 1":"+title= СК-1963 район M зона 1    +proj=tmerc +lat_0=0 +lon_0=79.466666666677 +k=1 +x_0=1300000 +y_0=-12900.57 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район M, зона 2":"+title= СК-1963 район M зона 2    +proj=tmerc +lat_0=0 +lon_0=82.466666666677 +k=1 +x_0=2300000 +y_0=-12900.57 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район M, зона 3":"+title= СК-1963 район M зона 3    +proj=tmerc +lat_0=0 +lon_0=85.466666666677 +k=1 +x_0=3300000 +y_0=-12900.57 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район M, зона 4":"+title= СК-1963 район M зона 4    +proj=tmerc +lat_0=0 +lon_0=88.466666666677 +k=1 +x_0=4300000 +y_0=-12900.57 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район P, зона 1":"+title= СК-1963 район P зона 1    +proj=tmerc +lat_0=0 +lon_0=32.48333333333 +k=1 +x_0=1250000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район P, зона 2":"+title= СК-1963 район P зона 2    +proj=tmerc +lat_0=0 +lon_0=35.48333333333 +k=1 +x_0=2250000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район P, зона 3":"+title= СК-1963 район P зона 3    +proj=tmerc +lat_0=0 +lon_0=38.48333333333 +k=1 +x_0=3250000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район P, зона 4":"+title= СК-1963 район P зона 4    +proj=tmerc +lat_0=0 +lon_0=41.48333333333 +k=1 +x_0=4250000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район Q, зона 1":"+title= СК-1963 район Q зона 1 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=32.03333333333 +k=1 +x_0=1400000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район Q, зона 2":"+title= СК-1963 район Q зона 2 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=38.03333333333 +k=1 +x_0=2400000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район Q, зона 3":"+title= СК-1963 район Q зона 3 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=44.03333333333 +k=1 +x_0=3400000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район Q, зона 4":"+title= СК-1963 район Q зона 4 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=50.03333333333 +k=1 +x_0=4400000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район Q, зона 5":"+title= СК-1963 район Q зона 5 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=56.03333333333 +k=1 +x_0=5400000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район R, зона 1":"+title= СК-1963 район R зона 1    +proj=tmerc +lat_0=0 +lon_0=43.05 +k=1 +x_0=1300000 +y_0=-14743.501 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район R, зона 2":"+title= СК-1963 район R зона 2    +proj=tmerc +lat_0=0 +lon_0=46.05 +k=1 +x_0=2300000 +y_0=-14743.501 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район R, зона 3":"+title= СК-1963 район R зона 3    +proj=tmerc +lat_0=0 +lon_0=49.05 +k=1 +x_0=3300000 +y_0=-14743.501 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 1":"+title= СК-1963 район S зона 1 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=108.45 +k=1 +x_0=1400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 2":"+title= СК-1963 район S зона 2 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=114.45 +k=1 +x_0=2400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 3":"+title= СК-1963 район S зона 3 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=120.45 +k=1 +x_0=3400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 4":"+title= СК-1963 район S зона 4 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=126.45 +k=1 +x_0=4400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 5":"+title= СК-1963 район S зона 5 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=132.45 +k=1 +x_0=5400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 6":"+title= СК-1963 район S зона 6 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=138.45 +k=1 +x_0=6400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs",
"СК-1963 район S, зона 7":"+title= СК-1963 район S зона 7 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=144.45 +k=1 +x_0=7400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 8":"+title= СК-1963 район S зона 8 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=150.45 +k=1 +x_0=8400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 9":"+title= СК-1963 район S зона 9 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=156.45 +k=1 +x_0=9400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 10":"+title= СК-1963 район S зона 10 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=162.45 +k=1 +x_0=10400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 11":"+title= СК-1963 район S зона 11 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=168.45 +k=1 +x_0=11400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 12":"+title= СК-1963 район S зона 12 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=174.45 +k=1 +x_0=12400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район S, зона 13":"+title= СК-1963 район S зона 13 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=180.45 +k=1 +x_0=13400000 +y_0=-12900.566 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район T, зона 1":"+title= СК-1963 район T зона 1    +proj=tmerc +lat_0=0 +lon_0=37.98333333333 +k=1 +x_0=1300000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район T, зона 2":"+title= СК-1963 район T зона 2    +proj=tmerc +lat_0=0 +lon_0=40.98333333333 +k=1 +x_0=2300000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район T, зона 3":"+title= СК-1963 район T зона 3    +proj=tmerc +lat_0=0 +lon_0=43.98333333333 +k=1 +x_0=3300000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район T, зона 4":"+title= СК-1963 район T зона 4    +proj=tmerc +lat_0=0 +lon_0=46.98333333333 +k=1 +x_0=4300000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район V, зона 1":"+title= СК-1963 район V зона 1    +proj=tmerc +lat_0=0 +lon_0=49.03333333333 +k=1 +x_0=1300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район V, зона 2":"+title= СК-1963 район V зона 2    +proj=tmerc +lat_0=0 +lon_0=52.03333333333 +k=1 +x_0=2300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район V, зона 3":"+title= СК-1963 район V зона 3    +proj=tmerc +lat_0=0 +lon_0=55.03333333333 +k=1 +x_0=3300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район V, зона 4":"+title= СК-1963 район V зона 4    +proj=tmerc +lat_0=0 +lon_0=58.03333333333 +k=1 +x_0=4300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район V, зона 5":"+title= СК-1963 район V зона 5    +proj=tmerc +lat_0=0 +lon_0=61.03333333333 +k=1 +x_0=5300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район V, зона 6":"+title= СК-1963 район V зона 6    +proj=tmerc +lat_0=0 +lon_0=64.03333333333 +k=1 +x_0=6300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район W, зона 1":"+title= СК-1963 район W зона 1 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=60.05 +k=1 +x_0=1500000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район W, зона 2":"+title= СК-1963 район W зона 2 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=66.05 +k=1 +x_0=2500000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район W, зона 3":"+title= СК-1963 район W зона 3 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=72.05 +k=1 +x_0=3500000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район W, зона 4":"+title= СК-1963 район W зона 4 (6-ти градусная)    +proj=tmerc +lat_0=0 +lon_0=78.05 +k=1 +x_0=4500000 +y_0=-11057.628 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район X, зона 1":"+title= СК-1963 район X зона 1    +proj=tmerc +lat_0=0 +lon_0=23.05 +k=1 +x_0=1300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район X, зона 2":"+title= СК-1963 район X зона 2    +proj=tmerc +lat_0=0 +lon_0=26.05 +k=1 +x_0=2300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район X, зона 3":"+title= СК-1963 район X зона 3    +proj=tmerc +lat_0=0 +lon_0=29.05 +k=1 +x_0=3300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район X, зона 4":"+title= СК-1963 район X зона 4    +proj=tmerc +lat_0=0 +lon_0=32.05 +k=1 +x_0=4300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район X, зона 5":"+title= СК-1963 район X зона 5    +proj=tmerc +lat_0=0 +lon_0=35.05 +k=1 +x_0=5300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","СК-1963 район X, зона 6":"+title= СК-1963 район X зона 6    +proj=tmerc +lat_0=0 +lon_0=38.05 +k=1 +x_0=6300000 +y_0=-9414.70 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 2":"+title= Пулково 1942 зона 2 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=9 +k=1 +x_0=2500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 3":"+title= Пулково 1942 зона 3 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=15 +k=1 +x_0=3500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 4":"+title= Пулково 1942 зона 4 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=21 +k=1 +x_0=4500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 5":"+title= Пулково 1942 зона 5 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=27 +k=1 +x_0=5500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 6":"+title= Пулково 1942 зона 6 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=33 +k=1 +x_0=6500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 7":"+title= Пулково 1942 зона 7 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=39 +k=1 +x_0=7500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 8":"+title= Пулково 1942 зона 8 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=45 +k=1 +x_0=8500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 9":"+title= Пулково 1942 зона 9 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=51 +k=1 +x_0=9500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 10":"+title= Пулково 1942 зона 10 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=57 +k=1 +x_0=10500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 11":"+title= Пулково 1942 зона 11 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=63 +k=1 +x_0=11500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 12":"+title= Пулково 1942 зона 12 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=69 +k=1 +x_0=12500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 13":"+title= Пулково 1942 зона 13 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=75 +k=1 +x_0=13500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 14":"+title= Пулково 1942 зона 14 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=81 +k=1 +x_0=14500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 15":"+title= Пулково 1942 зона 15 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=87 +k=1 +x_0=15500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 16":"+title= Пулково 1942 зона 16 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=93 +k=1 +x_0=16500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 17":"+title= Пулково 1942 зона 17 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=99 +k=1 +x_0=17500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 18":"+title= Пулково 1942 зона 18 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=105 +k=1 +x_0=18500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 19":"+title= Пулково 1942 зона 19 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=111 +k=1 +x_0=19500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 20":"+title= Пулково 1942 зона 20 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=117 +k=1 +x_0=20500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 21":"+title= Пулково 1942 зона 21 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=123 +k=1 +x_0=21500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 22":"+title= Пулково 1942 зона 22 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=129 +k=1 +x_0=22500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 23":"+title= Пулково 1942 зона 23 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=135 +k=1 +x_0=23500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 24":"+title= Пулково 1942 зона 24 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=141 +k=1 +x_0=24500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 25":"+title= Пулково 1942 зона 25 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=147 +k=1 +x_0=25500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 26":"+title= Пулково 1942 зона 26 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=153 +k=1 +x_0=26500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 27":"+title= Пулково 1942 зона 27 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=159 +k=1 +x_0=27500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 28":"+title= Пулково 1942 зона 28 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=165 +k=1 +x_0=28500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 29":"+title= Пулково 1942 зона 29 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=171 +k=1 +x_0=29500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Пулково 1942, зона 30":"+title= Пулково 1942 зона 30 ГОСТ 51794-2008   +proj=tmerc +lat_0=0 +lon_0=177 +k=1 +x_0=30500000 +y_0=0 +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +units=m +no_defs","Pulkovo 1942":"+title= Pulkovo 1942    +proj=longlat +ellps=krass +towgs84=23.92,-141.27,-80.9,-0,0.35,0.82,-0.12 +no_defs","Pulkovo 1942 ГОСТ 51794-2008":"+title= Pulkovo 1942 ГОСТ 51794-2008    +proj=longlat +ellps=krass +towgs84=23.57,-140.95,-79.8,0,0.35,0.79,-0.22 +no_defs","ПЗ-90":"+title= ПЗ-90    +proj=longlat +a=6378136 +b=6356751.361745712 +towgs84=0,0,1.5,-0,-0,0.076,0 +no_defs"},childKeys:["OMSPoints","ObjectsRealty","Parcels","Zones"],skipKeys:{EntitySpatial:!0,CoordSystems:!0,SpatialData:!0}};a.childKeys.forEach(function(b){a.skipKeys[b]=!0}),window.CAD=window.CAD||{},window.CAD.DEFAULTS=a}(),MapExpress.Mapping.RasterUtils={generateWldFileHref:function(a,b,c){var d;d=c?[c.project(a[0]),c.project(a[1])]:[L.CRS.EPSG3857.project(a[0]),L.CRS.EPSG3857.project(a[1])];var e=this.getPixelSizeXY(d,b),f=this.getOPointXY(d);if(e&&f){var g=[e.x,0,0,e.y,f.x,f.y].toString();return"data:text/plain;charset=utf-8,"+encodeURIComponent(g.replace(new RegExp(",","g"),"\r\n"))}},getPixelSizeXY:function(a,b){var c={};return c.x=(a[1].x-a[0].x)/b.width,c.y=-(a[1].y-a[0].y)/b.height,c},getOPointXY:function(a){var b={};return b.x=a[0].x,b.y=a[1].y,b},generateMapInfoWldFileHref:function(a,b,c,d,e){function f(a){return a.toString().replace(" ","")}var g,h,i="!Table  !version 300  !charset Neutral    Definition Table___",j=i.replace(new RegExp("  ","g"),"\r\n");void 0===c&&(c="Export.jpg");var k,l;if(d){var m=L.latLng(a[1].lat,a[0].lng),n=L.latLng(a[0].lat,a[1].lng),o=L.latLng(a[0].lat,a[0].lng),p=L.latLng(a[1].lat,a[1].lng);l=[d.project(m),d.project(n),d.project(o),d.project(p)]}else k=[L.CRS.EPSG3857.project(a[0]),L.CRS.EPSG3857.project(a[1])],l=[{x:k[0].x,y:k[1].y},{x:k[1].x,y:k[0].y},k[0],k[1]];var q=';;File;"'+c+'",.,;;Type;"RASTER",.,;;('+l[0].x+",;"+l[0].y+');(0,0);Label;"Point;1",,.,;;('+l[1].x+",;"+l[1].y+");("+b.width+",;"+b.height+');Label;"Point;2",,.,;;('+l[2].x+",;"+l[2].y+");(0,;"+b.height+');Label;"Point;3",,.,;;('+l[3].x+",;"+l[3].y+");("+b.width+',;0);Label;"Point;4"___',r=q.replace(new RegExp(",.,","g"),"\r\n").replace(new RegExp(";","g")," ");if(d)if("EPSG:3857"===d.code)g='CoordSys Earth Projection 10, 157, "m", 0___',h='Units "m"___';else if("EPSG:3395"===d.code)g='CoordSys Earth Projection 1, 157, "m", 0___',h='Units "m"___';else if("EPSG:4326"===d.code)g="CoordSys Earth Projection 1, 104___",h='Units "degree"___';else{for(var s,t=d.projection._proj.defData.split("+"),u=0;u<t.length;u++)t[u].indexOf("towgs84")!==-1&&(s=t[u].split(","));var v="3";d.projection._proj.ellps&&"bessel"===d.projection._proj.ellps&&(v="10"),h='Units "m"___';try{g="CoordSys Earth Projection 8, 9999, "+v+", "+f(s[0].split("=")[1])+", "+f(s[1])+", "+f(s[2])+", "+f(s[3])+", "+f(-s[4])+", "+f(-s[5])+", "+f(s[6])+", 0, 7,"+57.29577951308231*d.projection._proj.long0+", "+d.projection._proj.lat0+", "+d.projection._proj.k0+", "+d.projection._proj.x0+", "+d.projection._proj.y0+"___"}catch(a){g='CoordSys Earth Projection 10, 157, "m", 0___',h='Units "m"___'}}else g='CoordSys Earth Projection 10, 157, "m", 0___',h='Units "m"___';if(void 0!==r){var w="";return w=e?j+r+'CoordSys Nonearth Units "m" Bounds ( -100000000, -100000000) ( 100000000, 100000000)___':j+r+g+h,"data:text/plain;charset=utf-8,"+encodeURIComponent(w.replace(new RegExp("___","g"),"\r\n"))}}},MapExpress.Mapping.GeoUtil={lineStringLength:function(a){for(var b=0,c=a._latlngs.length,d=1;d<c;d++)b+=a._latlngs[d].distanceTo(a._latlngs[d-1]);return b},lineStringContainsPoint:function(a,b){var c,d,e,f,g,h,i=window.MapManager._map.containerPointToLayerPoint(window.MapManager._map.latLngToContainerPoint(b));if(!a._parts)return!1;for(c=0,f=a._parts.length;c<f;c++)for(h=a._parts[c],d=0,g=h.length,e=g-1;d<g;e=d++)if(L.LineUtil.pointToSegmentDistance(i,h[e],h[d])<=5)return!0;return!1},circleMarkerContainsPoint:function(a,b){var c=window.MapManager._map.containerPointToLayerPoint(window.MapManager._map.latLngToContainerPoint(b));return a._containsPoint(c)},belongsSegment:function(a,b,c,d){d=void 0===d?.2:d;var e=b.distanceTo(c),f=b.distanceTo(a)+a.distanceTo(c)-e;return f/e<d},findIntersectedLayersByBBox:function(a,b,c){this.map=c;var d=[],e=this;return a.eachLayer(function(a){var c=e._findIntersectedEachLayerByBBox(a,b);"within"!==c&&"overlaps"!==c||d.push(a)}),d},_findIntersectedEachLayerByBBox:function(a,b){var c,d,e;e=this._reFormBboxCords(b),d=a.feature.geometry,"Point"===d.type?c=this._isSinglePointInsideBBox(d.coordinates,e):"LineString"===d.type?c=this._isMultiPointInsideBBox(d.coordinates,e):"Polygon"===d.type?c=this._isMultiPointInsideBBox(d.coordinates[0],e):"MultiPoint"===d.type?c=this._isMultiPointInsideBBox(d.coordinates,e):"MultiLineString"===d.type?c=this._isMultiPointInsideBBox(d.coordinates,e):"MultiPolygon"===d.type&&(c=this._isMultiPointInsideBBox(d.coordinates[0],e));var f=this._intersectionByBBoxParseResult(c);if("no intersects"===f&&"Point"!==d.type&&"MultiPoint"!==d.type){var g={type:"Polygon",coordinates:[e]},h=this._crossCheck(g,a);h.length>0&&(f="overlaps")}return("no intersects"===f&&"Polygon"===d.type||"no intersects"===f&&"MultiPoint"===d.type)&&(f=this._intersectionByBBoxParseResult(this._isMultiPointInsideBBox(e,d.coordinates[0]))),f},_reFormBboxCords:function(a){var b=[];return a._southWest&&(b[0]=[a._southWest.lng,a._northEast.lat],b[1]=[a._northEast.lng,a._northEast.lat],b[2]=[a._northEast.lng,a._southWest.lat],b[3]=[a._southWest.lng,a._southWest.lat]),b},_isSinglePointInsideBBox:function(a,b){return this._pointIntersectionMath(a,b)},_isMultiPointInsideBBox:function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(this._pointIntersectionMath(a[d],b));return c},_pointIntersectionMath:function(a,b){for(var c=a[0],d=a[1],e=!1,f=0,g=b.length-1;f<b.length;g=f++){var h=b[f][0],i=b[f][1],j=b[g][0],k=b[g][1],l=i>d!=k>d&&c<(j-h)*(d-i)/(k-i)+h;l&&(e=!e)}return e},_intersectionByBBoxParseResult:function(a){return a===!0&&"boolean"==typeof a?"within":a===!1&&"boolean"==typeof a?"no intersects":a.constructor===Array?(a.sort(),a[0]===a[a.length-1]&&a[0]===!0?"within":a[0]===a[a.length-1]&&a[0]===!1?"no intersects":"overlaps"):void 0},_crossCheck:function(a,b){var c=b.toGeoJSON(),d=this._lineify(a),e=this._lineify(c),f=[];if(d&&e)for(var g in e.geometries)for(var h in d.geometries){var i=this._lineStringsIntersect(e.geometries[g],d.geometries[h]);if(i)for(var j in i)f.push(i[j])}return f},_lineify:function(a){var b,c={type:"GeometryCollection",geometries:[]};switch(a.type){case"GeometryCollection":for(var d in a.geometries)if(b=this._lineify(a.geometries[d]))for(var e in b.geometries)c.geometries.push(b.geometries[e]);else c=!1;break;case"Feature":if(b=this._lineify(a.geometry))for(var f in b.geometries)c.geometries.push(b.geometries[f]);else c=!1;break;case"FeatureCollection":for(var g in a.features)if(b=this._lineify(a.features[g].geometry))for(var h in b.geometries)c.geometries.push(b.geometries[h]);else c=!1;break;case"LineString":c.geometries.push(a);break;case"MultiLineString":case"Polygon":for(var i in a.coordinates)c.geometries.push({type:"LineString",coordinates:a.coordinates[i]});break;case"MultiPolygon":for(var j in a.coordinates)for(var k in a.coordinates[j])c.geometries.push({type:"LineString",coordinates:a.coordinates[j][k]});break;default:c=!1}return c},_lineStringsIntersect:function(a,b){for(var c=[],d=0;d<=a.coordinates.length-2;++d)for(var e=0;e<=b.coordinates.length-2;++e){var f=L.latLng(a.coordinates[d][1],a.coordinates[d][0]),g=L.latLng(a.coordinates[d+1][1],a.coordinates[d+1][0]),h=L.latLng(b.coordinates[e][1],b.coordinates[e][0]),i=L.latLng(b.coordinates[e+1][1],b.coordinates[e+1][0]),j=L.Projection.SphericalMercator.project(f),k=L.Projection.SphericalMercator.project(g),l=L.Projection.SphericalMercator.project(h),m=L.Projection.SphericalMercator.project(i),n=(m.x-l.x)*(j.y-l.y)-(m.y-l.y)*(j.x-l.x),o=(k.x-j.x)*(j.y-l.y)-(k.y-j.y)*(j.x-l.x),p=(m.y-l.y)*(k.x-j.x)-(m.x-l.x)*(k.y-j.y);if(0!==p){var q=n/p,r=o/p;if(0<=q&&q<=1&&0<=r&&r<=1){var s=j.x+q*(k.x-j.x),t=j.y+q*(k.y-j.y),u={x:s,y:t},v=L.Projection.SphericalMercator.unproject(u);c.push({intersection:new L.LatLng(v.lat,v.lng)})}}}return 0===c.length&&(c=!1),c},findIntersectedLayerByCircle:function(a,b,c,d){this.map=d;var e=[],f=this;return a.eachLayer(function(a){var d=f.findIntersectedEachLayerByCircle(b,c,a);"within"!==d&&"overlaps"!==d||e.push(a)}),e},_findIntersectedEachLayerByCircle:function(a,b,c){var d,e;e=c.feature.geometry;var f;if("Point"===e.type?d=this._isSinglePointInsideCircle(e.coordinates,a,b):"LineString"===e.type?d=this._isMultiPointInsideCircle(e.coordinates,a,b):"Polygon"===e.type?d=this._isMultiPointInsideCircle(e.coordinates[0],a,b):"MultiPoint"===e.type?d=this._isMultiPointInsideCircle(e.coordinates,a,b):"MultiLineString"===e.type?d=this._isMultiPointInsideCircle(e.coordinates,a,b):"MultiPolygon"===e.type&&(d=this._isMultiPointInsideCircle(e.coordinates[0],a,b)),f=this.parseResult(d),"no intersects"===f&&"Point"!==e.type){var g=this._circleCrossCheck(a,b,c);f=this._intersectionByCircleParseResult(g)}return f},_isSinglePointInsideCircle:function(a,b,c){var d=new L.LatLng(b[0],b[1]),e=d.distanceTo(new L.LatLng(a[1],a[0]));return e<c},_isMultiPointInsideCircle:function(a,b,c){for(var d=[],e=0;e<a.length;e++)d.push(this._isSinglePointInsideCircle(a[e],b,c));return d},_circleCrossCheck:function(a,b,c){var d=c.toGeoJSON(),e=this._lineify(d),f=[];if(a&&b&&e)for(var g=0;g<=e.geometries[0].coordinates.length-2;g++){var h=L.latLng(e.geometries[0].coordinates[g][1],e.geometries[0].coordinates[g][0]),i=L.latLng(e.geometries[0].coordinates[g+1][1],e.geometries[0].coordinates[g+1][0]),j=L.latLng(a[0],a[1]);f.push(this._getIntersectionsMathABCR(h,i,j,b).intersects)}return f},_getIntersectionsMathABCR:function(a,b,c,d){var e=this.map.getMaxZoom();e===1/0&&(e=this.map.getZoom());var f=this.map.project(c,e),g=this.map.project(a,e),h=this.map.project(b,e),i=L.LineUtil.closestPointOnSegment(f,g,h),j=this.map.unproject(f,e).distanceTo(this.map.unproject(i,e));if(j<d){var k=g.distanceTo(h,e),l=f.distanceTo(i,e),m=[(h.x-g.x)/k,(h.y-g.y)/k],n=m[0]*(f.x-g.x)+m[1]*(f.y-g.y),o=Math.sqrt(Math.pow(l/j*d,2)-Math.pow(l,2)),p={},q={};return p.x=(n-o)*m[0]+g.x,p.y=(n-o)*m[1]+g.y,q.x=(n+o)*m[0]+g.x,q.y=(n+o)*m[1]+g.y,{intersects:!0,nearestPoint:this.map.unproject(i,e),intersection1:this.map.unproject(new L.Point(p.x,p.y),e),intersection2:this.map.unproject(new L.Point(q.x,q.y),e)}}return j===d?{intersects:!0,nearestPoint:this.map.unproject(i,e),intersection1:this.map.unproject(i,e)}:{intersects:!1}},_intersectionByCircleParseResult:function(a){return a===!0&&"boolean"==typeof a?"within":a===!1&&"boolean"==typeof a?"no intersects":a.constructor===Array?(a.sort(),a[0]===a[a.length-1]&&a[0]===!0?"overlaps":a[0]===a[a.length-1]&&a[0]===!1?"no intersects":"overlaps"):void 0},getGeoJSONFeatureSelfIntersects:function(a){function b(a,b,c,d,e,f,g,h){var i,j,k,l,m,n={x:null,y:null,onLine1:!1,onLine2:!1};return i=(h-f)*(c-a)-(g-e)*(d-b),0===i?null!==n.x&&null!==n.y&&n:(j=b-f,k=a-e,l=(g-e)*j-(h-f)*k,m=(c-a)*j-(d-b)*k,j=l/i,k=m/i,n.x=a+j*(c-a),n.y=b+j*(d-b),j>=0&&j<=1&&(n.onLine1=!0),k>=0&&k<=1&&(n.onLine2=!0),!(!n.onLine1||!n.onLine2)&&[n.x,n.y])}var c,d,e=[];if(d="Feature"===a.type?a.geometry:a,"LineString"===d.type)c=[d.coordinates];else if("MultiLineString"===d.type)c=d.coordinates;else if("MultiPolygon"===d.type)c=[].concat.apply([],d.coordinates);else{if("Polygon"!==d.type)throw new Error("Не допустимый тип геометрии");c=d.coordinates}return c.forEach(function(a){c.forEach(function(c){for(var d=0;d<a.length-1;d++)for(var f=0;f<c.length-1;f++)if(a!==c||1!==Math.abs(d-f)&&Math.abs(d-f)!==a.length-2){var g=b(a[d][0],a[d][1],a[d+1][0],a[d+1][1],c[f][0],c[f][1],c[f+1][0],c[f+1][1]);if(g){for(var h=!1,i=e.length-1;i>=0;i--)e[i][0]===g[0]&&e[i][1]===g[1]&&(h=!0);h||e.push([g[0],g[1]])}}})}),e},isGeoJSONFeatureSelfIntersects:function(a){var b=this.getGeoJSONFeatureSelfIntersects(a);return!!b.length}},MapExpress.Search.BaseSearchProvider=L.Class.extend({initialize:function(a,b){this.map=a,this.name=b},getName:function(a){return this.name},getDataByMask:function(a){},getDataByMaskAsynch:function(a){},processResult:function(a,b){function c(){this.resultLayer&&(MapManager._map.removeLayer(this.resultLayer),delete this.resultLayer)}if(c.call(this),"Point"===(a.geojson||a.geometry).type){b={iconSize:[12,12],color:"blue"};var d=[];d[0]=(a.geojson||a.geometry).coordinates[1],d[1]=(a.geojson||a.geometry).coordinates[0],this.map.setView(d,17),this.resultLayer=MapManager.addPulseMarker(d,5e3,b)}else{var e=b.drawStyleOptions;this.resultLayer=L.geoJson(a.geojson||a.geometry,{style:e}).addTo(this.map),this.map.fitBounds(this.resultLayer.getBounds())}this.map.getZoom()>20&&this.map.setZoom(19),window.setTimeout(c.bind(this),5e3)}}),MapExpress.Search.GeojsonSearchProvider=MapExpress.Search.BaseSearchProvider.extend({initialize:function(a,b,c){MapExpress.Search.BaseSearchProvider.prototype.initialize.call(this,a,b),this.geojsonLayer=c.layer,this.attributeKey=c.attributeKey},getDataByMaskAsynch:function(a){function b(b,c){if(b.feature.properties[c].toString().toLowerCase().indexOf(a.toString().toLowerCase())>-1){b.feature.display_name=b.feature.properties[c],b.feature.geojson=b.feature.geometry,b.feature.leafletId=b._leaflet_id;for(var e=d.length-1;e>=0;e--)if(d[e].leafletId===b._leaflet_id)return;d.push(b.feature)}}var c=$.Deferred(),d=[],e=this;return setTimeout(function(){e.geojsonLayer.eachLayer(function(a){if("[object Array]"===Object.prototype.toString.call(e.attributeKey))for(var c=0;c<e.attributeKey.length;c++)a.feature.properties[e.attributeKey[c]]&&b.call(e,a,e.attributeKey[c]);else if(void 0===e.attributeKey)for(var d in a.feature.properties)a.feature.properties[d]&&b.call(e,a,d);else b.call(e,a,e.attributeKey)}),c.resolve(d)},0),c.promise()}}),MapExpress.Search.GoogleSearchProvider=MapExpress.Search.BaseSearchProvider.extend({initialize:function(a,b){MapExpress.Search.BaseSearchProvider.prototype.initialize.call(this,a,b)},getDataByMaskAsynch:function(a){function b(){function b(a){return Object.keys(a.geometry.location).map(function(b){return a.geometry.location[b]}).reverse()}var d={address:a+"%",language:"ru",region:"ru",limit:24},e=[];$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?",type:"GET",data:d,async:!1,dataType:"json",success:function(a){if(a.results.length>0){for(var d=0;d<a.results.length;d++)e.push({id:a.results[d].index,display_name:a.results[d].formatted_address,type:"Feature",geojson:{type:"Point",coordinates:b(a.results[d])},properties:{addresscomponents:a.results[d].addresscomponents,bounds:a.results[d].geometry.bounds,viewport:a.results[d].geometry.viewport,types:a.results[d].types,place_id:a.results[d].place_id}});c.resolve(e)}else c.resolve([])},error:function(a){c.reject(" Failed: "+a)}})}var c=$.Deferred();return b(),c.promise()}}),MapExpress.Search.OsmSearchProvider=MapExpress.Search.BaseSearchProvider.extend({initialize:function(a,b){MapExpress.Search.BaseSearchProvider.prototype.initialize.call(this,a,b)},getDataByMaskAsynch:function(a){function b(){var b={q:a+"%",format:"json",limit:15,addressdetails:1,polygon_geojson:1};$.ajax({url:"http://nominatim.openstreetmap.org/search.php?",type:"GET",data:b,dataType:"json",success:function(a){c.resolve(a)},error:function(a){c.reject(" Failed: "+a)}})}var c=$.Deferred();return b(),c.promise()}}),MapExpress.Search.YandexSearchProvider=MapExpress.Search.BaseSearchProvider.extend({initialize:function(a,b){MapExpress.Search.BaseSearchProvider.prototype.initialize.call(this,a,b)},getDataByMaskAsynch:function(a){function b(){var b={geocode:a+"%",format:"json",results:24},d=[];$.ajax({url:"https://geocode-maps.yandex.ru/1.x/?",type:"GET",data:b,async:!1,dataType:"json",success:function(a){if(a.response.GeoObjectCollection.featureMember.length>0){for(var b=0;b<a.response.GeoObjectCollection.featureMember.length;b++)d.push({id:a.response.GeoObjectCollection.featureMember[b].index,display_name:a.response.GeoObjectCollection.featureMember[b].GeoObject.metaDataProperty.GeocoderMetaData.text,type:"Feature",geojson:{type:"Point",coordinates:a.response.GeoObjectCollection.featureMember[b].GeoObject.Point.pos.split(" ")},properties:{bounds:a.response.GeoObjectCollection.featureMember[b].GeoObject.boundedBy.Envelope,descr:a.response.GeoObjectCollection.featureMember[b].GeoObject.description,metaData:a.response.GeoObjectCollection.featureMember[b].GeoObject.metaDataProperty.GeocoderMetaData,names:a.response.GeoObjectCollection.featureMember[b].GeoObject.name}});c.resolve(d)}else c.resolve([])},error:function(a){c.reject(" Failed: "+a)}})}var c=$.Deferred();return b(),c.promise()}}),MapExpress.Service.BaseDataProvider=L.Class.extend({statics:{},options:{tileSize:256,subdomains:"abc",useQuadkey:!1,maxZoom:23,uppercase:!1,crs:L.CRS.EPSG3857,proj4:!1,crsCode:!1,identifyFormat:"json",identifyLayersId:""},initialize:function(a){"string"==typeof this.options.subdomains&&(this.options.subdomains=this.options.subdomains.split("")),L.setOptions(this,a),this.options.proj4!==!1&&this.options.crsCode!==!1&&"string"==typeof this.options.proj4&&"string"==typeof this.options.crsCode&&this.options.proj4.length>0&&this.options.crsCode.length>0&&(this.options.crs=new L.Proj.CRS(this.options.crsCode,this.options.proj4))},setOptions:function(a){L.setOptions(this,a)},getDataAsync:function(){},getDataUrl:function(){},getDataInBoundsAsync:function(a,b){},getDataUrlByBounds:function(a,b){if(this._dataUrl&&a){var c=a.getNorthWest(),d=a.getSouthEast(),e=L.Util.template(this._dataUrl,{xMin:c.lng,yMin:d.lat,xMax:d.lng,yMax:c.lat});return e}},getDataUrlByTile:function(a){if(this._dataUrl)return this.options.useQuadkey?L.Util.template(this._dataUrl,L.extend({r:this.options.tileCoord&&L.Browser.retina&&this.options.maxZoom>0?"@2x":"",s:this._getSubdomain(a),q:this._tileCoordsToQuadkey(a)},this.options)):L.Util.template(this._dataUrl,L.extend({r:this.options.tileCoord&&L.Browser.retina&&this.options.maxZoom>0?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:a.z},this.options))},getFeatureInfoAsync:function(a,b,c,d,e){var f=this.getFeatureInfoUrl(a,b,c,d,e);if(f)return"json"===this.options.identifyFormat||"pjson"===this.options.identifyFormat?MapExpress.Utils.Promise.GetJSON(f):MapExpress.Utils.Promise.Ajax(f)},getFeatureInfoUrl:function(a,b,c,d,e){},_tileCoordToBounds:function(a){var b=this.options.tileSize,c=L.CRS.EPSG3857,d=new L.Point(a.x*b,a.y*b),e=new L.Point(d.x+b,d.y+b),f=c.pointToLatLng(d,a.z),g=c.pointToLatLng(e,a.z),h=c.wrapLatLng(f),i=c.wrapLatLng(g);return new L.LatLngBounds(h,i)},_getTileCoordRangeByMapBounds:function(a,b){var c=[];if(void 0===a)return c;for(var d=a.getNorthWest(),e=a.getSouthEast(),f=this._getTileCoordByLatLng(d,b),g=this._getTileCoordByLatLng(e,b),h=f.y;h<=g.y;h++)for(var i=f.x;i<=g.x;i++){var j=new L.Point(i,h);j.z=b,c.push(j)}return c},_getAddedTileCoordRangeByMapBounds:function(a,b,c,d){return this._getAddedAndRemovedTileCoordRangeByMapBounds(a,b,c,d).Added},_getRemovedTileCoordRangeByMapBounds:function(a,b,c,d){return this._getAddedAndRemovedTileCoordRangeByMapBounds(a,b,c,d).Removed},_getAddedAndRemovedTileCoordRangeByMapBounds:function(a,b,c,d){var e={},f=function(a,b){for(var c=0;c<a.length;c++)if(a[c].x===b.x&&a[c].y===b.y&&a[c].z===b.z)return!0;return!1},g=this._getTileCoordRangeByMapBounds(c,d),h=this._getTileCoordRangeByMapBounds(a,b);if(b!==d)return e.Added=g,e.Removed=h,e;var i=g.filter(function(a){return!f(h,a)}),j=h.filter(function(a){return!f(g,a)});return e.Added=i,e.Removed=j,e},_getTileCoordByLatLng:function(a,b){var c=(this.options.tileSize,L.CRS.EPSG3857),d=c.latLngToPoint(a,b);return this._pixelPointToTileCoord(d,b)},_pixelPointToTileCoord:function(a,b){var c=this.options.tileSize,d=Math.ceil(a.x/c)-1,e=Math.ceil(a.y/c)-1,f=new L.Point(d,e);return f.z=b,f},_tileCoordsToQuadkey:function(a){for(var b="",c=a.z;c>0;c--){var d=0,e=1<<c-1;0!==(a.x&e)&&d++,0!==(a.y&e)&&(d++,d++),b+=d}return b},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_getSubdomain:function(a){var b=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[b];
},_boundsEquals:function(a,b,c){var d=b.getNorthEast(),e=a.getNorthEast(),f=a.getSouthWest(),g=b.getSouthWest(),h=Math.max(Math.abs(e.lat-d.lat),Math.abs(e.lng-d.lng)),i=Math.max(Math.abs(f.lat-g.lat),Math.abs(f.lng-g.lng)),j=h<=(void 0===c?0:c),k=i<=(void 0===c?0:c);return j&&k},identifyTemplate:function(){if(this.options.templateId&&this.options.templateUrl&&"string"==typeof this.options.templateId&&"string"==typeof this.options.templateUrl){var a=this;return MapExpress.Utils.Promise.Ajax(a.options.templateUrl,{id:a.options.templateId})}return null}}),MapExpress.Service.baseDataProvider=function(a){return new MapExpress.Service.BaseDataProvider(a)},MapExpress.Service.EsriBaseProvider=MapExpress.Service.BaseDataProvider.extend({options:{tileSize:256,crs:L.CRS.EPSG3857,identifyUrl:"",identifyFormat:"json",identifyTolerance:5,layersId:""},initialize:function(a,b){MapExpress.Service.BaseDataProvider.prototype.initialize.call(this,b),this._dataUrl=a,L.setOptions(this,b),this.esriConvertor=MapExpress.Utils.GeoFormatConvertor.esri},getDataByTileAsync:function(a){var b=this._tileCoordToBounds(a),c=new L.Point(this.options.tileSize,this.options.tileSize);return this.getDataInBoundsAsync(b,c)},getDataUrlByTile:function(a){var b=this._tileCoordToBounds(a),c=new L.Point(this.options.tileSize,this.options.tileSize);return this.getDataUrlByBounds(b,c)},getFeatureInfoAsync:function(a,b,c,d,e){var f=this.getFeatureInfoUrl(a,b,c,d,e),g=this;if(f)return"json"===this.options.identifyFormat||"pjson"===this.options.identifyFormat?MapExpress.Utils.Promise.GetJSON(f).then(function(a){var b=g.esriConvertor.toGeoJSON(a);return b}):MapExpress.Utils.Promise.Ajax(f)},getFeatureInfoUrl:function(a,b,c,d,e){var f=null;this.options.identifyLayersId&&(f="visible:"+this.options.identifyLayersId),f||this.options.layersId&&(f="visible:"+this.options.layersId),f||(f="top");var g={geometryType:"esriGeometryPoint",sr:"4326",layers:f,tolerance:this.options.identifyTolerance,imageDisplay:[d.x,d.y,"96"].join(","),returnGeometry:!1,f:this.options.identifyFormat,geometry:[a.lng,a.lat].join(","),mapExtent:[c._northEast.lng,c._northEast.lat,c._southWest.lng,c._southWest.lat].join(",")},h=this.options.uppercase||!1,i=this.options.identifyUrl?this.options.identifyUrl:this._dataUrl;return i+"/identify"+L.Util.getParamString(g,i,h)}}),MapExpress.Service.esriBaseProvider=function(a,b){return new MapExpress.Service.EsriBaseProvider(a,b)},MapExpress.Service.FeatureServiceAgsProvider=MapExpress.Service.EsriBaseProvider.extend({defaultFeatureServiceParams:{where:"",text:"",objectIds:"",time:"",geometryType:"esriGeometryEnvelope",inSR:"",spatialRel:"esriSpatialRelIntersects",relationParam:"",outFields:"*",returnGeometry:!0,maxAllowableOffset:"",geometryPrecision:"",returnIdsOnly:!1,orderByFields:"",groupByFieldsForStatistics:"",outStatistics:"",returnZ:!1,returnM:!1,gdbVersion:"",returnDistinctValues:!1,f:"json"},options:{layerId:""},initialize:function(a,b){MapExpress.Service.EsriBaseProvider.prototype.initialize.call(this,b),this._dataUrl=a,this.esriConverter=MapExpress.Utils.GeoFormatConvertor.esri;var c=L.extend({},this.defaultFeatureServiceParams);for(var d in b)d in this.options||(c[d]=b[d]);L.setOptions(this,b),this.defaultFeatureServiceParams=c},getDataInBoundsAsync:function(a,b){var c=this,d=this.getDataUrlByBounds(a,b);return MapExpress.Utils.Promise.GetJSON(d).then(function(a){if(a)return c.esriConverter.toGeoJSON(a)})},getDataUrlByBounds:function(a,b){var c=this.options.crs,d=c.project(a.getNorthWest()),e=c.project(a.getSouthEast()),f={};f.inSR=c.code,f.outSR="4326",f.geometry=L.Util.template("{xmin: {0}, ymin: {1}, xmax: {2}, ymax: {3}}",{0:d.x,1:e.y,2:e.x,3:d.y}),L.extend(this.defaultFeatureServiceParams,f);var g=this.options.uppercase||!1,h=L.Util.getParamString(this.defaultFeatureServiceParams,this._dataUrl,g);return this._dataUrl+"/"+this.options.layerId+"/query"+h}}),MapExpress.Service.featureServiceAgsProvider=function(a,b){return new MapExpress.Service.FeatureServiceAgsProvider(a,b)},MapExpress.Service.GeoJSONProvider=MapExpress.Service.BaseDataProvider.extend({options:{identifyFormat:"json"},initialize:function(a,b){MapExpress.Service.BaseDataProvider.prototype.initialize.call(this,b),L.setOptions(this,b),this._dataUrl=a},getDataAsync:function(){return MapExpress.Utils.Promise.GetJSON(this._dataUrl)},getDataInBoundsAsync:function(a,b){var c=this.getDataUrlByBounds(a,b);return MapExpress.Utils.Promise.GetJSON(c)},getDataByTileAsync:function(a){var b=this.getDataUrlByTile(a);return MapExpress.Utils.Promise.GetJSON(b)},getDataUrlByTile:function(a){var b=this._tileCoordToBounds(a),c=new L.Point(this.options.tileSize,this.options.tileSize);return this.getDataUrlByBounds(b,c)}}),MapExpress.Service.geoJSONProvider=function(a,b){return new MapExpress.Service.GeoJSONProvider(a,b)},MapExpress.Service.MapServiceAgsProvider=MapExpress.Service.EsriBaseProvider.extend({defaultParams:{bboxSR:3857,imageSR:3857,dpi:96,f:"image",format:"png32",transparent:!0},initialize:function(a,b){MapExpress.Service.EsriBaseProvider.prototype.initialize.call(this,b),this._dataUrl=a;var c=L.extend({},this.defaultParams);for(var d in b)d in this.options||(c[d]=b[d]);L.setOptions(this,b),this.mapServiceParams=c},getDataUrlByBounds:function(a,b){var c=this.options.crs,d=c.project(a.getNorthWest()),e=c.project(a.getSouthEast()),f={};f.bbox=[d.x,e.y,e.x,d.y].join(","),f.size=[b.x,b.y].join(","),this.options.layersId&&(f.layers="show:"+this.options.layersId),L.extend(this.mapServiceParams,f);var g=this.options.uppercase||!1,h=L.Util.getParamString(this.mapServiceParams,this._url,g);return this._dataUrl+"/export"+h}}),MapExpress.Service.mapServiceAgsProvider=function(a,b){return new MapExpress.Service.MapServiceAgsProvider(a,b)},MapExpress.Service.SingleImageProvider=MapExpress.Service.BaseDataProvider.extend({initialize:function(a,b){MapExpress.Service.BaseDataProvider.prototype.initialize.call(this,b),L.setOptions(this,b),this._dataUrl=a},getDataUrl:function(){return this._dataUrl},getImageBounds:function(){return this.options.imageBounds}}),MapExpress.Service.singleImageProvider=function(a,b){return new MapExpress.Service.SingleImageProvider(a,b)},MapExpress.Service.TileProvider=MapExpress.Service.BaseDataProvider.extend({initialize:function(a,b){MapExpress.Service.BaseDataProvider.prototype.initialize.call(this,b),L.setOptions(this,b),this._dataUrl=a}}),MapExpress.Service.tileProvider=function(a,b){return new MapExpress.Service.TileProvider(a,b)},MapExpress.Service.WFSProvider=MapExpress.Service.BaseDataProvider.extend({defaultWFSProviderParams:{service:"WFS",version:"1.1.0",typeNS:"gml",request:"GetFeature",outputFormat:"gml3",crs:L.CRS.EPSG4326},options:{},initialize:function(a,b){MapExpress.Service.BaseDataProvider.prototype.initialize.call(this,b),this._dataUrl=a,this.gmlConverter=MapExpress.Utils.GeoFormatConvertor.gml();var c=this.defaultWFSProviderParams;for(var d in b)c[d]=b[d];switch(c.srsName=c.crs.code,c.typeName=c.typeNS+":"+c.typeName,c.gml){case"gml2":c.outputFormat="outputFormat:text/xml; subtype=gml/2.1.2";break;case"gml3":c.outputFormat="gml3";break;case"gml3.2":c.outputFormat="application/gml+xml; version=3.2";break;default:c.outputFormat="gml3"}this.unionWFSProviderParams=c,delete this.unionWFSProviderParams.crs,delete this.unionWFSProviderParams.typeNS},getDataAsync:function(){var a=this;return MapExpress.Utils.Promise.Ajax(this.getDataUrl()).then(function(b){return a.gmlConverter.toGeoJSON(b,a.unionWFSProviderParams.gml)})},getDataUrl:function(){var a=L.Util.getParamString(this.unionWFSProviderParams,this._dataUrl);return this._dataUrl+a},getDataInBoundsAsync:function(a,b){var c=this;return MapExpress.Utils.Promise.Ajax(this.getDataUrlByBounds(a,b)).then(function(a){return c.gmlConverter.toGeoJSON(a,c.unionWFSProviderParams.gml)})},getDataUrlByBounds:function(a,b){var c=a.getNorthEast(),d=a.getSouthWest(),e=a.getNorthWest(),f=a.getSouthEast(),g={};"1.0.0"!==this.unionWFSProviderParams.version?g.bbox=[d.lat,d.lng,c.lat,c.lng].toString():g.bbox=[e.lng,f.lat,f.lng,e.lat].toString(),L.extend(this.unionWFSProviderParams,g);var h=this.options.uppercase||!1,i=L.Util.getParamString(this.unionWFSProviderParams,this._dataUrl,h);return this._dataUrl+i},getDataByTileAsync:function(a){var b=this._tileCoordToBounds(a),c=new L.Point(this.options.tileSize,this.options.tileSize);return this.getDataInBoundsAsync(b,c)},_getDataAsync:function(){var a=this;return MapExpress.Utils.Promise.WFSAjax(this._dataUrl,this._queryXMLString()).then(function(b){return a.gmlConverter.toGeoJSON(b,a.unionWFSProviderParams.gml)})},_getDataInBoundsAsync:function(a){var b=this;return console.log(b),MapExpress.Utils.Promise.WFSAjax(this._dataUrl,this._queryXMLString(this._bboxXMLFilter(a,b.unionWFSProviderParams.geometryAttributeName))).then(function(a){return b.gmlConverter.toGeoJSON(a,b.unionWFSProviderParams.gml)})},_bboxXMLFilter:function(a,b){console.log(b);var c=this.gmlConverter.createElementNS("ogc:Filter"),d=this.gmlConverter.createElementNS("ogc:BBOX");return d.appendChild(this.gmlConverter.createElementNS("ogc:PropertyName",{value:b})),d.appendChild(this._latLngBoundsToGML(a,this.unionWFSProviderParams.srsName)),c.appendChild(d),c},_latLngBoundsToGML:function(a,b){var c=a.getSouthWest(),d=a.getNorthEast(),e=this.gmlConverter.createElementNS("gml:Envelope",{srsName:b});return e.appendChild(this.gmlConverter.createElementNS("gml:lowerCorner",{},{value:c.lat+" "+c.lng})),e.appendChild(this.gmlConverter.createElementNS("gml:upperCorner",{},{value:d.lat+" "+d.lng})),e},_queryXMLString:function(a){var b=this.gmlConverter.createElementNS("wfs:GetFeature",{service:"WFS",version:this.unionWFSProviderParams.version,maxFeatures:this.unionWFSProviderParams.maxFeatures,outputFormat:"text/xml"}),c=b.appendChild(this.gmlConverter.createElementNS("wfs:Query",{typeName:this.unionWFSProviderParams.typeName,srsName:this.unionWFSProviderParams.srsName}));return a&&c.appendChild(a),b}}),MapExpress.Service.wfsProvider=function(a,b){return new MapExpress.Service.WFSProvider(a,b)},MapExpress.Service.WmsProvider=MapExpress.Service.BaseDataProvider.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.3.0",layers:"",styles:"",format:"image/png",transparent:!0,dpi:96},initialize:function(a,b){MapExpress.Service.BaseDataProvider.prototype.initialize.call(this,b),this._dataUrl=a;var c=L.extend({},this.defaultWmsParams);for(var d in b)d in c&&(c[d]=b[d]);b=L.setOptions(this,b),c.width=c.height=b.tileSize*(b.detectRetina&&L.Browser.retina?2:1),this.wmsParams=c},getDataByTileAsync:function(a){var b=this._tileCoordToBounds(a),c=new L.Point(this.options.tileSize,this.options.tileSize);return this.getDataInBoundsAsync(b,c)},getDataUrlByBounds:function(a,b){var c=parseFloat(this.wmsParams.version),d=this.options.crs,e=c>=1.3?"crs":"srs",f=d.project(a.getNorthWest()),g=d.project(a.getSouthEast()),h={width:b.x,height:b.y};h[e]=d.code,h.bbox=(c>=1.3&&d===L.CRS.EPSG4326?[g.y,f.x,f.y,g.x]:[f.x,g.y,g.x,f.y]).join(","),L.extend(this.wmsParams,h);var i=this.options.uppercase||!1,j=L.Util.getParamString(this.wmsParams,this._dataUrl,i);return this._dataUrl+j},getDataUrlByTile:function(a){var b=this._tileCoordToBounds(a),c=new L.Point(this.options.tileSize,this.options.tileSize);return this.getDataUrlByBounds(b,c)},getFeatureInfoUrl:function(a,b,c,d,e){var f=parseFloat(this.wmsParams.version),g=this.options.crs,h=this.options.identifyLayersId?this.options.identifyLayersId:this.wmsParams.layers,i=(this.options.featureCount||1,g.project(c.getNorthWest())),j=g.project(c.getSouthEast()),k={request:"GetFeatureInfo",service:"WMS",version:this.wmsParams.version,height:d.y,width:d.x,layers:h,query_layers:h,info_format:this.options.identifyFormat},l=f>=1.3?"crs":"srs";k[l]=g.code,k.bbox=(f>=1.3&&g===L.CRS.EPSG4326?[j.y,i.x,i.y,j.x]:[i.x,j.y,j.x,i.y]).join(","),k[f>=1.3?"i":"x"]=b.x,k[f>=1.3?"j":"y"]=b.y;var m=this.options.uppercase||!1;return this._dataUrl+L.Util.getParamString(k,this._url,m)}}),MapExpress.Service.wmsProvider=function(a,b){return new MapExpress.Service.WmsProvider(a,b)},MapExpress.Styles.PulseIcon=L.DivIcon.extend({options:{className:"",iconSize:[12,12],color:"red"},initialize:function(a){L.setOptions(this,a),L.DivIcon.prototype.initialize.call(this,a)},setStyle:function(a){L.setOptions(this,a);var b="lpi-"+(new Date).getTime()+"-"+Math.round(1e5*Math.random());this.options.className=this.options.className+" leaflet-pulsing-icon "+b;var c="."+b+"{background-color:"+this.options.color+";}";c+="."+b+":after{box-shadow: 0 0 6px 2px "+this.options.color+";}";var d=document.createElement("style");d.styleSheet?d.styleSheet.cssText=c:d.appendChild(document.createTextNode(c)),document.getElementsByTagName("head")[0].appendChild(d)}}),MapExpress.Styles.PulseMarker=L.Marker.extend({statics:{PULSE_ICON:new MapExpress.Styles.PulseIcon},initialize:function(a,b){b||(b={}),MapExpress.Styles.PulseMarker.PULSE_ICON.setStyle(b),b.icon=MapExpress.Styles.PulseMarker.PULSE_ICON,L.Marker.prototype.initialize.call(this,a,b)}}),MapExpress.Styles.StyleDivIcon=L.DivIcon.extend({options:{style:"width:8px;height:8px;border-radius:50%;border-width:1px;border-style: solid;border-color:black;margin-left:-4px;margin-top:-4px;",className:"mapexpress-empty-marker-style"},createIcon:function(a){var b=L.DivIcon.prototype.createIcon.call(this,a);return this._styleDivIcon=b,this.options.id&&(b.id=this.options.id),this.options.style&&this.setStyle(this.options.style),b},setStyle:function(a){this.options.style=a,MapExpress.Controls.MapControlUtils.setStyle(this._styleDivIcon,this.options.style)}}),MapExpress.Styles.StyleMarker=L.Marker.extend({initialize:function(a,b){b||(b={}),b.icon=new MapExpress.Styles.StyleDivIcon(b),L.Marker.prototype.initialize.call(this,a,b)},setDivStyle:function(a){a&&this.options.icon&&this.options.icon instanceof MapExpress.Styles.StyleDivIcon&&this.options.icon.setStyle(a)}}),MapExpress.Tools.BaseMapCommand=L.Class.extend({_active:!1,options:{},initialize:function(a,b){this._mapManager=a,L.setOptions(this,b)},createContent:function(a){},activate:function(){},deactivate:function(){}}),MapExpress.Tools.ButtonBaseMapCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",imageSrc:"",title:"",id:""},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src",this.options.imageSrc),b.setAttribute("title",this.options.title),b.setAttribute("id",this.options.id),b}}),MapExpress.Tools.BufferLineStringCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",title:"Создание буфферной зоны линиии",bufferZoneStart:50,bufferZoneRange:{min:.5,max:500},bufferZoneStep:.5},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/rulers.png"),b.setAttribute("title","Создание буфферной зоны линиии"),b.setAttribute("id","BufferLineStringCommand"),b},activate:function(){function a(a){function b(a){return!isNaN(Number(a))}var c=a.val(),e=!0;return b(c)||(console.warn("Значение должно быть числовое"),a.val(1),e=!1),(Number(c)>d.noUiSlider.options.range.max||Number(c)<d.noUiSlider.options.range.min)&&(console.warn("Значение должно быть в заданном диапазоне слайдера"),Number(c)>d.noUiSlider.options.range.max&&a.val(d.noUiSlider.options.range.max),Number(c)<d.noUiSlider.options.range.min&&a.val(d.noUiSlider.options.range.min)),!!e||(a.val(1),!1)}this.bufferable&&(this.bufferable.abortDrawing(),delete this.bufferable),this.bufferable=new MapExpress.Utils.BufferEditor(this._mapManager._map).startPolyline();var b=this;$(document).keydown(function(a){27===a.keyCode&&b.bufferable&&(b.bufferable.removeDrawing(),delete b.bufferable)}),this.form&&(this.form.hide(),delete this.form),this.form=new MapExpress.Controls.MapControl(this._mapManager._map,{titleText:"Буфферная зона",position:"bottomRight"});var c='<div style="min-width:240px;">\t<div id="mapexpress-slider-plate">\t\t<a>Буферная зона (м)</a>\t<div id="mapexpress-slider-connect"></div>  \t<input type="number" id="mapexpress-buffer-distance-input" class="mapexpress-buffer-distance" placeholder="Дистанция буферной зоны (м)"> </input>\t</div></div>';this.form.setContent(c),this.form.show();var d=document.getElementById("mapexpress-slider-connect");window.noUiSlider.create(d,{start:b.options.bufferZoneStart||50,connect:"lower",range:{min:b.options.bufferZoneRange.min||.5,max:b.options.bufferZoneRange.max||500},step:b.options.bufferZoneStep||.5}),b.bufferable.setDistance(d.noUiSlider.get(),!1),$("#mapexpress-buffer-distance-input").val(b.options.bufferZoneStart||50),d.noUiSlider.on("slide",function(a){b.bufferable.setDistance(Number(a[0]),!0),$("#mapexpress-buffer-distance-input").val(Number(a[0]))}),$("#mapexpress-buffer-distance-input").on("input",function(c){a($(c.target))&&(d.noUiSlider.set(Number($(c.target).val())),b.bufferable.setDistance(d.noUiSlider.get(),!0))}),$(this.form._controlContent).css("overflow-y","auto"),$(this.form._controlContent).css("max-height",Number($(this.form._controlContent).parent().css("max-height").replace("px",""))-32+"px"),L.DomEvent.on(this.form._closeButton,"click",function(){b.bufferable&&(b.bufferable.removeDrawing(),delete b.bufferable)})},clearCommandAndControl:function(){this.bufferable&&(this.bufferable.removeDrawing(),delete this.bufferable,this._mapManager._map.bufferTools&&delete this._mapManager._map.bufferTools),this.form&&(this.form.hide(),delete this.form)}}),MapExpress.Controls.OkCancelDialogCustomNotHide=MapExpress.Controls.OkCancelDialog.extend({initialize:function(a,b){this._map=a,L.setOptions(this,b),this._initLayout(),this._initButtonGroup(),MapExpress.Controls.MapControlUtils.addClassName(this._controlContent,"mapexpress-control-content_notify")},_initButtonGroup:function(){var a=L.DomUtil.create("div","mapexpress-control-footerbar__buttongroup",this._controlFooterBar);this.okButton=L.DomUtil.create("button","mapexpress-control-footerbar__buttongroup__button",a),this.okButton.setAttribute("id","okbutton");var b=L.DomUtil.create("span","mapexpress-control-footerbar__buttongroup__button__text",this.okButton);b.textContent=this.options.okButtonText,MapExpress.Controls.MapControlUtils.stopMousePropagation(this.okButton),this.cancelButton=L.DomUtil.create("button","mapexpress-control-footerbar__buttongroup__button cancel",a),this.cancelButton.setAttribute("id","cancelbutton");var c=L.DomUtil.create("span","mapexpress-control-footerbar__buttongroup__button__text",this.cancelButton);c.textContent=this.options.cancelButtonText,MapExpress.Controls.MapControlUtils.stopMousePropagation(this.cancelButton)}}),MapExpress.Tools.CoordinatesRunnerCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",id:"GeomCoordsEditCommand",title:"Переход к координатам",imageSrc:"images/legend.png"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src",this.options.imageSrc),c.style.width="24px",c.style.height="24px",b.setAttribute("title",this.options.title),b.setAttribute("id",this.options.id),b},activate:function(a){this.activeCoordsType="ddmmss",this._initOkCancelDialog()},deactivate:function(){this.OkCancelDialog&&this.OkCancelDialog.hide()},_initOkCancelDialog:function(){var a=this,b='<div style="min-width:372px;">    <div class="mapexpress-coordinates-runner-wrapper">        <div class="mapexpress-coordinates-runner__coordinates-types">            <label class="mapexpress-coordinates-runner__radio-wrapper">\t\t\t\t<input id="ddmmss" class="mapexpress-coordinates-runner__radio" name="coordinatestype" type="radio" value="ddmmss" checked></input>\t\t\t\t<span></span>\t\t\t\tГрадусы, минуты, секунды\t\t\t</label>            <label class="mapexpress-coordinates-runner__radio-wrapper">\t\t\t\t<input id="dec" class="mapexpress-coordinates-runner__radio" name="coordinatestype" type="radio" value="dec"></input>\t\t\t\t<span></span>\t\t\t\tДесятичные градусы\t\t\t\t</label>        <div>    </div>    <div class="mapexpress-coordinates-runner__coordinates">        <div class="mapexpress-coordinates-runner_wrapper">            <label class="mapexpress-coordinates-runner-latlng__label">Широта</label>            <div class="mapexpress-coordinates-runner__latlng">                <div class="coordinates-runner__wrapper_degrees"><input class="coordinates-runner__inputs lat-inputs__degrees"></input></div>                <div class="coordinates-runner__wrapper_minutes"><input class="coordinates-runner__inputs lat-inputs__minutes"></input></div>                <div class="coordinates-runner__wrapper_seconds"><input class="coordinates-runner__inputs lat-inputs__seconds"></input></div>            </div>        </div>        <div class="mapexpress-coordinates-runner_wrapper">            <label class="mapexpress-coordinates-runner-latlng__label">Долгота</label>            <div class="mapexpress-coordinates-runner__latlng">                <div class="coordinates-runner__wrapper_degrees"><input class="coordinates-runner__inputs lng-inputs__degrees"></input></div>                <div class="coordinates-runner__wrapper_minutes"><input class="coordinates-runner__inputs lng-inputs__minutes"></input></div>                <div class="coordinates-runner__wrapper_seconds"><input class="coordinates-runner__inputs lng-inputs__seconds"></input></div>            </div>        </div>    </div></div>';this.OkCancelDialog=new MapExpress.Controls.OkCancelDialogCustomNotHide(window.MapManager._map,{closeButtonEnabled:!0,modal:!1,footerEnabled:!0,headerEnabled:!0,position:"right",okButtonText:"Перейти",cancelButtonText:"Отмена"}).setTitle(this.options.title).setContent(b).show(),$(".mapexpress-coordinates-runner__radio").on("change",function(b){a.changeCoords(),a.activeCoordsType=b.target.id,$(".coordinates-runner__wrapper_seconds").toggle(),$(".coordinates-runner__wrapper_minutes").toggle(),$(".coordinates-runner__inputs").toggleClass("dec_hidden")}),this.OkCancelDialog.onOK(this.onOK,this),this.OkCancelDialog.onCancel(this.onCancel,this),this._onOKDialogShow(),this._validateInputs()},_validateInputs:function(){function a(a){function b(a){return!isNaN(Number(a))}var c=$(a.target).val();b(c)||"-"===c||$(a.target).val(0)}function b(a){var b=Number($(a.target).val());b>=90&&($(a.target).val(90),$(".lat-inputs__minutes").val(0),$(".lat-inputs__seconds").val(0)),b<=-90&&($(a.target).val(-90),$(".lat-inputs__minutes").val(0),$(".lat-inputs__seconds").val(0))}function c(a){if("-"!==$(a.target).val()){var b=Number($(a.target).val());b>=180&&($(a.target).val(180),$(".lng-inputs__minutes").val(0),$(".lng-inputs__seconds").val(0)),b<=-180&&($(a.target).val(-180),$(".lng-inputs__minutes").val(0),$(".lng-inputs__seconds").val(0))}}function d(a){var d=Number($(a.target).val());d>59&&$(a.target).val(59),d<0&&$(a.target).val(0),c({target:$(".lng-inputs__degrees")[0]}),b({target:$(".lat-inputs__degrees")[0]})}$(".coordinates-runner__inputs").on("input",a),$(".lat-inputs__degrees").on("input",b),$(".lng-inputs__degrees").on("input",c),$(".lat-inputs__minutes").on("input",d),$(".lng-inputs__minutes").on("input",d),$(".lat-inputs__seconds").on("input",d),$(".lng-inputs__seconds").on("input",d)},_onOKDialogShow:function(){var a=this._mapManager._map.getCenter(),b=this._toDMS(a.lat),c=this._toDMS(a.lng);b.negative?($(".lat-inputs__degrees").val(b.d),$(".lat-inputs__degrees").val("-"+$(".lat-inputs__degrees").val())):$(".lat-inputs__degrees").val(b.d),c.negative?($(".lng-inputs__degrees").val(c.d),$(".lng-inputs__degrees").val("-"+$(".lng-inputs__degrees").val())):$(".lng-inputs__degrees").val(c.d),$(".lat-inputs__minutes").val(b.m),$(".lat-inputs__seconds").val(b.s),$(".lng-inputs__degrees").val(c.d),$(".lng-inputs__minutes").val(c.m),$(".lng-inputs__seconds").val(c.s)},_toDMS:function(a){var b=!1;Number(a)<0&&(b=!0);var c=Math.floor(Math.abs(a)),d=60*(Math.abs(a)-c),e=Math.floor(d),f=60*(d-e),g=Math.round(f);return 60===g&&(e++,g=0),60===e&&(c++,e=0),{d:c,m:e,s:g,negative:b}},_dmsToDec:function(a,b,c){var d;return d="-0"===a?-1:1,(Number(a)+b/60+c/3600).toFixed(10)*d},_collectData:function(){if("ddmmss"===this.activeCoordsType){var a=$(".lat-inputs__degrees").val(),b=$(".lng-inputs__degrees").val();return"-"===a&&(a=0,$(".lat-inputs__degrees").val(a)),"-"===b&&(b=0,$(".lng-inputs__degrees").val(b)),{latd:a,latm:$(".lat-inputs__minutes").val(),lats:$(".lat-inputs__seconds").val(),lngd:b,lngm:$(".lng-inputs__minutes").val(),lngs:$(".lng-inputs__seconds").val()}}if("dec"===this.activeCoordsType)return{latd:$(".lat-inputs__degrees").val(),lngd:$(".lng-inputs__degrees").val()}},_convertData:function(a){return"ddmmss"===this.activeCoordsType?{lat:this._dmsToDec(a.latd,Number(a.latm),Number(a.lats)),lng:this._dmsToDec(a.lngd,Number(a.lngm),Number(a.lngs))}:"dec"===this.activeCoordsType?{lat:this._toDMS(Number(a.latd)),lng:this._toDMS(Number(a.lngd))}:void 0},changeCoords:function(){var a=this._collectData(),b=this._convertData(a);"ddmmss"===this.activeCoordsType?($(".lat-inputs__degrees").val(b.lat),$(".lat-inputs__minutes").val(""),$(".lat-inputs__seconds").val(""),$(".lng-inputs__degrees").val(b.lng),$(".lng-inputs__minutes").val(""),$(".lng-inputs__seconds").val("")):"dec"===this.activeCoordsType&&(b.lng.negative?($(".lng-inputs__degrees").val(b.lng.d),$(".lng-inputs__degrees").val("-"+$(".lng-inputs__degrees").val())):$(".lng-inputs__degrees").val(b.lng.d),b.lat.negative?($(".lat-inputs__degrees").val(b.lat.d),$(".lat-inputs__degrees").val("-"+$(".lat-inputs__degrees").val())):$(".lat-inputs__degrees").val(b.lat.d),$(".lat-inputs__minutes").val(b.lat.m),$(".lat-inputs__seconds").val(b.lat.s),$(".lng-inputs__minutes").val(b.lng.m),$(".lng-inputs__seconds").val(b.lng.s))},onOK:function(a){var b,c,d=this._collectData();"ddmmss"===this.activeCoordsType?(b=Number(this._dmsToDec(d.latd,Number(d.latm),Number(d.lats))),c=Number(this._dmsToDec(d.lngd,Number(d.lngm),Number(d.lngs)))):"dec"===this.activeCoordsType&&(b=Number(d.latd),c=Number(d.lngd)),this._mapManager._map.setView([b,c],this._mapManager._map.getZoom()),this._mapManager.addPulseMarker(new L.latLng(b,c),3e3)},onCancel:function(){this.OkCancelDialog.hide()}}),MapExpress.Tools.FileLoaderAndShowAsLayerCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",title:"Загрузка файла"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/addlayer.png"),b.setAttribute("title","Загрузка файла"),b.setAttribute("id","FileLoaderAndShowAsLayerCommand"),b},activate:function(){var a=this;this.form&&(this.form.hide(),delete this.form),this.form=new MapExpress.Controls.MapControl(this._mapManager._map,{headerEnabled:!0,closeButtonEnabled:!0,position:"center"}),this.form.setTitle("Загрузка файлов"),this.form.on("mapcontrol:remove:before",function(a){}),this.createFileReader(),this.createOrUseAlreadyDefinedRootLayerGroupe(),a.form.show()},createFileReader:function(){function a(a){for(var b=0;b<a.length;b++)l.push(a[b])}function b(){h.val(""),$("#mapexpress-file-uploader-label").html("Файл не выбран"),l=[]}function c(){function a(){e||b()}function c(b){var c=new FileReader,g=b.name.split("."),h=g.pop().toLowerCase(),i=g.toString(),j=["csv","wkt","geojson","kml","gml","gpx","xml"];return j.indexOf(h)===-1?void d.showErrorMessage("Формат файла не поддерживается"):(c.onload=function(b){var c=d.showFilesAsLayers(b.target.result,h,i);if(c===!1&&d.showErrorMessage("Файл не может быть прочитан"),e--,!e&&c)try{var f=c.mapLayer.getBounds();window.MapManager._map.fitBounds(f)}catch(a){console.log(a)}a()},c.onerror=function(b){d.showErrorMessage("Файл не может быть прочитан"),e--,a()},void c.readAsText(l[f]))}for(var e=l.length,f=0;f<l.length;f++)c(l[f])}var d=this,e=$(this.form._controlContent),f=($('<div id="mapexpress-drag-and-drop-container"></div>'),$('<div id="mapexpress-drag-and-drop-zone">Для загрузки,перетащите файл сюда.<br />Форматы: GeoJSON, WKT, CSV, GML, KML, GPX</div>')),g=$('<div id="mapexpress-file-uploader-form"><button type="button" class="mapexpress-primary-button">Выбрать файл и отобразить</button></div>'),h=$('<input type="file" id="mapexpress-file-uploader" style="display:none;"></input>'),i=($('<div class="mapexpress-file-uploader-actions"></div>'),$('<button class="mapexpress-primary-button">Отобразить на карте</button>')),j=$('<button class="mapexpress-primary-button">Удалить файлы из формы</button>'),k=$('<label class="mapexpress-drag-and-drop-error-label"></label>');e.append(f),e.append(g),e.append(h),e.append(k);var l=[];g.on("click",function(a){a.stopPropagation(),$("#mapexpress-file-uploader").trigger("click")}),$("#mapexpress-file-uploader").bind({change:function(){a(this.files),c()}}),f.bind({dragenter:function(){return $(this).addClass("mapexpress-drag-and-drop-zone__highlighted"),!1},dragover:function(){return!1},dragleave:function(){return $(this).removeClass("mapexpress-drag-and-drop-zone__highlighted"),!1},drop:function(b){var d=b.originalEvent.dataTransfer;return a(d.files),c(),!1}}),j.on("click",function(){b()}),i.on("click",c())},showErrorMessage:function(a){$(".mapexpress-drag-and-drop-error-label").html(""),$(".mapexpress-drag-and-drop-error-label").html(a),setTimeout(function(){$("mapexpress-drag-and-drop-error-label").text("")},8e3)},createOrUseAlreadyDefinedRootLayerGroupe:function(){var a=window.MapManager.getMapModel().getLayersByOptionValue("displayName","Локальные слои");a&&a.length>0?this.rootGroupModel=a[0]:(this.rootGroupModel=new MapExpress.Mapping.LayerModel(this.layerGroupName,{displayName:"Локальные слои"}),window.MapManager.getMapModel().addLayer(this.rootGroupModel))},showFilesAsLayers:function(a,b,c){function d(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var e=this.checkFileExtentionAndConvert(a,b,c+"-"+d(),c);return!!e&&(window.MapManager.setLayerVisible(e.id,!0),e)},checkFileExtentionAndConvert:function(a,b,c,d){var e,f={csv:MapExpress.Utils.GeoFormatConvertor.csv,csvopts:{latfield:"y",lonfield:"x"},esri:MapExpress.Utils.GeoFormatConvertor.esri,wkt:MapExpress.Utils.GeoFormatConvertor.wkt,gml:new MapExpress.Utils.GeoFormatConvertor.GML,gmlopts:"gml2",gpx:new MapExpress.Utils.GeoFormatConvertor.GPX,kml:new MapExpress.Utils.GeoFormatConvertor.KML,xml:new MapExpress.Utils.GeoFormatConvertor.XML};if("geojson"===b)e=a;else try{e=f[b].toGeoJSON(a,f[b+"opts"]||void 0)}catch(a){return!1}var g;try{g=this.createGeoJsonLayer(e,d,c)}catch(b){console.log(b);try{e=f.esri.toGeoJSON(a),g=this.createGeoJsonLayer(e,d,c)}catch(a){return console.log(a),!1}}return g},createGeoJsonLayer:function(a,b,c,d){var e=new MapExpress.Service.GeoJSONProvider(""),f=new MapExpress.Layers.GeoJSONServiceLayer(e);f.options.queryable=!0,f.options.visibleIndex=1,f.options.maxZoom=24,f.options.minZoom=0,f.id=c,f.options.dynamicData=!1,f._singleDataLoaded=!0,"string"==typeof a?f._replaceData(JSON.parse(a)):f._replaceData(a);var g=new MapExpress.Mapping.LayerModel(c);return g.options.displayName=b,g.options.type="overlay",g.mapLayer=f,this.rootGroupModel.addLayer(g),d&&(g.mapLayer.styles=[d],f.on("mapexspress:layer:data:added",function(){f.setStyle(d)})),g}}),MapExpress.Tools.GeomCoordsEditCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",
templateUrl:"/templates/GeometryCoordinatesControl.html",templateId:"GeometryCoordinatesControl"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/legend.png"),c.style.width="24px",c.style.height="24px",b.setAttribute("title","Редактирование"),b.setAttribute("id","GeomCoordsEditCommand"),b},activate:function(a){console.log(a),this.GeometryCoordinatesEditControl&&(this.GeometryCoordinatesEditControl.clearControl(),delete this.GeometryCoordinatesEditControl),this.GeometryCoordinatesEditControl=new MapExpress.Controls.GeometryCoordinatesEdit(this._mapManager._map,{titleText:"Координаты и геометрия",headerEnabled:!0,footerEnabled:!1,closeButtonEnabled:!0,position:"right"},new MapExpress.GeomCoordsEditController(this._mapManager._map)),this.GeometryCoordinatesEditControl.show()},deactivate:function(){console.log(this)}}),MapExpress.Tools.IdentifyMapCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",templateUrl:"templates/layerInfo.html",templateId:"layerInfoTemplateId",templateHelpers:"layerInfoTemplateIdAfterRender",title:"Информация"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a);L.DomUtil.create("i","fa fa-info fa-lg fa-fw",b);return b.setAttribute("data-toggle","tooltip"),b.setAttribute("data-placement","bottom"),b.setAttribute("title","Информация"),b},activate:function(){this._active||(this._mapManager._map.on("click",this.doCommand,this),this._mapManager._map.doubleClickZoom.disable(),this._mapManager._map.on("dblclick",L.DomEvent.stop))},deactivate:function(){this._mapManager._map.off("click",this.doCommand,this),this._mapManager._map.doubleClickZoom.enable(),this._mapManager._map.off("dblclick",L.DomEvent.stop),this._deletePrevWindow()},_deletePrevWindow:function(){this.popupWindow&&(this.popupWindow.options.destroyOnClose=!0,this.popupWindow.destroy(),delete this.popupWindow),this._mapManager.identifyWindow&&delete this._mapManager.identifyWindow},doCommand:function(a){function b(a,b){return a.mapLayer instanceof MapExpress.Layers.GeoJSONServiceLayer&&!(b.mapLayer instanceof MapExpress.Layers.GeoJSONServiceLayer)?-1:b.mapLayer instanceof MapExpress.Layers.GeoJSONServiceLayer&&!(a.mapLayer instanceof MapExpress.Layers.GeoJSONServiceLayer)?1:0}if(L.DomEvent.stopPropagation(a),this._checkClickOnMapObject(a)){this._deletePrevWindow();var c=this,d=this._getQueryableLayers();d.sort(b);var e=this._mapManager._map,f=a.latlng,g=a.containerPoint,h=e.getZoom(),i=e.getBounds(),j=e.getSize(),k=0,l={};l.latlng=f,l.identifiedResults=[];for(var m=0;m<d.length;m++){var n=d[m],o=n.mapLayer._dataPovider;if(o){var p=o.getFeatureInfoAsync(f,g,i,j,h);if(!p&&n.mapLayer instanceof MapExpress.Layers.GeoJSONServiceLayer&&(p=n.mapLayer._getFeaturesAtPoint(f,a.layerPoint,i,j,h)),p){var q={};q.dataPromise=p,q.layerName=n.options.displayName,q.numberInList=k,q.afterRenderFeatureInfoContentCallback=o.afterRenderFeatureInfoContentCallback,o.identifyTemplate&&(q.templatePromise=o.identifyTemplate()),l.identifiedResults.push(q),k++}}}c._showInfo(l)}},_checkClickOnMapObject:function(a){return!(!a.originalEvent.target.nodeName||"path"!==a.originalEvent.target.nodeName)||!!(a.originalEvent.target.className&&a.originalEvent.target.className.indexOf&&a.originalEvent.target.className.indexOf("leaflet-container")>-1)},_getQueryableLayers:function(){for(var a=[],b=this._mapManager.getMapModel().getQueryableLayers(),c=b.length-1;c>=0;c--)this._mapManager.layerEnabled(b[c].id)&&a.push(b[c]);return a},_showInfo:function(a){function b(b){function d(){window.MapManager.fire("mapexpress:identifytool:beforewindowclose",c.popupWindow),window.MapManager.removeEventListener("mapexpress:identifytool:beforewindowclose")}c.popupWindow=new MapExpress.Controls.MapPopupControl(c._mapManager._map,{headerEnabled:!0,closeButtonEnabled:!0,className:"mapexpress-layer-info-control",resizeable:!0,controlId:"mapexpress-identify-control"}).setTitle("Информация в точке: "+a.latlng.toString()).setContent(b).setContentStyle({overflow:"hidden"}).show().setLatLngPosition(a.latlng).bringToFront(),c._mapManager.identifyWindow=c.popupWindow,(c.options.templateHelpers&&void 0!==c.options.templateHelpers||c.options.templateHelpers&&null!==c.options.templateHelpers)&&$.views.helpers[c.options.templateHelpers](a,c.options.templateUrl),window.MapManager.fire("mapexpress:identifytool:windowopened",c.popupWindow),c.popupWindow.on("mapcontrol:remove:before",d,c)}if(this._deletePrevWindow(),a&&0!==a.identifiedResults.length){this._mapManager.addPulseMarker(a.latlng,3e3);var c=this;return void 0===this.options.templateUrl||void 0===this.options.templateId?void new MapExpress.Controls.MapControl(window.MapManager._map,{removalDelay:3e3}).setContent("<b>Не задано представление</b>").show():void MapExpress.Controls.MapControlUtils.generateTemplate(this.options.templateUrl,this.options.templateId,a,b)}}}),MapExpress.Service.identifyMapCommand=function(a,b){return new MapExpress.Tools.IdentifyMapCommand(a,b)},MapExpress.Tools.LegendCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",templateUrl:"/templates/Legend.html",templateId:"legenableLayers"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/legend.png"),c.style.width="24px",c.style.height="24px",b.setAttribute("title","Легенда карты"),b.setAttribute("id","LegendCommand"),b},activate:function(){var a=this;this.form&&(this.form.hide(),delete this.form),this.legendControl=new MapExpress.Controls.LegendControl(this._mapManager),this.form=new MapExpress.Controls.MapControl(this._mapManager._map,{headerEnabled:!0,closeButtonEnabled:!0,position:"right"}),this.form.setTitle("Легенда карты"),this.form.on("mapcontrol:remove:before",function(b){a._mapManager.off("mapexspress:mapmanager:layer:visiblechanged",a.renderTemplate,a),a._mapManager._map.off("moveend",a.renderTemplate,a);for(var c=MapExpress.Utils.legendUtils.getAllLegends(),d=c.length-1;d>=0;d--){var e=window.MapManager.getMapModel().getLayerById(c[d].id);e.mapLayer.off("mapexspress:layer:data:added",a.renderTemplate,a)}}),this.renderTemplate(),this._mapManager.on("mapexspress:mapmanager:layer:visiblechanged",this.renderTemplate,this),this._mapManager._map.on("moveend",this.renderTemplate,this)},renderTemplate:function(a){function b(){c.form.show()}for(var c=this,d=MapExpress.Utils.legendUtils.getAllLegends(),e=d.length-1;e>=0;e--){var f=window.MapManager.getMapModel().getLayerById(d[e].id);f.mapLayer.on("mapexspress:layer:data:added",c.renderTemplate,c)}this.form.setContentFromTemplate(c.options.templateUrl,c.options.templateId,{legenableLayers:d},b)}}),MapExpress.Tools.MapToolbar=L.Control.extend({options:{position:"topleft",containerClassName:"map-toolbar"},divider:{createContent:function(a){return L.DomUtil.create("span","divider1",a)}},initialize:function(a,b){this._mapManager=a,L.setOptions(this,b),this._commands=[],window.MapManager._map.tempCommands||(window.MapManager._map.tempCommands=[])},onAdd:function(){return this._createContainer()},addTo:function(){L.Control.prototype.addTo.call(this,this._mapManager._map)},addCommand:function(a){return this._commands.push(a),this},addDivider:function(){},_createContainer:function(){this._container=L.DomUtil.create("div",this.options.containerClassName),this._container.style.padding="3px",this.panelBody=L.DomUtil.create("div","panel-body",this._container),this.panelBody.style.padding="3px";for(var a=0;a<this._commands.length;a++)this._createCommandContent(this._commands[a],this.panelBody),window.MapManager._map.tempCommands.push(this._commands[a]);return MapExpress.Controls.MapControlUtils.stopMousePropagation(this._container),this._container},_createCommandContent:function(a){var b=this,c=a.createContent(this.panelBody);return c.command=a,MapExpress.Controls.MapControlUtils.stopMousePropagation(c),L.DomEvent.addListener(c,"click",function(){b._activeCommand&&(b._activeCommand.deactivate(),b._activeCommand._active=!1),b._tempDeactivateAllCommands(),b._activeCommand=c.command,c.command.activate(),window.MapManager.fire("mapexpress:maptoolbar:command:activated",c.command),c.command._active=!0}),c},addControlFromTemplate:function(a,b,c,d){function e(a){var b=$(f.panelBody);b.append(a),d&&"function"==typeof d&&d()}var f=this;MapExpress.Controls.MapControlUtils.generateTemplate(a,b,c,e)},_tempDeactivateAllCommands:function(){if(window.MapManager._map.tempCommands)for(var a=0;a<window.MapManager._map.tempCommands.length;a++)window.MapManager._map.tempCommands[a].deactivate()}}),MapExpress.Tools.LineMeasureCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",title:"Измерение расстояний"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/rulers.png"),b.setAttribute("title","Измерение расстояний"),b.setAttribute("id","measureLenghtCommand"),b},activate:function(){this.measurable&&delete this.measurable,this.measurable=new L.Measurable(this._mapManager._map).startPolyline();var a=this;$(this._mapManager._map.getContainer()).keydown(function(b){27===b.keyCode&&a.measurable&&(a.measurable.removeDrawing(),delete a.measurable)})},deactivate:function(){this.measurable&&(this.measurable.abortDrawing(),delete this.measurable)}}),MapExpress.Tools.SqrtMeasureCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",title:"Измерение площади"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/Polygon.png"),b.setAttribute("title","Измерение площади"),b.setAttribute("id","measureSqrtCommand"),b},activate:function(){this.measurable&&delete this.measurable,this.measurable=new L.Measurable(this._mapManager._map).startPolygon();var a=this;$(this._mapManager._map.getContainer()).keydown(function(b){27===b.keyCode&&a.measurable&&(a.measurable.removeDrawing(),delete a.measurable)})},deactivate:function(){this.measurable&&(this.measurable.abortDrawing(),delete this.measurable)}}),MapExpress.Tools.OpenMapWorkspaceCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"btn btn-default btn-sm text-center"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a);L.DomUtil.create("i","fa fa-info fa-lg fa-fw",b);return b.setAttribute("data-toggle","tooltip"),b.setAttribute("data-placement","bottom"),b.setAttribute("title","Открыть рабочий набор"),b},activate:function(){},deactivate:function(){}}),MapExpress.Tools.OpenSideBarCommand=MapExpress.Tools.BaseMapCommand.extend({initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},activate:function(){function a(){(b.options.templateHelpers&&void 0!==b.options.templateHelpers||b.options.templateHelpers&&null!==b.options.templateHelpers)&&$.views.helpers[b.options.templateHelpers]()}var b=this;this.sideBar&&(this.sideBar.hide(),delete this.sideBar),this.sideBar=new MapExpress.Controls.MapControl(this._mapManager._map,{closeOnLeave:!0}).showSidebar(this.options.template,this.options.templateId,this.options.data,a)}}),MapExpress.Tools.SelectionCommand=MapExpress.Tools.ButtonBaseMapCommand.extend({options:{imageSrc:"images/check_@2X.png",title:"Выбор объектов",id:"selectioncommand",destroySelectionsOnDeactivate:!1,layerDescriptions:[],selectionStyle:{weight:2,color:"red",fillColor:"red",radius:5,fillOpacity:.9}},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},activate:function(){if(this.options.layerDescriptions&&this.options.layerDescriptions.length>0)for(var a=this.options.layerDescriptions.length-1;a>=0;a--)if(this.options.layerDescriptions[a].layerId&&this.options.layerDescriptions[a].featureKeyFieldName){var b=this._mapManager.getSelection(this.options.layerDescriptions[a].layerId,this.options);b&&(b.options.featureKeyFieldName=this.options.layerDescriptions[a].featureKeyFieldName,b.options.selectionStyle=this.options.selectionStyle)}},deactivate:function(){this.options.destroySelectionsOnDeactivate&&this._mapManager.clearSelections()}}),MapExpress.Tools.SelectorBaseMapsCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",templateUrl:"templates/baseLayersPreview.html",templateId:"baseLayersPreviewPalleteMenu",templateHelpers:"baseLayersPreviewPalleteMenu",title:"Выбор базовой карты"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a);b.setAttribute("title","Базовые карты");var c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/BaseMap.png"),b.setAttribute("id","SelectorBaseMapsCommand"),b},activate:function(){this.doCommand()},doCommand:function(){for(var a=window.MapManager.getMapModel().getBaseLayers(),b={layers:[]},c=0;c<a.length;c++){var d=a[c].mapLayer._dataPovider._getTileCoordByLatLng(window.MapManager._map.getCenter(),window.MapManager._map.getZoom()),e={};e.singleBase=a[c],e.tileUrl=a[c].mapLayer._dataPovider.getDataUrlByTile(d),b.layers.push(e)}this._showInfo(b)},_showInfo:function(a){function b(a){c.form.setContent(a),(c.options.templateHelpers&&void 0!==c.options.templateHelpers||c.options.templateHelpers&&null!==c.options.templateHelpers)&&$.views.helpers[c.options.templateHelpers](),c.form.show(),$(c.form._controlContent).css("overflow-y","auto"),$(c.form._controlContent).css("max-height",Number($(c.form._controlContent).parent().css("max-height").replace("px",""))-32+"px")}var c=this;return this.form&&(this.form.hide(),delete this.form),void 0===c.options.templateUrl||void 0===c.options.templateId?void new MapExpress.Controls.MapControl(window.MapManager._map,{removalDelay:3e3}).setContent("<b>Не задано представление</b>").show():(this.form=new MapExpress.Controls.MapControl(this._mapManager._map,{titleText:"Базовые карты",position:"right"}),void this.form.setContentFromTemplate(c.options.templateUrl,c.options.templateId,a,b))}}),MapExpress.Tools.ShowFavoriteLayersCommand=MapExpress.Tools.BaseMapCommand.extend({options:{buttonClassName:"map-toolbar-button",templateUrl:"templates/FavoriteLayers.html",templateId:"favoriteLayers",title:"Избранные слои"},initialize:function(a,b){MapExpress.Tools.BaseMapCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a),c=L.DomUtil.create("img",!1,b);return c.setAttribute("src","images/layers.png"),b.setAttribute("title","Избранные слои"),b.setAttribute("id","ShowFavoriteLayersCommand"),b},activate:function(){var a=this;this.form&&(this.form.hide(),this._mapManager.off("mapexspress:mapmanager:layer:visiblechanged",this.renderTemplate,this),this._mapManager._map.off("zoomend",this.renderTemplate,this),delete this.form);var b=this._mapManager.getMapModel().getFavoriteLayers();return b&&0!==b.length?(this.form=new MapExpress.Controls.MapControl(this._mapManager._map,{headerEnabled:!0,closeButtonEnabled:!0,position:"right"}),this.form.setTitle("Быстрый доступ к слоям"),this.form.on("mapcontrol:remove:before",function(b){a._mapManager.off("mapexspress:mapmanager:layer:visiblechanged",a.renderTemplate,a),a._mapManager._map.off("zoomend",a.renderTemplate,a)}),this.renderTemplate(),this._mapManager.on("mapexspress:mapmanager:layer:visiblechanged",this.renderTemplate,this),void this._mapManager._map.on("zoomend",this.renderTemplate,this)):void new MapExpress.Controls.MapControl(window.MapManager._map).showWarnWindow("Избранные слои не определены !")},renderTemplate:function(){function a(){window.refreshAllFavoriteLayersDivStyle(),b.form.show()}var b=this;this.form.setContentFromTemplate(b.options.templateUrl,b.options.templateId,{favoriteLayers:b._mapManager.getMapModel().getFavoriteLayers()},a)}}),MapExpress.Tools.ShowLayerControlMapCommand=MapExpress.Tools.OpenSideBarCommand.extend({options:{buttonClassName:"map-toolbar-button",buttonStyle:{"margin-right":"3px","margin-left":"1px","box-shadow":"none","border-radius":"0px;"},liClass:"fa fa-bars fa-lg fa-fw",template:"templates/mapSidebar.html",templateId:"mapSidebarTemplateId",templateHelpers:"layerTreeMapSidebarAfterRendering"},initialize:function(a,b){MapExpress.Tools.OpenSideBarCommand.prototype.initialize.call(this,a,b),L.setOptions(this,b)},createContent:function(a){var b=L.DomUtil.create("button",this.options.buttonClassName,a);L.DomUtil.create("i",this.options.liClass,b);return b.setAttribute("title","Управление картой"),b.setAttribute("id","showLayerControlMapCommand"),MapExpress.Controls.MapControlUtils.setStyle(b,this.options.buttonStyle),b}}),MapExpress.Utils.BrowserUtils={detectIE:function(){return"Microsoft Internet Explorer"===window.navigator.appName||!(!window.navigator.userAgent.match(/Trident/)&&!window.navigator.userAgent.match(/rv:11/))||"undefined"!=typeof $.browser&&1===$.browser.msie}},MapExpress.Utils.ColorUtils={hexToRgbA:function(a,b){var c;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(a)?(c=a.substring(1).split(""),3===c.length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),c="0x"+c.join(""),b||(b=1),"rgba("+[c>>16&255,c>>8&255,255&c].join(",")+","+b+")"):null},colorBg:function(a,b){for(var c=this.namedColorsAndHexInterpretation(),d=c.length-1;d>=0;d--)if(a.toLowerCase()===c[d].colorName.toLowerCase())return a=this.hexToRgbA(c[d].hex,b);if(a.indexOf("#")!==-1)a=this.hexToRgbA(a,b);else if(a.indexOf("rgba")!==-1)a=a;else if(a.indexOf("rgb")!==-1){var e=a.replace(" ","").replace("rgb(","").replace(")","").split(",");b||(b=1),a="rgba("+e[0]+","+e[1]+","+e[2]+","+b+")"}return a},namedColorsAndHexInterpretation:function(){return[{colorName:"aliceBlue",hex:"#F0F8FF"},{colorName:"antiqueWhite",hex:"#FAEBD7"},{colorName:"aqua",hex:"#00FFFF"},{colorName:"aquamarine",hex:"#7FFFD4"},{colorName:"azure",hex:"#F0FFFF"},{colorName:"beige",hex:"#F5F5DC"},{colorName:"bisque",hex:"#FFE4C4"},{colorName:"black",hex:"#000000"},{colorName:"blanchedAlmond",hex:"#FFEBCD"},{colorName:"blue",hex:"#0000FF"},{colorName:"blueViolet",hex:"#8A2BE2"},{colorName:"brown",hex:"#A52A2A"},{colorName:"burlyWood",hex:"#DEB887"},{colorName:"cadetBlue",hex:"#5F9EA0"},{colorName:"chartreuse",hex:"#7FFF00"},{colorName:"chocolate",hex:"#D2691E"},{colorName:"coral",hex:"#FF7F50"},{colorName:"cornflowerBlue",hex:"#6495ED"},{colorName:"cornsilk",hex:"#FFF8DC"},{colorName:"crimson",hex:"#DC143C"},{colorName:"cyan",hex:"#00FFFF"},{colorName:"darkBlue",hex:"#00008B"},{colorName:"darkCyan",hex:"#008B8B"},{colorName:"darkGoldenRod",hex:"#B8860B"},{colorName:"darkGray",hex:"#A9A9A9"},{colorName:"darkGrey",hex:"#A9A9A9"},{colorName:"darkGreen",hex:"#006400"},{colorName:"darkKhaki",hex:"#BDB76B"},{colorName:"darkMagenta",hex:"#8B008B"},{colorName:"darkOliveGreen",hex:"#556B2F"},{colorName:"darkOrange",hex:"#FF8C00"},{colorName:"darkOrchid",hex:"#9932CC"},{colorName:"darkRed",hex:"#8B0000"},{colorName:"darkSalmon",hex:"#E9967A"},{colorName:"darkSeaGreen",hex:"#8FBC8F"},{colorName:"darkSlateBlue",hex:"#483D8B"},{colorName:"darkSlateGray",hex:"#2F4F4F"},{colorName:"darkSlateGrey",hex:"#2F4F4F"},{colorName:"darkTurquoise",hex:"#00CED1"},{colorName:"darkViolet",hex:"#9400D3"},{colorName:"deepPink",hex:"#FF1493"},{colorName:"deepSkyBlue",hex:"#00BFFF"},{colorName:"dimGray",hex:"#696969"},{colorName:"dimGrey",hex:"#696969"},{colorName:"dodgerBlue",hex:"#1E90FF"},{colorName:"fireBrick",hex:"#B22222"},{colorName:"floralWhite",hex:"#FFFAF0"},{colorName:"forestGreen",hex:"#228B22"},{colorName:"fuchsia",hex:"#FF00FF"},{colorName:"gainsboro",hex:"#DCDCDC"},{colorName:"ghostWhite",hex:"#F8F8FF"},{colorName:"gold",hex:"#FFD700"},{colorName:"goldenRod",hex:"#DAA520"},{colorName:"gray",hex:"#808080"},{colorName:"grey",hex:"#808080"},{colorName:"green",hex:"#008000"},{colorName:"greenYellow",hex:"#ADFF2F"},{colorName:"HoneyDew",hex:"#F0FFF0"},{colorName:"HotPink",hex:"#FF69B4"},{colorName:"indianRed",hex:"#CD5C5C"},{colorName:"indigo",hex:"#4B0082"},{colorName:"ivory",hex:"#FFFFF0"},{colorName:"khaki",hex:"#F0E68C"},{colorName:"lavender",hex:"#E6E6FA"},{colorName:"lavenderBlush",hex:"#FFF0F5"},{colorName:"lawnGreen",hex:"#7CFC00"},{colorName:"lemonChiffon",hex:"#FFFACD"},{colorName:"lightBlue",hex:"#ADD8E6"},{colorName:"lightCoral",hex:"#F08080"},{colorName:"lightCyan",hex:"#E0FFFF"},{colorName:"lightGoldenRodYellow",hex:"#FAFAD2"},{colorName:"lightGray",hex:"#D3D3D3"},{colorName:"lightGrey",hex:"#D3D3D3"},{colorName:"lightGreen",hex:"#90EE90"},{colorName:"lightPink",hex:"#FFB6C1"},{colorName:"lightSalmon",hex:"#FFA07A"},{colorName:"lightSeaGreen",hex:"#20B2AA"},{colorName:"lightSkyBlue",hex:"#87CEFA"},{colorName:"lightSlateGray",hex:"#778899"},{colorName:"lightSlateGrey",hex:"#778899"},{colorName:"lightSteelBlue",hex:"#B0C4DE"},{colorName:"lightYellow",hex:"#FFFFE0"},{colorName:"lime",hex:"#00FF00"},{colorName:"limeGreen",hex:"#32CD32"},{colorName:"linen",hex:"#FAF0E6"},{colorName:"magenta",hex:"#FF00FF"},{colorName:"maroon",hex:"#800000"},{colorName:"mediumAquaMarine",hex:"#66CDAA"},{colorName:"mediumBlue",hex:"#0000CD"},{colorName:"mediumOrchid",hex:"#BA55D3"},{colorName:"mediumPurple",hex:"#9370DB"},{colorName:"mediumSeaGreen",hex:"#3CB371"},{colorName:"mediumSlateBlue",hex:"#7B68EE"},{colorName:"mediumSpringGreen",hex:"#00FA9A"},{colorName:"mediumTurquoise",hex:"#48D1CC"},{colorName:"mediumVioletRed",hex:"#C71585"},{colorName:"midnightBlue",hex:"#191970"},{colorName:"mintCream",hex:"#F5FFFA"},{colorName:"mistyRose",hex:"#FFE4E1"},{colorName:"moccasin",hex:"#FFE4B5"},{colorName:"navajoWhite",hex:"#FFDEAD"},{colorName:"navy",hex:"#000080"},{colorName:"oldLace",hex:"#FDF5E6"},{colorName:"olive",hex:"#808000"},{colorName:"oliveDrab",hex:"#6B8E23"},{colorName:"orange",hex:"#FFA500"},{colorName:"orangeRed",hex:"#FF4500"},{colorName:"orchid",hex:"#DA70D6"},{colorName:"paleGoldenRod",hex:"#EEE8AA"},{colorName:"paleGreen",hex:"#98FB98"},{colorName:"paleTurquoise",hex:"#AFEEEE"},{colorName:"paleVioletRed",hex:"#DB7093"},{colorName:"papayaWhip",hex:"#FFEFD5"},{colorName:"peachPuff",hex:"#FFDAB9"},{colorName:"peru",hex:"#CD853F"},{colorName:"pink",hex:"#FFC0CB"},{colorName:"plum",hex:"#DDA0DD"},{colorName:"powderBlue",hex:"#B0E0E6"},{colorName:"purple",hex:"#800080"},{colorName:"rebeccaPurple",hex:"#663399"},{colorName:"red",hex:"#FF0000"},{colorName:"rosyBrown",hex:"#BC8F8F"},{colorName:"royalBlue",hex:"#4169E1"},{colorName:"saddleBrown",hex:"#8B4513"},{colorName:"salmon",hex:"#FA8072"},{colorName:"sandyBrown",hex:"#F4A460"},{colorName:"seaGreen",hex:"#2E8B57"},{colorName:"seaShell",hex:"#FFF5EE"},{colorName:"sienna",hex:"#A0522D"},{colorName:"silver",hex:"#C0C0C0"},{colorName:"skyBlue",hex:"#87CEEB"},{colorName:"slateBlue",hex:"#6A5ACD"},{colorName:"slateGray",hex:"#708090"},{colorName:"slateGrey",hex:"#708090"},{colorName:"snow",hex:"#FFFAFA"},{colorName:"springGreen",hex:"#00FF7F"},{colorName:"steelBlue",hex:"#4682B4"},{colorName:"tan",hex:"#D2B48C"},{colorName:"teal",hex:"#008080"},{colorName:"thistle",hex:"#D8BFD8"},{colorName:"tomato",hex:"#FF6347"},{colorName:"turquoise",hex:"#40E0D0"},{colorName:"violet",hex:"#EE82EE"},{colorName:"wheat",hex:"#F5DEB3"},{colorName:"white",hex:"#FFFFFF"},{colorName:"whiteSmoke",hex:"#F5F5F5"},{colorName:"yellow",hex:"#FFFF00"},{colorName:"yellowGreen",hex:"#9ACD32"}]}},MapExpress.Utils.GeoFormatConvertor=function(){var a={};return a.WKT=function(){this.numberRegexp=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,this.tuples=new RegExp("^"+this.numberRegexp.source+"\\s"+this.numberRegexp.source+"(\\s"+this.numberRegexp.source+")?")},a.WKT.prototype.toGeoJSON=function(a){function b(a){var b=r.substring(t).match(a);return b?(t+=b[0].length,b[0]):null}function c(a){return a&&s.match(/\d+/)&&(a.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+s}}),a}function d(){b(/^\s*/)}function e(){d();for(var a,c=0,e=[],f=[e],g=e;a=b(/^(\()/)||b(/^(\))/)||b(/^(,)/)||b(p);){if("("===a)f.push(g),g=[],f[f.length-1].push(g),c++;else if(")"===a){if(0===g.length)return null;if(g=f.pop(),!g)return null;if(c--,0===c)break}else if(","===a)g=[],f[f.length-1].push(g);else{if(a.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(g,a.split(/\s/g).map(parseFloat))}d()}return 0!==c?null:e}function f(){for(var a,c,e=[];c=b(p)||b(/^(,)/);)","===c?(e.push(a),a=[]):c.split(/\s/g).some(isNaN)||(a||(a=[]),Array.prototype.push.apply(a,c.split(/\s/g).map(parseFloat))),d();return a?(e.push(a),e.length?e:null):null}function g(){if(!b(/^(point(\sz)?)/i))return null;if(d(),!b(/^(\()/))return null;var a=f();return a?(d(),b(/^(\))/)?{type:"Point",coordinates:a[0]}:null):null}function h(){if(!b(/^(multipoint)/i))return null;d();var a=r.substring(r.indexOf("(")+1,r.length-1).replace(/\(/g,"").replace(/\)/g,"");r="MULTIPOINT ("+a+")";var c=e();return c?(d(),{type:"MultiPoint",coordinates:c}):null}function i(){if(!b(/^(multilinestring)/i))return null;d();var a=e();return a?(d(),{type:"MultiLineString",coordinates:a}):null}function j(){if(!b(/^(linestring(\sz)?)/i))return null;if(d(),!b(/^(\()/))return null;var a=f();return a&&b(/^(\))/)?{type:"LineString",coordinates:a}:null}function k(){if(!b(/^(polygon(\sz)?)/i))return null;d();var a=e();return a?{type:"Polygon",coordinates:a}:null}function l(){if(!b(/^(multipolygon)/i))return null;d();var a=e();return a?{type:"MultiPolygon",coordinates:a}:null}function m(){var a,c=[];if(!b(/^(geometrycollection)/i))return null;if(d(),!b(/^(\()/))return null;for(;a=n();)c.push(a),d(),b(/^(,)/),d();return b(/^(\))/)?{type:"GeometryCollection",geometries:c}:null}function n(){return g()||j()||k()||h()||i()||l()||m()}var o=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,p=new RegExp("^"+o.source+"(\\s"+o.source+"){1,}"),q=a.split(";"),r=q.pop(),s=(q.shift()||"").split("=").pop(),t=0;return c(n())},a.WKT.prototype.fromGeoJSON=function(a){function b(a){return 2===a.length?a[0]+" "+a[1]:3===a.length?a[0]+" "+a[1]+" "+a[2]:void 0}function c(a){return a.map(b).join(", ")}function d(a){return a.map(c).map(f).join(", ")}function e(a){return a.map(d).map(f).join(", ")}function f(a){return"("+a+")"}switch("Feature"===a.type&&(a=a.geometry),a.type){case"Point":return"POINT ("+b(a.coordinates)+")";case"LineString":return"LINESTRING ("+c(a.coordinates)+")";case"Polygon":return"POLYGON ("+d(a.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+c(a.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+e(a.coordinates)+")";case"MultiLineString":return"MULTILINESTRING ("+d(a.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+a.geometries.map(this.stringify).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}},a.CSV=function(){var a=this;this.dsv=new Function('dsv.version = "0.0.3";\n\ndsv.tsv = dsv("\\t");\ndsv.csv = dsv(",");\n\nfunction dsv(delimiter) {\n  var dsv = {},\n      reFormat = new RegExp("[\\"" + delimiter + "\\n]"),\n      delimiterCode = delimiter.charCodeAt(0);\n\n  dsv.parse = function(text, f) {\n    var o;\n    return dsv.parseRows(text, function(row, i) {\n      if (o) return o(row, i - 1);\n      var a = new Function("d", "return {" + row.map(function(name, i) {\n        return JSON.stringify(name) + ": d[" + i + "]";\n      }).join(",") + "}");\n      o = f ? function(row, i) { return f(a(row), i); } : a;\n    });\n  };\n\n  dsv.parseRows = function(text, f) {\n    var EOL = {}, // sentinel value for end-of-line\n        EOF = {}, // sentinel value for end-of-file\n        rows = [], // output rows\n        N = text.length,\n        I = 0, // current character index\n        n = 0, // the current line number\n        t, // the current token\n        eol; // is the current token followed by EOL?\n\n    function token() {\n      if (I >= N) return EOF; // special case: end of file\n      if (eol) return eol = false, EOL; // special case: end of line\n\n      // special case: quotes\n      var j = I;\n      if (text.charCodeAt(j) === 34) {\n        var i = j;\n        while (i++ < N) {\n          if (text.charCodeAt(i) === 34) {\n            if (text.charCodeAt(i + 1) !== 34) break;\n            ++i;\n          }\n        }\n        I = i + 2;\n        var c = text.charCodeAt(i + 1);\n        if (c === 13) {\n          eol = true;\n          if (text.charCodeAt(i + 2) === 10) ++I;\n        } else if (c === 10) {\n          eol = true;\n        }\n        return text.substring(j + 1, i).replace(/""/g, "\\"");\n      }\n\n      // common case: find next delimiter or newline\n      while (I < N) {\n        var c = text.charCodeAt(I++), k = 1;\n        if (c === 10) eol = true; // \\n\n        else if (c === 13) { eol = true; if (text.charCodeAt(I) === 10) ++I, ++k; } // \\r|\\r\\n\n        else if (c !== delimiterCode) continue;\n        return text.substring(j, I - k);\n      }\n\n      // special case: last token before EOF\n      return text.substring(j);\n    }\n\n    while ((t = token()) !== EOF) {\n      var a = [];\n      while (t !== EOL && t !== EOF) {\n        a.push(t);\n        t = token();\n      }\n      if (f && !(a = f(a, n++))) continue;\n      rows.push(a);\n    }\n\n    return rows;\n  };\n\n  dsv.format = function(rows) {\n    if (Array.isArray(rows[0])) return dsv.formatRows(rows); // deprecated; use formatRows\n    var fieldSet = {}, fields = [];\n\n    // Compute unique fields in order of discovery.\n    rows.forEach(function(row) {\n      for (var field in row) {\n        if (!(field in fieldSet)) {\n          fields.push(fieldSet[field] = field);\n        }\n      }\n    });\n\n    return [fields.map(formatValue).join(delimiter)].concat(rows.map(function(row) {\n      return fields.map(function(field) {\n        return formatValue(row[field]);\n      }).join(delimiter);\n    })).join("\\n");\n  };\n\n  dsv.formatRows = function(rows) {\n    return rows.map(formatRow).join("\\n");\n  };\n\n  function formatRow(row) {\n    return row.map(formatValue).join(delimiter);\n  }\n\n  function formatValue(text) {\n    return reFormat.test(text) ? "\\"" + text.replace(/\\"/g, "\\"\\"") + "\\"" : text;\n  }\n\n  return dsv;\n}\n;return dsv')(),this.element=function(b,c){return a.search(b,c).val},this.formatPair=function(a){return this.format(a.lat,"lat")+" "+this.format(a.lon,"lon")},this.format=function(a,b){var c={lat:["N","S"],lon:["E","W"]}[b]||"",d=c[a>=0?0:1],e=Math.abs(a),f=Math.floor(e),g=e-f,h=60*g,i=Math.floor(h),j=Math.floor(60*(h-i));return f+"° "+(i?i+"' ":"")+(j?j+'" ':"")+d},this.search=function(a,b,c){if(b||(b="NSEW"),"string"!=typeof a)return{val:null,regex:c};c=c||/[\s\,]*([\-|\—|\―]?[0-9.]+)°? *(?:([0-9.]+)['’′‘] *)?(?:([0-9.]+)(?:''|"|”|″) *)?([NSEW])?/gi;var d=c.exec(a);return d?d[4]&&b.indexOf(d[4])===-1?{val:null,regex:c}:{val:((d[1]?parseFloat(d[1]):0)+(d[2]?parseFloat(d[2])/60:0)+(d[3]?parseFloat(d[3])/3600:0))*(d[4]&&"S"===d[4]||"W"===d[4]?-1:1),regex:c,raw:d[0],dim:d[4]}:{val:null,regex:c}},this.pair=function(b,c){b=b.trim();var d=a.search(b,c);
if(null===d.val)return null;var e=a.search(b,c,d.regex);return null===e.val?null:d.raw+e.raw!==b?null:d.dim?a.swapdim(d.val,e.val,d.dim):[d.val,e.val]},this.swapdim=function(a,b,c){return"N"===c||"S"===c?[a,b]:"W"===c||"E"===c?[b,a]:void 0}},a.CSV.prototype.toGeoJSON=function(a,b){function c(a){return!!a.match(/(Lat)(itude)?/gi)}function d(a){return!!a.match(/(L)(on|ng)(gitude)?/i)}function e(a){return"object"==typeof a?Object.keys(a).length:0}function f(a){var b=[",",";","\t","|"],c=[];return b.forEach(function(b){var d=g.dsv(b).parse(a);if(d.length>=1){for(var f=e(d[0]),h=0;h<d.length;h++)if(e(d[h])!==f)return;c.push({delimiter:b,arity:Object.keys(d[0]).length})}}),c.length?c.sort(function(a,b){return b.arity-a.arity})[0].delimiter:null}var g=this,h=function(a,b){return a?a:b};void 0===b&&(b={}),h||(h=b,b={}),b.delimiter=b.delimiter||",";var i=b.latfield||"",j=b.lonfield||"",k=b.crs||"",l=[],m={type:"FeatureCollection",features:l};if(""!==k&&(m.crs={type:"name",properties:{name:k}}),"auto"===b.delimiter&&"string"==typeof a&&(b.delimiter=f(a),!b.delimiter))return h({type:"Error",message:"Could not autodetect delimiter"});var n="string"==typeof a?g.dsv(b.delimiter).parse(a):a;if(!n.length)return h(null,m);if(!i||!j){for(var o in n[0])!i&&c(o)&&(i=o),!j&&d(o)&&(j=o);if(!i||!j){var p=[];for(var q in n[0])p.push(q);return h({type:"Error",message:"Latitude and longitude fields not present",data:n,fields:p})}}for(var r=[],s=0;s<n.length;s++)if(void 0!==n[s][j]&&void 0!==n[s][j]){var t,u,v,w=n[s][j],x=n[s][i];v=g.element(w,"EW"),v&&(w=v),v=g.element(x,"NS"),v&&(x=v),t=parseFloat(w),u=parseFloat(x),isNaN(t)||isNaN(u)?r.push({message:"A row contained an invalid value for latitude or longitude",row:n[s]}):(b.includeLatLon||(delete n[s][j],delete n[s][i]),l.push({type:"Feature",properties:n[s],geometry:{type:"Point",coordinates:[parseFloat(t),parseFloat(u)]}}))}return m},a.CSV.prototype.toLine=function(a){for(var b=a.features,c={type:"Feature",geometry:{type:"LineString",coordinates:[]}},d=0;d<b.length;d++)c.geometry.coordinates.push(b[d].geometry.coordinates);return c.properties=b[0].properties,{type:"FeatureCollection",features:[c]}},a.CSV.prototype.toPolygon=function(a){for(var b=a.features,c={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},d=0;d<b.length;d++)c.geometry.coordinates[0].push(b[d].geometry.coordinates);return c.properties=b[0].properties,{type:"FeatureCollection",features:[c]}},a.ESRI=function(){},a.ESRI.prototype.toGeoJSON=function(a){function b(a){var b,c=0,d=0,e=a.length,f=a[d];for(d;d<e-1;d++)b=a[d+1],c+=(b[0]-f[0])*(b[1]+f[1]),f=b;return c>=0}function c(a){var c,d,e,f,g,h,i;if(a){if((a.x&&"NaN"!==a.x||0===a.x)&&(a.y&&"NaN"!==a.y||0===a.y))f="Point",e=[a.x,a.y];else if(a.points&&a.points.length)f="MultiPoint",e=a.points;else if(a.paths&&a.paths.length)g=a.paths,1===g.length?(f="LineString",e=g[0]):(f="MultiLineString",e=g);else if(a.rings&&a.rings.length){for(h=[],g=a.rings,d=0;d<g.length;d++)i=g[d],b(i)?h.push([i]):h.length>0&&h[h.length-1].push(i);h.length>1?(e=h,f="MultiPolygon"):(e=h.pop(),f="Polygon")}return c=e&&f?{type:f,coordinates:e}:null}return c}function d(a){var b,d,e,f=null;if(a&&(f={type:"Feature"},a.geometry&&(f.geometry=c(a.geometry)),a.attributes)){d={},e=a.attributes;for(b in a.attributes)d[b]=a.attributes[b];f.properties=d}return f}var e,f,g,h;if(a)if(a.features||a.results)for(e={type:"FeatureCollection",features:[]},a.features?g=a.features:a.results?g=a.results:console.log("обратить внимание на входящий JSON"),f=0;f<g.length;f++)h=d(g[f]),h&&e.features.push(h);else e=a.geometry?d(a):c(a);return e},a.ESRI.prototype.fromGeoJSON=function(a){function b(a){var b,c=0,d=0,e=a.length,f=a[d];for(d;d<e-1;d++)b=a[d+1],c+=(b[0]-f[0])*(b[1]+f[1]),f=b;return c>=0}function c(a,b){var c=!1;return("esriGeometryPoint"!==a&&"esriGeometryMultipoint"!==a||"Point"!==b&&"MultiPoint"!==b)&&("esriGeometryPolyline"!==a||"LineString"!==b&&"MultiLineString"!==b)?"esriGeometryPolygon"!==a||"Polygon"!==b&&"MultiPolygon"!==b||(c=!0):c=!0,c}function d(a){var b,c;return"Point"===a?b="esriGeometryPoint":"MultiPoint"===a?(b="esriGeometryMultipoint",c="points"):"LineString"===a||"MultiLineString"===a?(b="esriGeometryPolyline",c="paths"):"Polygon"!==a&&"MultiPolygon"!==a||(b="esriGeometryPolygon",c="rings"),{type:b,geomHolder:c}}function e(a){var c,d,e,f=[];for(c=0,d=a.length;c<d;c++)e=a[c],0===c!==b(e)&&(e=e.reverse()),f.push(e);return f}function f(a){var b,c,d;if("MultiPoint"===a.type||"MultiLineString"===a.type)d=a.coordinates||[];else if("Point"===a.type||"LineString"===a.type)d=a.coordinates?[a.coordinates]:[];else if("Polygon"===a.type)d=[],a.coordinates&&(d=e(a.coordinates));else if("MultiPolygon"===a.type&&(d=[],a.coordinates))for(b=0,c=a.coordinates.length;b<c;b++)d.push(e(a.coordinates[b]));return d}function g(a){var b,e,g,h,i,j;if("GeometryCollection"===a.type){var k=a.geometries[0];for(g=[],e=d(k.type),h=0;h<a.geometries.length;h++)c(e.type,a.geometries[h].type)&&g.push(a.geometries[h])}else e=d(a.type),g=[a];if("esriGeometryPoint"===e.type&&g.length>1&&(e=d("MultiPoint")),b={spatialReference:{wkid:4326}},"esriGeometryPoint"===e.type)g[0]&&g[0].coordinates&&0!==g[0].coordinates.length?(b.x=g[0].coordinates[0],b.y=g[0].coordinates[1]):b.x=null;else for(b[e.geomHolder]=[],h=0;h<g.length;h++)for(j=f(g[h]),i=0;i<j.length;i++)b[e.geomHolder].push(j[i]);return b}function h(a){var b,c,d;if(a&&(b={},a.geometry&&(b.geometry=g(a.geometry)),a.properties)){d={};for(c in a.properties)d[c]=a.properties[c];b.attributes=d}return b}var i,j,k,l;if(a)if("FeatureCollection"===a.type)for(i={features:[]},k=a.features,j=0;j<k.length;j++)l=h(k[j]),l&&i.features.push(l);else i="Feature"===a.type?h(a):g(a);return i},{esri:new a.ESRI,wkt:new a.WKT,csv:new a.CSV}}(),MapExpress.Utils.GeoFormatConvertor.XML=L.Class.extend({initialize:function(){},okhash:function(a){if(!a||!a.length)return 0;for(var b=0,c=0;b<a.length;b++)c=(c<<5)-c+a.charCodeAt(b)|0;return c},get:function(a,b){return a.getElementsByTagName(b)},attr:function(a,b){return a.getAttribute(b)},attrf:function(a,b){return parseFloat(this.attr(a,b))},get1:function(a,b){var c=this.get(a,b);return c.length?c[0]:null},norm:function(a){return a.normalize&&a.normalize(),a},numarray:function(a){for(var b=0,c=[];b<a.length;b++)c[b]=parseFloat(a[b]);return c},clean:function(a){var b={};for(var c in a)a[c]&&(b[c]=a[c]);return b},nodeVal:function(a){return a&&this.norm(a),a&&a.firstChild&&a.firstChild.nodeValue||""},coordOne:function(a){return this.numarray(a.replace(/\s*/g,"").split(","))},coord:function(a){for(var b=a.replace(/^\s*|\s*$/g,"").split(/\s+/),c=[],d=0;d<b.length;d++)c.push(this.coordOne(b[d]));return c},coordPair:function(a){var b=[this.attrf(a,"lon"),this.attrf(a,"lat")],c=this.get1(a,"ele"),d=this.get1(a,"time");return c&&b.push(parseFloat(this.nodeVal(c))),{coordinates:b,time:d?this.nodeVal(d):null}},fc:function(){return{type:"FeatureCollection",features:[]}},serializer:function(){var a;return"undefined"!=typeof XMLSerializer&&(a=new XMLSerializer),a},xml2str:function(a){return void 0!==a.xml?a.xml:this.serializer().serializeToString(a)},parseXML:function(a){var b;try{if(window.DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml")}else b=new ActiveXObject("MSXML2.DOMDocument.3.0"),b.validateOnParse=!1,b.async=!1,b.loadXML(a)}catch(a){console.log(a)}return b},strip:function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")},toGeoJSON:function(){}}),MapExpress.Utils.GeoFormatConvertor.xml=function(){return new MapExpress.Utils.GeoFormatConvertor.XML},MapExpress.Utils.GeoFormatConvertor.GPX=MapExpress.Utils.GeoFormatConvertor.XML.extend({initialize:function(){},toGeoJSON:function(a){function b(a,b){var c=i.get(a,b),d=[],e=[],f=c.length;if(!(f<2)){for(var g=0;g<f;g++){var h=i.coordPair(c[g]);d.push(h.coordinates),h.time&&e.push(h.time)}return{line:d,times:e}}}function c(a){for(var c,d=i.get(a,"trkseg"),e=[],g=[],h=0;h<d.length;h++)c=b(d[h],"trkpt"),c.line&&e.push(c.line),c.times.length&&g.push(c.times);if(0!==e.length){var j=f(a);return g.length&&(j.coordTimes=1===e.length?g[0]:g),{type:"Feature",properties:j,geometry:{type:1===e.length?"LineString":"MultiLineString",coordinates:1===e.length?e[0]:e}}}}function d(a){var c=b(a,"rtept");if(c){for(var d=[],e=0;e<c.line.length;e++)3===c.line.length?d.push([c.line[e][0],c.line[e][1]]):d.push(c.line[e]);var g={type:"Feature",properties:f(a),geometry:{type:"LineString",coordinates:d}};return c.times.length&&(g.geometry.times=c.times),g}}function e(a){var b=f(a);return b.sym=i.nodeVal(i.get1(a,"sym")),{type:"Feature",properties:b,geometry:{type:"Point",coordinates:i.coordPair(a).coordinates}}}function f(a){var b,c=["name","desc","author","copyright","link","time","keywords"],d={};for(b=0;b<c.length;b++)d[c[b]]=i.nodeVal(i.get1(a,c[b]));return i.clean(d)}var g,h,i=this,j=i.parseXML(a),k=i.get(j,"trk"),l=i.get(j,"rte"),m=i.get(j,"wpt"),n=i.fc();for(g=0;g<k.length;g++)h=c(k[g]),h&&n.features.push(h);for(g=0;g<l.length;g++)h=d(l[g]),h&&n.features.push(h);for(g=0;g<m.length;g++)n.features.push(e(m[g]));return n}}),MapExpress.Utils.GeoFormatConvertor.gpx=function(){return new MapExpress.Utils.GeoFormatConvertor.GPX},MapExpress.Utils.GeoFormatConvertor.KML=MapExpress.Utils.GeoFormatConvertor.XML.extend({initialize:function(){},toGeoJSON:function(a){function b(a){var b,c;return a=a||"","#"===a.substr(0,1)&&(a=a.substr(1)),6!==a.length&&3!==a.length||(b=a),8===a.length&&(c=parseInt(a.substr(0,2),16)/255,b=a.substr(2)),[b,isNaN(c)?void 0:c]}function c(a){return g.numarray(a.split(" "))}function d(a){var b=g.get(a,"coord","gx"),d=[],e=[];0===b.length&&(b=g.get(a,"gx:coord"));for(var f=0;f<b.length;f++)d.push(c(g.nodeVal(b[f])));for(var h=g.get(a,"when"),i=0;i<h.length;i++)e.push(g.nodeVal(h[i]));return{coords:d,times:e}}function e(a){var b,c,f,h,i,j=[],l=[];if(g.get1(a,"MultiGeometry"))return e(g.get1(a,"MultiGeometry"));if(g.get1(a,"MultiTrack"))return e(g.get1(a,"MultiTrack"));if(g.get1(a,"gx:MultiTrack"))return e(g.get1(a,"gx:MultiTrack"));for(f=0;f<k.length;f++)if(c=g.get(a,k[f]))for(h=0;h<c.length;h++)if(b=c[h],"Point"===k[f])j.push({type:"Point",coordinates:g.coordOne(g.nodeVal(g.get1(b,"coordinates")))});else if("LineString"===k[f])j.push({type:"LineString",coordinates:g.coord(g.nodeVal(g.get1(b,"coordinates")))});else if("Polygon"===k[f]){var m=g.get(b,"LinearRing"),n=[];for(i=0;i<m.length;i++)n.push(g.coord(g.nodeVal(g.get1(m[i],"coordinates"))));j.push({type:"Polygon",coordinates:n})}else if("Track"===k[f]||"gx:Track"===k[f]){var o=d(b);j.push({type:"LineString",coordinates:o.coords}),o.times.length&&l.push(o.times)}return{geoms:j,coordTimes:l}}function f(a){var c,d=e(a),f={},h=g.nodeVal(g.get1(a,"name")),i=g.nodeVal(g.get1(a,"styleUrl")),k=g.nodeVal(g.get1(a,"description")),l=g.get1(a,"TimeSpan"),m=g.get1(a,"ExtendedData"),n=g.get1(a,"LineStyle"),o=g.get1(a,"PolyStyle");if(!d.geoms.length)return[];if(h&&(f.name=h),i&&j[i]&&(f.styleUrl=i,f.styleHash=j[i]),k&&(f.description=k),l){var p=g.nodeVal(g.get1(l,"begin")),q=g.nodeVal(g.get1(l,"end"));f.timespan={begin:p,end:q}}if(n){var r=b(g.nodeVal(g.get1(n,"color"))),s=r[0],t=r[1],u=parseFloat(g.nodeVal(g.get1(n,"width")));s&&(f.stroke=s),isNaN(t)||(f["stroke-opacity"]=t),isNaN(u)||(f["stroke-width"]=u)}if(o){var v=b(g.nodeVal(g.get1(o,"color"))),w=v[0],x=v[1],y=g.nodeVal(g.get1(o,"fill")),z=g.nodeVal(g.get1(o,"outline"));w&&(f.fill=w),isNaN(x)||(f["fill-opacity"]=x),y&&(f["fill-opacity"]="1"===y?1:0),z&&(f["stroke-opacity"]="1"===z?1:0)}if(m){var A=g.get(m,"Data"),B=g.get(m,"SimpleData");for(c=0;c<A.length;c++)f[A[c].getAttribute("name")]=g.nodeVal(g.get1(A[c],"value"));for(c=0;c<B.length;c++)f[B[c].getAttribute("name")]=g.nodeVal(B[c])}d.coordTimes.length&&(f.coordTimes=1===d.coordTimes.length?d.coordTimes[0]:d.coordTimes);var C={type:"Feature",geometry:1===d.geoms.length?d.geoms[0]:{type:"GeometryCollection",geometries:d.geoms},properties:f};return g.attr(a,"id")&&(C.id=g.attr(a,"id")),[C]}for(var g=this,h=g.fc(),i=g.parseXML(a),j={},k=["Polygon","LineString","Point","Track","gx:Track"],l=g.get(i,"Placemark"),m=g.get(i,"Style"),n=0;n<m.length;n++)j["#"+this.attr(m[n],"id")]=g.okhash(g.xml2str(m[n])).toString(16);for(var o=0;o<l.length;o++)h.features=h.features.concat(f(l[o]));return h}}),MapExpress.Utils.GeoFormatConvertor.kml=function(){return new MapExpress.Utils.GeoFormatConvertor.KML},MapExpress.Utils.GeoFormatConvertor.GML=MapExpress.Utils.GeoFormatConvertor.XML.extend({namespaces:{gml:"http://www.opengis.net/gml",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},initialize:function(){this.srs=null},swapCoordinates:function(a){var b;return b="EPSG:4326"===this.srs?[a[0],a[1]]:"EPSG:3857"===this.srs?L.Projection.SphericalMercator.unproject(new L.Point(a[0],a[1])):"EPSG:3395"===this.srs?L.Projection.Mercator.unproject(new L.Point(a[0],a[1])):[a[0],a[1]]},elementsNS:function(a,b,c){var d=[];if(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);else for(var e,f,g=a.getElementsByTagName("*"),h=0,i=g.length;h<i;++h)e=g[h],f=e.prefix?e.prefix+":"+c:c,"*"!==c&&f!==e.nodeName||"*"!==b&&b!==e.namespaceURI||d.push(e);return d},checkIfGeomNode:function(a){var b=["Point","LineString","Polygon","Curve","MultiPoint","MultiLineString","MultiPolygon","MultiSurface","MultiCurve"];return b.indexOf(a)!==-1},nodePropsAsObj:function(a){var b={},c=a.childNodes;if(a.children.length>0){if(a.attributes.length>0)for(var d=0;d<a.attributes.length;d++)b[a.attributes[d].localName]=a.attributes[d].textContent;for(var e=0;e<c.length;e++)null!==c[e].firstChild&&(this.checkIfGeomNode(c[e].firstChild.localName)?b.geometry=this.parceGeomnNode(c[e]):b[c[e].localName]=this.nodePropsAsObj(c[e]))}else if(a.attributes.length>0){for(var f=0;f<a.attributes.length;f++)b[a.attributes[f]]=a.attributes[f].textContent;b[a.localName]=a.innerHTML}else b=a.innerHTML;return b},parceGeomnNode:function(a){var b=this;switch(a.firstChild.localName){case"Polygon":return{type:"Polygon",coordinates:b.parcePolygon(a.firstChild)};case"MultiSurface":case"MultiPolygon":return{type:"MultiPolygon",coordinates:b.parceMultiPolygon(a.firstChild)};case"Curve":case"LineString":return{type:"LineString",coordinates:b.parceLineString(a.firstChild)};case"Point":return{type:"Point",coordinates:b.parcePoint(a.firstChild)};case"MultiPoint":return{type:"MultiPoint",coordinates:b.parceMultiPoint(a.firstChild)};case"MultiCurve":case"MultiLineString":return{type:"MultiLineString",coordinates:b.parceMultiLineString(a.firstChild)};default:throw new Error("Ошибка парсинга геометрии!")}},parceCoordsPosList:function(a,b){for(var c=[],d=a.textContent.split(" "),e=0;e<d.length;e+=Number(b)){var f=e+1;c.push([Number(d[e]),Number(d[f])])}return c},parceCoordsPos:function(a){return a.textContent.split(" ").map(function(a){return parseFloat(a)})},parceCoordsCoordinates:function(a){var b={ds:".",cs:",",ts:" "};a.attributes.decimal&&(b.ds=a.attributes.decimal.value),a.attributes.cs&&(b.cs=a.attributes.cs.value),a.attributes.ts&&(b.ts=a.attributes.ts.value);for(var c=[],d=a.textContent.split(b.ts),e=function(a){return"."!==b.ds&&(a=a.replace(b.ds,".")),parseFloat(a)},f=0;f<d.length;f++)c.push(d[f].split(b.cs).map(e));return 1===c.length?c[0]:c},_parceLineString:function(a){var b,c=a.firstChild,d=[];a.attributes&&a.attributes.length>0&&a.attributes.srsDimension&&(b=a.attributes.srsDimension.value),c.attributes&&c.attributes.length>0&&c.attributes.srsDimension&&(b=c.attributes.srsDimension.value),null!==b&&void 0!==b||(b=2);var e=c.tagName;if("gml:pos"===e||"gml:Point"===e)for(var f=a.getElementsByTagNameNS(this.namespaces.gml,e.split(":").pop()),g=0;g<f.length;g++)d.push(this.parcePoint(f[g]));else"gml:posList"===e?d=this.parceCoordsPosList(c,b):"gml:coordinates"===e&&(d=this.parceCoordsCoordinates(c,b));return d},parcePoint:function(a,b){var c;if("gml:pos"===a.firstChild.tagName)c=this.parceCoordsPos(a.firstChild,b);else{if("gml:coordinates"!==a.firstChild.tagName)throw new Error("Не известный тип координат для точки");c=this.parceCoordsCoordinates(a.firstChild,b)}return c},parceMultiPoint:function(a,b){for(var c=[],d=a.childNodes,e=0;e<d.length;e++)c.push(this.parcePoint(d[e].firstChild));return c},parceLineString:function(a){var b=this._parceLineString(a);return b},parceMultiLineString:function(a){for(var b=[],c=a.childNodes,d=0;d<c.length;d++)b.push(this.parceLineString(c[d].firstChild));return b},parceLinearRing:function(a){var b=this._parceLineString(a);return b},parcePolygon:function(a){for(var b=[],c=0;c<a.childNodes.length;c++)a.childNodes[0].nodeType===document.ELEMENT_NODE&&(0===c?b.push(this.parceLinearRing(a.childNodes[0].firstChild)):b.push(this.parceLinearRing(a.childNodes[c].firstChild)));return b},parceMultiPolygon:function(a){for(var b=[],c=a.childNodes,d=0;d<c.length;d++)b.push(this.parcePolygon(c[d].firstChild));return b},toGeoJSON:function(a,b){var c;c="string"==typeof a?a:(new XMLSerializer).serializeToString(a);var d,e=c.replace(/[\t\n\r]/g," ").replace(/\s+/g," "),f=this.parseXML(e),g=this.namespaces.gml,h=this.namespaces.wfs,i=[],j=b;if("gml2"===j?d=this.elementsNS(f.documentElement,g,"featureMember"):"gml3.1"===j?d=this.elementsNS(f.documentElement,g,"featureMembers"):"gml3.2"===j?d=this.elementsNS(f.documentElement,h,"member"):console.warn("Не задана версия gml при конвертации"),d.length>0)if("gml2"!==j)for(var k=d[0].childNodes,l=0;l<k.length;l++)k[l].nodeType===document.ELEMENT_NODE&&i.push(this.nodePropsAsObj(k[l]));else for(var m=0;m<d.length;m++)for(var n=d[m],o=0;o<n.childNodes.length;o++)n.childNodes[o].firstChild&&i.push(this.nodePropsAsObj(n.childNodes[o]));for(var p={type:"FeatureCollection",features:[]},q=0;q<i.length;q++)if(null!==i[q]||void 0!==i[q]){var r={type:"Feature",geometry:i[q].geometry,properties:{}};for(var s in i[q])"geometry"!==s&&(r.properties[s]=i[q][s]);p.features.push(r)}return p},fromGeoJSON:function(a,b,c,d,e,f){var g;switch(f){case"gml2":g=this._createXMLdoc();break;case"gml3.1":g=this._createXMLElement("gml:featureMembers",this.namespaces.gml,{});break;case"gml3.2":g=this._createXMLElement("gml:member",this.namespaces.gml,{})}switch(f){case"gml2":for(var h=this._createXMLElement("gml:featureMember",this.namespaces.gml,{}),i=0;i<a.features.length;i++)h.appendChild(this.createNodeFromGeoJSONFeature(a.features[i],b,c,d,e,f)),g.appendChild(h);break;case"gml3.1":case"gml3.2":for(var j=0;j<a.features.length;j++)g.appendChild(this.createNodeFromGeoJSONFeature(a.features[j],b,c,d,e,f))}return g},createNodeFromGeoJSONFeature:function(a,b,c,d,e,f,g){var h=this._createXMLElement(b+":"+c,e),i=this._createXMLElement(b+":"+d,e,{});for(var j in a.properties){var k=this._createXMLElement(b+":"+j,e,{});k.textContent=a.properties[j],h.appendChild(k)}return i.appendChild(this.createGeometryNodeFromGeoJSONFeature(a.geometry,f,g)),h.appendChild(i),h},createGeometryNodeFromGeoJSONFeature:function(a,b,c){var d;switch(a.type){case"Point":d=this.createGMLPoint(a.coordinates,b,c);break;case"MultiPoint":d=this.createGMLMultiPoint(a.coordinates,b,c);break;case"LineString":d=this.createGMLLineString(a.coordinates,b,c);break;case"MultiLineString":d=this.createGMLMultiLineString(a.coordinates,b,c);break;case"Polygon":d=this.createGMLPolygon(a.coordinates,b,c);break;case"MultiPolygon":d=this.createGMLMultiPolygon(a.coordinates,b,c)}return d},createGMLPoint:function(a,b,c){var d,e=this._createXMLElement("gml:Point",this.namespaces.gml,{srsName:c,srsDimension:"2"});switch(b){case"2":d=this._createXMLElement("gml:coordinates",this.namespaces.gml,{decimal:".",cs:",",ts:" "});break;case"3.1":case"3.2":d=this._createXMLElement("gml:pos",this.namespaces.gml)}return d.textContent=a.join(" "),e.appendChild(d),e},createGMLMultiPoint:function(a,b,c){for(var d=this._createXMLElement("gml:MultiPoint",this.namespaces.gml,{srsName:c,srsDimension:"2"}),e=0;e<a.length;e++){var f=this._createXMLElement("gml:pointMember",this.namespaces.gml),g=this.createGMLPoint(a[e],b);f.appendChild(g),d.appendChild(f)}return d},createGMLLineString:function(a,b,c){var d,e=[],f=this._createXMLElement("gml:LineString",this.namespaces.gml,{srsName:c,srsDimension:"2"});switch(b){case"gml2":d=this._createXMLElement("gml:coordinates",this.namespaces.gml,{decimal:".",cs:",",ts:" "});break;case"gml3.1":case"gml3.2":d=this._createXMLElement("gml:posList",this.namespaces.gml)}for(var g=0;g<a.length;g++)e=e.concat(a[g]);return d.textContent=e.join(" "),f.appendChild(d),f},createGMLMultiLineString:function(a,b,c){for(var d=this._createXMLElement("gml:MultiLineString",this.namespaces.gml,{srsName:c,srsDimension:"2"}),e=0;e<a.length;e++){var f=this._createXMLElement("gml:lineStringMember",this.namespaces.gml),g=this.createGMLLineString(a[e],b);f.appendChild(g),d.appendChild(f)}return d},createGMLPolygon:function(a,b,c){var d,e,f,g=this._createXMLElement("gml:Polygon",this.namespaces.gml,{srsName:c,srsDimension:"2"}),h=[];switch(b){case"gml2":f=g.appendChild(this._createXMLElement("gml:outerBoundaryIs",this.namespaces.gml)),e=f.appendChild(this._createXMLElement("gml:LinearRing",this.namespaces.gml,{srsDimension:"2"})),d=this._createXMLElement("gml:coordinates",this.namespaces.gml,{decimal:".",cs:",",ts:" "});break;case"gml3.1":case"gml3.2":f=g.appendChild(this._createXMLElement("gml:exterior",this.namespaces.gml)),e=f.appendChild(this._createXMLElement("gml:LinearRing",this.namespaces.gml,{srsDimension:"2"})),d=this._createXMLElement("gml:posList",this.namespaces.gml)}for(var i=0;i<a[0].length;i++)h=h.concat(a[0][i]);if(d.textContent=h.join(" "),e.appendChild(d),a[1])for(var j,k,l,m=0;m<a[1][m].length;m++){switch(b){case"gml2":j=g.appendChild(this._createXMLElement("gml:innerBoundaryIs",this.namespaces.gml)),k=j.appendChild(this._createXMLElement("gml:LinearRing",this.namespaces.gml,{srsDimension:"2"})),l=this._createXMLElement("gml:coordinates",this.namespaces.gml,{decimal:".",cs:",",ts:" "});break;case"gml3.1":case"gml3.2":j=g.appendChild(this._createXMLElement("gml:interior",this.namespaces.gml)),k=j.appendChild(this._createXMLElement("gml:LinearRing",this.namespaces.gml,{srsDimension:"2"})),l=this._createXMLElement("gml:posList",this.namespaces.gml)}l.textContent=a[1][m].join(" "),k.appendChild(l)}return g},createGMLMultiPolygon:function(a,b,c){for(var d=this._createXMLElement("gml:MultiPolygon",this.namespaces.gml,{srsName:c,srsDimension:"2"}),e=0;e<a[0].length;e++){var f=this._createXMLElement("gml:polygonMember",this.namespaces.gml),g=this.createGMLPolygon(a[0][e],b);f.appendChild(g),d.appendChild(f)}return d},_createXMLdoc:function(){var a=new DOMParser;return a.parseFromString("<root />","text/xml")},_createXMLElement:function(a,b,c){var d=this._createXMLdoc().createElementNS(b,a);if(void 0!==c)for(var e in c)d.setAttribute(e,c[e]);return d},latLngBoundsToGML:function(a,b){var c=a.getSouthWest(),d=a.getNorthEast(),e=this.createElementNS("gml:Envelope",{srsName:b});return e.appendChild(this.createElementNS("gml:lowerCorner",{},{value:c.lng+" "+c.lat})),e.appendChild(this.createElementNS("gml:upperCorner",{},{value:d.lng+" "+d.lat})),e},createElementNS:function(a,b,c){c=c||{};var d=c.uri;d||(d=this.namespaces[a.substring(0,a.indexOf(":"))]),d||(d=this.namespaces[c.prefix]);var e=d?this._createXMLdoc().createElementNS(d,a):this._createXMLdoc().createElement(a);if(b)for(var a in b)if(null!=b[a]&&b[a].toString){var f=b[a].toString(),d=this.namespaces[a.substring(0,a.indexOf(":"))]||null;e.setAttributeNS(d,a,f)}return null!=c.value&&e.appendChild(this._createXMLdoc().createTextNode(c.value)),e}}),MapExpress.Utils.GeoFormatConvertor.gml=function(){return new MapExpress.Utils.GeoFormatConvertor.GML},MapExpress.Utils.GeoJSONUtils={convertFeatureCollectionToMultiPolygon:function(a){function b(a,b){var c=[];if(b.length>0){for(var d=0;d<b.length;d++)b[d].length>3&&c.push(b[d]);c.length>0&&a.push(c)}}var c={},d=[],e={type:"Feature",geometry:{coordinates:d,type:"MultiPolygon"},properties:c};return a&&a.features.forEach(function(a){var c=a.geometry;if("MultiPolygon"===c.type)for(var d=0;d<c.coordinates.length;d++)b(e.geometry.coordinates,c.coordinates[d]);else b(e.geometry.coordinates,c.coordinates)}),e},featureHasCoordinates:function(a){var b=this;return"FeatureCollection"!==a.type?b._featureHasCoordinates(a):!!a.features&&((!a.features||0!==a.features.length)&&(a.features.forEach(function(a){if(!b._featureHasCoordinates(a))return!1}),!0))},_featureHasCoordinates:function(a){try{var b=L.GeoJSON.geometryToLayer(a);if(b&&b.isEmpty&&!b.isEmpty())return!0;if(b&&!b.isEmpty)return!0}catch(a){return console.log(a),!1}return!1},getLayerByPropertyValueFromLayerGroup:function(a,b,c){function d(a){return!!(a&&a.feature&&a.feature.properties&&a.feature.properties.hasOwnProperty(b)&&a.feature.properties[b]===c)&&a}var e=!1;return a.eachLayer(function(a){a instanceof L.FeatureGroup?a.eachLayer(function(a){d(a)&&(e=a)}):d(a)&&(e=a)}),e}},MapExpress.Utils.LegendUtils=L.Class.extend({options:{width:"24",height:"24",r:"4"},initialize:function(a){L.setOptions(this,a)},emptyLegend:function(){return{id:"",name:"",minZoom:0,maxZoom:24,imageUrl:!1,imageFormat:null,imageData:!0,imageDataFormat:"",legendTemplate:!1,templateType:"html"}},getLayerLegendItems:function(a){return!!(a&&a.mapLayer&&window.MapManager.layerEnabled(a.id)&&a.mapLayer.legends&&a.mapLayer.legends.length>0)&&a.mapLayer.legends},getLayerLegendItemInZoom:function(a){if(a.mapLayer.legends&&a.mapLayer.legends.length>0){for(var b=window.MapManager._map.getZoom(),c=0;c<a.mapLayer.legends.length;c++)if(b<=a.mapLayer.legends[c].maxZoom&&b>=a.mapLayer.legends[c].minZoom)return a.mapLayer.legends[c];for(var d=[],e=a.mapLayer.legends.length-1;e>=0;e--)a.mapLayer.legends[e].maxZoom||a.mapLayer.legends[e].minZoom?d.push(!0):(d.push(!1),console.warn("Необходимо установить масштаб для легенды"));if(d.indexOf(!0)===-1)return a.mapLayer.legends[0]}return!1},getLayerLegendInZoom:function(a){var b=this.getLayerLegendItems(a);return!!b&&this.getLayerLegendItemInZoom(a)},getLayersWithLegends:function(){for(var a=window.MapManager.getMapModel().getAllLayers(),b=[],c=a.length-1;c>=0;c--)this.getLayerLegendItems(a[c].id)&&b.push(a[c]);return b},addLegendItemToLayer:function(a,b){a&&(a.legends||(a.legends=[]),a.legends.push(b))},removeLegend:function(a,b,c){if(a.legends)if(b)for(var d=a.legends.length-1;d>=0;d--)a.legends[d].id===b&&a.legends.splice(d,1);else!b&&c&&a.legends.splice(c,1)},getAllLegends:function(){for(var a=window.MapManager.getMapModel().getAllLayers(),b=[],c=0;c<a.length;c++){var d=this.createLegendItem(a[c]);d&&b.push({id:a[c].id,displayName:a[c].options.displayName,legendItem:d})}return b},createLegendItem:function(a){var b=this.getProcessStyle(a);if(b){var c=this.getLayerTypesByZoom(a);return this.processLayerToLegendItem(a,c,b)}return!1},getProcessStyle:function(a){return!!this.getLayerLegendItems(a)&&this.getLayerLegendInZoom(a)},getLayerTypesByZoom:function(a){if(a&&a.mapLayer&&a.mapLayer.toGeoJSON){var b=[],c=a.mapLayer.toGeoJSON();if(c.features&&c.features.length>0)for(var d=c.features.length-1;d>=0;d--){var e=c.features[d].geometry.type;"Polygon"===e||"MultiPolygon"===e?b.indexOf("Polygon")===-1&&b.push("Polygon"):"LineString"===e||"MultiLineString"===e?b.indexOf("LineString")===-1&&b.push("LineString"):"Point"!==e&&"MultiPoint"!==e||b.indexOf("Point")===-1&&b.push("Point")}else b.indexOf("noGeometryTypes")===-1&&b.push("noGeometryTypes");return b}return null},_listOfavaliableStyleOptions:function(a){return{stroke:a.stroke||null,weight:a.weight||a["stroke-width"]||null,color:a.color||null,opacity:a.opacity||a["stroke-opacity"]||1,lineCap:a.lineCap||a["stroke-linecap"]||"round",lineJoin:a.lineJoin||a["stroke-linejoin"]||"round",fillColor:a.fillColor||a.color,fillOpacity:a.fillOpacity||.1,fillRule:a.fillRule||"evenodd",dashArray:a.dashArray||null}},_styleExtract:function(a,b){if(void 0!==b.minZoom&&void 0!==b.maxZoom){var c=a.mapLayer.styles;if(c&&c.length>0){for(var d=0;d<c.length;d++)if(b.minZoom<=c[d].minZoom&&b.maxZoom>=c[d].maxZoom)return c[d];return c[0]}console.warn("У слоя "+a.options.displayName+" не заданы стили");for(var e in a.mapLayer._layers)return this._listOfavaliableStyleOptions(a.mapLayer._layers[e].options)}},stylingElemWithOptions:function(a,b,c){var d=this._styleExtract(c,b);for(var e in d)d[e]&&("color"===e?(d.fillColor||d.fill===!1||a.setAttributeNS(null,"fill",d[e]),a.setAttributeNS(null,"stroke",d[e])):"fillColor"===e?d.fill!==!1&&a.setAttributeNS(null,"fill",d[e]):"weight"===e?a.setAttributeNS(null,"stroke-width",d[e]):"width"===e?a.getAttributeNS(null,"width")||a.setAttributeNS(null,"width",d[e]):"dashArray"===e?a.getAttributeNS(null,"stroke-dasharray")||a.setAttributeNS(null,"stroke-dasharray",d[e]):a.setAttributeNS(null,e.replace(/([A-Z])/g,"-$1").toLowerCase(),d[e])),d.fill===!1&&a.setAttributeNS(null,"fill","#fff"),d.fillOpacity||a.setAttributeNS(null,"fill-opacity",.1),d.opacity||d.strokeOpacity||a.setAttributeNS(null,"stroke-opacity",1)},processLayerToLegendItem:function(a,b,c){var d,e=new DOMParser;if(c.imageUrl)d=document.createElement("img"),c.imageData?d.setAttribute("src","data:"+c.imageFormat+";"+c.imageDataFormat+","+c.imageUrl):d.setAttribute("src",c.imageUrl),d.setAttribute("class","mapexpress-legend-item__img");else if(c.legendTemplate){var f;f="svg"===c.templateType?"image/svg+xml":"xml"===c.templateType?"application/xml":"text/html";try{d=e.parseFromString(c.legendTemplate,f),d=$(d).find("svg")[0]}catch(a){d=$("<div></div>")[0]}}else{var g="http://www.w3.org/2000/svg";d=document.createElementNS(g,"svg"),d.setAttribute("class","mapexpress-legend-item__svg"),d.setAttributeNS(null,"width",this.options.width),d.setAttributeNS(null,"height",this.options.height),d.setAttributeNS(null,"viewBox","0 0 "+this.options.width+" "+this.options.height);var h;b.indexOf("Polygon")!==-1||b.indexOf("noGeometryTypes")!==-1?(h=document.createElementNS(g,"rect"),h.setAttributeNS(null,"x",0),h.setAttributeNS(null,"y",0),h.setAttributeNS(null,"width",this.options.width),h.setAttributeNS(null,"height",this.options.height)):b.indexOf("LineString")!==-1?(h=document.createElementNS(g,"line"),h.setAttributeNS(null,"x1",0),h.setAttributeNS(null,"y1",this.options.height/2),h.setAttributeNS(null,"x2",this.options.width),h.setAttributeNS(null,"y2",this.options.height/2)):b.indexOf("Point")!==-1&&(h=document.createElementNS(g,"circle"),h.setAttributeNS(null,"cx",this.options.width/2),h.setAttributeNS(null,"cy",this.options.height/2),h.setAttributeNS(null,"r",c.radius||this.options.r||this.options.width/2)),this.stylingElemWithOptions(h,c,a),d.appendChild(h)}return d}}),MapExpress.Utils.legendUtils=new MapExpress.Utils.LegendUtils({width:"48",height:"24",r:"4"}),function(){"use strict";MapExpress.Utils.Promise.GetJSON=function(a){var b=$.Deferred();return $.getJSON(a).done(function(a){b.resolve(a)}).fail(function(a,c,d){b.reject(d)}),b.promise()}}(),function(){"use strict";MapExpress.Utils.Promise.Ajax=function(a,b){var c=$.Deferred();return $.ajax({url:a,success:function(a){c.resolve(a,b)},error:function(a){c.reject(a)}}),c.promise()}}(),function(){"use strict";MapExpress.Utils.Promise.AjaxSync=function(a,b){var c=$.Deferred();return setTimeout(function(){$.ajax({url:a,success:function(a){c.resolve(a,b)},error:function(a){c.reject(a)},async:!1})},0),c.promise()}}(),function(){"use strict";MapExpress.Utils.Promise.GetJSONP=function(a,b,c){var d=$.Deferred();return $.ajax({url:a,type:"GET",data:b,dataType:"jsonp",success:function(a){d.resolve(a)},error:function(a){d.reject(a)}}),d.promise()}}(),function(){"use strict";MapExpress.Utils.Promise.Image=function(a,b){b=b||{};var c=new Image;b.crossOrigin&&(c.crossOrigin=b.crossOrigin,c.alt="");var d=$.Deferred();return c.onload=function(){d.resolve(c)},c.onabort=function(a){d.reject(c)},c.onerror=function(a){d.reject(c)},c.src=a,d.promise()}}(),void 0===jQuery.when.all&&(jQuery.when.all=function(a){var b=new jQuery.Deferred;return $.when.apply(jQuery,a).then(function(){b.resolve(Array.prototype.slice.call(arguments));
},function(){b.fail(Array.prototype.slice.call(arguments))}),b}),function(){"use strict";MapExpress.Utils.Promise.OverFunction=function(a){var b=$.Deferred();try{var c=a();b.resolve(c)}catch(a){b.reject(a)}return b.promise()}}(),function(){"use strict";MapExpress.Utils.Promise.WFSAjax=function(a,b,c){console.log(a,b);var d=$.Deferred();return $.ajax({url:a,type:"post",contentType:"text/xml",dataType:"text",data:(new XMLSerializer).serializeToString(b),success:function(a){d.resolve(a,c)},error:function(a){d.reject(a)}}),d.promise()}}();