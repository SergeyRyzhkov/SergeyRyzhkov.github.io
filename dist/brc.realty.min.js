BaltrosPkk={Controls:{},Service:{},Geo:{},Layers:{},Utils:{Promise:{}},Mapping:{},Tools:{},Styles:{},Search:{},Edit:{}},window.BaltrosPkk=BaltrosPkk,BaltrosPkk.Mapping.MapInitializer={initialize:function(e){MapExpress.Mapping.MapInitializerHelper.initializeFromURL(e,"map_model.json",function(){window.MapManager;var e=window.MapManager._map;e.addControl((o=window.MapManager,s=new MapExpress.Tools.MapToolbar(o,{position:"topleft"}),s.addCommand(new MapExpress.Tools.ShowLayerControlMapCommandExt(o)),s.addControlFromTemplate("templates/tula_tbo_search.html","searchId"),s)),e.addControl((t=window.MapManager,a=new MapExpress.Tools.MapToolbar(t,{position:"topright"}),a.addCommand(new MapExpress.Tools.IdentifyMapCommand(t)),a.addCommand(new MapExpress.Tools.LineMeasureCommand(t)),a.addCommand(new MapExpress.Tools.SqrtMeasureCommand(t)),a.addCommand(new MapExpress.Tools.ActiveViewMapExportCommand(t),{showProjList:!1}),a.addCommand(new MapExpress.Tools.ShowFavoriteLayersCommand(t)),a.addCommand(new MapExpress.Tools.SelectorBaseMapsCommand(t)),a.addCommand(new MapExpress.Tools.FileLoaderAndShowAsLayerCommand(t)),a)),e.addControl(function(){var e=new MapExpress.Controls.MapStatusbarControl(window.MapManager);e.addSection(new MapExpress.Controls.ZoomStandartStatusbarSection(window.MapManager)),e.addSection(new MapExpress.Controls.CoordinatesStandartStatusbarSection(window.MapManager)),e.addSection(new MapExpress.Controls.CurrentToolStatusbarSection(window.MapManager));var t=new MapExpress.Controls.AttibutionStandartStatusbarSection(window.MapManager);return t.options.attibution.push({href:"http://leafletjs.com",prefix:"Leaflet"}),t.options.attibution.push({href:"https://openstreetmap.org",prefix:"© OpenStreetMap"}),t.options.attibution.push({href:"https: //www.google.ru",prefix:"© Google"}),t.options.attibution.push({href:"https://pkk5.rosreestr.ru",prefix:"Публичная кадастрвоая карта"}),e.addSection(t),window.MapManager.mapStatusBar=e}()),L.control.zoom({position:"topleft"}).addTo(e),function(){var e=window.MapManager.getMapModel().getLayersByOptionValue("displayName","Публичная кадастровая карта");if(e&&0<e.length){var t=[];window.MapManager.getMapModel()._fillAllLayers(e[0],t);for(var a=0;a<t.length;a++){var o=t[a];if(o.mapLayer&&o.mapLayer._dataPovider){if("Земельные участки"===o.options.displayName){o.mapLayer._dataPovider.getFeatureInfoAsync=r,window.MapManager._mapModel._favoriteLayers.push(o),BaltrosPkk.Mapping.LegendManager.addPkkParcelLegend(o.mapLayer);continue}if("ОКС"===o.options.displayName){o.mapLayer._dataPovider.getFeatureInfoAsync=n,window.MapManager._mapModel._favoriteLayers.push(o),BaltrosPkk.Mapping.LegendManager.addPkkOksLegend(o.mapLayer);continue}if("ЗОУИТ"===o.options.displayName){o.mapLayer._dataPovider.getFeatureInfoAsync=i,window.MapManager._mapModel._favoriteLayers.push(o),BaltrosPkk.Mapping.LegendManager.addPkkZouitLegend(o.mapLayer);continue}if("Кадастровые кварталы"===o.options.displayName){o.mapLayer._dataPovider.getFeatureInfoAsync=p;continue}if("Кадастровые районы"===o.options.displayName){o.mapLayer._dataPovider.getFeatureInfoAsync=d;continue}if("Кадастровые округа"===o.options.displayName){o.mapLayer._dataPovider.getFeatureInfoAsync=l;continue}o.mapLayer._dataPovider.getFeatureInfoAsync=s}}}function s(e,t,a,o,s){return null}function r(e,t,a,o,s){return MapExpress.Utils.CadastreUtils.getObjectListGeoJSONByLatLngAsyn(e,MapExpress.Utils.CadastreUtils.cadastreObjectType.PARCEL)}function n(e,t,a,o,s){return MapExpress.Utils.CadastreUtils.getObjectListGeoJSONByLatLngAsyn(e,MapExpress.Utils.CadastreUtils.cadastreObjectType.OKS)}function i(e,t,a,o,s){return MapExpress.Utils.CadastreUtils.getObjectListGeoJSONByLatLngAsyn(e,MapExpress.Utils.CadastreUtils.cadastreObjectType.ZOUT)}function p(e,t,a,o,s){return MapExpress.Utils.CadastreUtils.getObjectListGeoJSONByLatLngAsyn(e,MapExpress.Utils.CadastreUtils.cadastreObjectType.KVARTAL)}function d(e,t,a,o,s){return MapExpress.Utils.CadastreUtils.getObjectListGeoJSONByLatLngAsyn(e,MapExpress.Utils.CadastreUtils.cadastreObjectType.RAION)}function l(e,t,a,o,s){return MapExpress.Utils.CadastreUtils.getObjectListGeoJSONByLatLngAsyn(e,MapExpress.Utils.CadastreUtils.cadastreObjectType.OKRUG)}}(),MapExpress.Tools.IdentifyMapCommand.maxHeightMinus=.35,MapExpress.Tools.IdentifyMapCommand.maxWidthMinus=.65,MapExpress.Tools.IdentifyMapCommand.showFloatWindow=!1,function(){var e=window.MapManager.getMapModel().getLayerById("PKK_ORDER_"+window.orderGroupId),t=[];window.MapManager.getMapModel()._fillAllLayers(e,t);for(var a=0;a<t.length;a++){var o=t[a];"Заказ. Земельные участки"===o.options.displayName&&BaltrosPkk.Mapping.LegendManager.addOrderParcelLegend(o.mapLayer),"Заказ. Здания"===o.options.displayName&&BaltrosPkk.Mapping.LegendManager.addOrderOKSLegend(o.mapLayer)}}();var t,a;var o,s}),MapExpress.Tools.ShowLayerControlMapCommandExt=MapExpress.Tools.ShowLayerControlMapCommand.extend({createContent:function(e){var t=MapExpress.Tools.ShowLayerControlMapCommand.prototype.createContent.call(this,e);MapExpress.Controls.MapControlUtils.setStyle(t,"float:left");var a=L.DomUtil.create("span","divider1",e);return MapExpress.Controls.MapControlUtils.setStyle(a,"float:left"),t}})}},BaltrosPkk.Mapping.LegendManager={addPkkParcelLegend:function(e){MapExpress.Utils.legendUtils.addLegendItemToLayer(e,{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#ffffff" stroke-width="3" x="0" y="0" width="48" height="24" stroke-dasharray="none" stroke="#f28383" opacity="1" fill-opacity="1" stroke-opacity="1"></rect></svg>',templateType:"svg",maxZoom:24,minZoom:0})},addPkkOksLegend:function(e){MapExpress.Utils.legendUtils.addLegendItemToLayer(e,{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#ffbebe" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#ffbebe"  opacity="1" fill-opacity="1" stroke-opacity="1"></rect></svg>',templateType:"svg",maxZoom:24,minZoom:0})},addPkkZouitLegend:function(e){MapExpress.Utils.legendUtils.addLegendItemToLayer(e,{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#92d17b" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#92d17b"  opacity="1" fill-opacity="0.5" stroke-opacity="1"></rect></svg>',templateType:"svg",maxZoom:24,minZoom:0})},addParcelsLegend:function(e){this._setLayerLegandable(e)},addOksLegend:function(e){this._setLayerLegandable(e)},addRoscheckCounturLegend:function(e){this._setLayerLegandable(e)},addRoscheckCounturBufferedLineLegend:function(e){this._setLayerLegandable(e)},_setLayerLegandable:function(e){MapExpress.Utils.legendUtils.addLegendItemToLayer(e,{minZoom:0,maxZoom:24})},addOrderParcelLegend:function(e){MapExpress.Utils.legendUtils.addLegendItemToLayer(e,{templateType:"svg",maxZoom:24,minZoom:0,legendTemplate:[{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#FF3D00" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#F44336"  fill-opacity="0.3" stroke-opacity="1"></rect></svg>',label:"не обработан"},{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#FF6F00" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#F44336"  fill-opacity="0.3" stroke-opacity="1"></rect></svg>',label:"в обработке"},{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#8BC34A" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#F44336" fill-opacity="0.3" stroke-opacity="1"></rect></svg>',label:"обработан"}]})},addOrderOKSLegend:function(e){MapExpress.Utils.legendUtils.addLegendItemToLayer(e,{templateType:"svg",maxZoom:24,minZoom:0,legendTemplate:[{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#FF3D00" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#3F51B5"  fill-opacity="0.3" stroke-opacity="1"></rect></svg>',label:"не обработан"},{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#FF6F00" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#3F51B5"  fill-opacity="0.3" stroke-opacity="1"></rect></svg>',label:"в обработке"},{legendTemplate:'<svg width="48" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 24"><rect fill="#8BC34A" stroke-width="3" x="0" y="0" width="48" height="24" stroke="#3F51B5" fill-opacity="0.3" stroke-opacity="1"></rect></svg>',label:"обработан"}]})}};